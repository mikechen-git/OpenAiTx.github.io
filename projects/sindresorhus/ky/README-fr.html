<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sindresorhus/ky - ky</title>

    <!-- Primary Meta Tags -->
    <meta name="title" content="sindresorhus/ky - ky">
    <meta name="description" content="sindresorhus/ky - GitHub repository documentation and information">
    <meta name="keywords" content="sindresorhus, ky, GitHub, repository, documentation, ">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=fr">
    <meta property="og:title" content="sindresorhus/ky - ky">
    <meta property="og:description" content="sindresorhus/ky - GitHub repository documentation and information">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">

    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="icon.jpg">
    <link rel="apple-touch-icon" href="icon.jpg">

    <!-- Marked.js for Markdown rendering -->
    <script type="text/javascript" async="" src="https://www.statcounter.com/counter/recorder.js"></script><script src="js/marked.min.js?v=20250613"></script>
    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="css/github.min.css?v=20250613">
    <script src="js/highlight.min.js?v=20250613"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="view.css?v=20250613">
    <style>
        /* Layout */
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .main-container {
            margin: 0 auto;
            width: 100%;
            max-width: 980px;
            padding: 0 20px;
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 0 15px;
            }
        }

        /* Image size restrictions */
        .markdown-body img {
            max-width: 100%;
            height: auto;
        }

        /* Existing styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f6f8fa;
            border-bottom: 1px solid #e1e4e8;
            position: relative;
        }

        .back-button {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #0366d6;
            text-decoration: none;
            display: flex;
            align-items: center;
            font-size: 14px;
            padding: 5px 10px;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            background-color: #fff;
        }

        .back-button:hover {
            background-color: #f6f8fa;
            border-color: #0366d6;
        }

        .back-button::before {
            content: "←";
            margin-right: 5px;
            font-size: 16px;
        }

        .header .links {
            margin-top: 10px;
            font-size: 16px;
        }

        .header .links a {
            color: #0366d6;
            text-decoration: none;
            margin-left: 5px;
        }

        .header .links a:hover {
            text-decoration: underline;
        }
        
        /* Language badges styles */
        .language-badges {
            margin-top: 15px;
            text-align: center;
        }
        .language-badges a {
            display: inline-block;
            margin: 2px;
            text-decoration: none;
        }
        .language-badges img {
            height: 20px;
            border-radius: 3px;
        }
        .language-badges a:hover img {
            opacity: 0.8;
        }
    </style>
</head>

<body>
    <div class="header">
        <a href="javascript:history.back()" class="back-button">Back</a>
        <div class="links">
            GitHub Repository: <a href="https://github.com/sindresorhus/ky" id="githubRepoLink" target="_blank">sindresorhus/ky</a>
        </div>
        <div class="language-badges" id="languageBadges"><a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=en"><img src="https://img.shields.io/badge/EN-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=zh-CN"><img src="https://img.shields.io/badge/简中-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=zh-TW"><img src="https://img.shields.io/badge/繁中-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ja"><img src="https://img.shields.io/badge/日本語-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ko"><img src="https://img.shields.io/badge/한국어-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=th"><img src="https://img.shields.io/badge/ไทย-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=fr"><img src="https://img.shields.io/badge/Français-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=de"><img src="https://img.shields.io/badge/Deutsch-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=es"><img src="https://img.shields.io/badge/Español-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=it"><img src="https://img.shields.io/badge/Italiano-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ru"><img src="https://img.shields.io/badge/Русский-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=pt"><img src="https://img.shields.io/badge/Português-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=nl"><img src="https://img.shields.io/badge/Nederlands-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=pl"><img src="https://img.shields.io/badge/Polski-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ar"><img src="https://img.shields.io/badge/العربية-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=tr"><img src="https://img.shields.io/badge/Türkçe-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=vi"><img src="https://img.shields.io/badge/Tiếng Việt-white" alt="version"></a></div>
    </div>

    <div class="main-container">
        <div class="markdown-body" id="content"><div align="center">
	<br>
	<div>
		<img width="600" height="600" src="https://raw.githubusercontent.com/sindresorhus/ky/main/media/logo.svg" alt="ky">
	</div>
	<br>
	<br>
	<br>
</div>

<blockquote>
<p>Ky est un client HTTP minuscule et élégant basé sur l'<a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch">API Fetch</a></p>
</blockquote>
<p><a href="https://codecov.io/gh/sindresorhus/ky"><img src="https://codecov.io/gh/sindresorhus/ky/branch/main/graph/badge.svg" alt="Coverage Status"></a><br><a href="https://bundlephobia.com/result?p=ky"><img src="https://badgen.net/bundlephobia/minzip/ky" alt=""></a></p>
<p>Ky cible les <a href="#browser-support">navigateurs modernes</a>, Node.js, Bun et Deno.</p>
<p>C'est juste un petit paquet sans dépendances.</p>
<h2>Avantages par rapport à <code>fetch</code> natif</h2>
<ul>
<li>API plus simple</li>
<li>Raccourcis de méthode (<code>ky.post()</code>)</li>
<li>Considère les codes de statut non 2xx comme des erreurs (après les redirections)</li>
<li>Relance les requêtes échouées</li>
<li>Option JSON</li>
<li>Prise en charge du timeout</li>
<li>Option de préfixe d’URL</li>
<li>Instances avec des valeurs par défaut personnalisées</li>
<li>Hooks</li>
<li>Fonctionnalités TypeScript agréables (par exemple, <code>.json()</code> prend en charge les génériques et a <code>unknown</code> comme valeur par défaut, pas <code>any</code>)</li>
</ul>
<h2>Installation</h2>
<pre><code class="language-sh hljs language-bash">npm install ky
</code></pre>
<h6>CDN</h6>
<ul>
<li><a href="https://cdn.jsdelivr.net/npm/ky/+esm">jsdelivr</a></li>
<li><a href="https://unpkg.com/ky">unpkg</a></li>
<li><a href="https://esm.sh/ky">esm.sh</a></li>
</ul>
<h2>Utilisation</h2>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(<span class="hljs-string">'https://example.com'</span>, {<span class="hljs-attr">json</span>: {<span class="hljs-attr">foo</span>: <span class="hljs-literal">true</span>}}).<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json);
<span class="hljs-comment">//=&gt; {data: '🦄'}</span>
</code></pre>
<p>Avec <code>fetch</code> natif, cela serait&nbsp;:</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HTTPError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Error</span> {}

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
	<span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({<span class="hljs-attr">foo</span>: <span class="hljs-literal">true</span>}),
	<span class="hljs-attr">headers</span>: {
		<span class="hljs-string">'content-type'</span>: <span class="hljs-string">'application/json'</span>
	}
});

<span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
	<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HTTPError</span>(<span class="hljs-string">`Fetch error: <span class="hljs-subst">${response.statusText}</span>`</span>);
}

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json);
<span class="hljs-comment">//=&gt; {data: '🦄'}</span>
</code></pre>
<p>Si vous utilisez <a href="https://github.com/denoland/deno">Deno</a>, importez Ky depuis une URL. Par exemple, via un CDN&nbsp;:</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'https://esm.sh/ky'</span>;
</code></pre>
<h2>API</h2>
<h3>ky(input, options?)</h3>
<p>Les paramètres <code>input</code> et <code>options</code> sont identiques à ceux de <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch"><code>fetch</code></a>, avec des <code>options</code> supplémentaires disponibles (voir ci-dessous).</p>
<p>Retourne un <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">objet <code>Response</code></a> avec des <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch#body">méthodes <code>Body</code></a> ajoutées pour plus de commodité. Vous pouvez ainsi, par exemple, appeler directement <code>ky.get(input).json()</code> sans avoir à attendre d’abord la <code>Response</code>. Lorsqu’on l’appelle ainsi, un en-tête <code>Accept</code> approprié sera défini en fonction de la méthode body utilisée. Contrairement aux méthodes <code>Body</code> de <code>window.Fetch</code>, celles-ci lanceront une exception <code>HTTPError</code> si le statut de la réponse n’est pas dans la plage <code>200...299</code>. De plus, <code>.json()</code> retournera une chaîne vide si le body est vide ou si le statut de la réponse est <code>204</code> au lieu de lancer une erreur de parsing en raison d’un corps vide.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'/api/user'</span>).<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user);
</code></pre>
<p>⌨️ <strong>TypeScript&nbsp;:</strong> Accepte un <a href="https://www.typescriptlang.org/docs/handbook/2/generics.html">paramètre de type optionnel</a>, qui vaut par défaut <a href="https://www.typescriptlang.org/docs/handbook/2/functions.html#unknown"><code>unknown</code></a>, et est transmis au type de retour de <code>.json()</code>.</p>
<pre><code class="language-ts hljs language-typescript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// user1 est unknown</span>
<span class="hljs-keyword">const</span> user1 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'/api/users/1'</span>).<span class="hljs-title function_">json</span>();
<span class="hljs-comment">// user2 est un User</span>
<span class="hljs-keyword">const</span> user2 = <span class="hljs-keyword">await</span> ky&lt;<span class="hljs-title class_">User</span>&gt;(<span class="hljs-string">'/api/users/2'</span>).<span class="hljs-title function_">json</span>();
<span class="hljs-comment">// user3 est un User</span>
<span class="hljs-keyword">const</span> user3 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'/api/users/3'</span>).<span class="hljs-property">json</span>&lt;<span class="hljs-title class_">User</span>&gt;();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([user1, user2, user3]);
</code></pre>
<h3>ky.get(input, options?)</h3>
<h3>ky.post(input, options?)</h3>
<h3>ky.put(input, options?)</h3>
<h3>ky.patch(input, options?)</h3>
<h3>ky.head(input, options?)</h3>
<h3>ky.delete(input, options?)</h3>
<p>Définit <code>options.method</code> sur le nom de la méthode et effectue la requête.</p>
<p>⌨️ <strong>TypeScript&nbsp;:</strong> Accepte un paramètre de type optionnel à utiliser avec les réponses JSON (voir <a href="#kyinput-options"><code>ky()</code></a>).</p>
<h4>input</h4>
<p>Type&nbsp;: <code>string</code> | <code>URL</code> | <code>Request</code></p>
<p>Identique à l’<a href="https://developer.mozilla.org/en-US/docs/Web/API/Request/Request#input">entrée de <code>fetch</code></a>.</p>
<p>Lorsque vous utilisez une instance <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>Request</code></a> comme <code>input</code>, toutes les options modifiant l’URL (telles que <code>prefixUrl</code>) seront ignorées.</p>
<h4>options</h4>
<p>Type&nbsp;: <code>object</code></p>
<p>Identique aux <a href="https://developer.mozilla.org/en-US/docs/Web/API/fetch#options">options de <code>fetch</code></a>, plus les options supplémentaires suivantes&nbsp;:</p>
<h5>method</h5>
<p>Type&nbsp;: <code>string</code><br>Valeur par défaut&nbsp;: <code>'get'</code></p>
<p>Méthode HTTP utilisée pour effectuer la requête.</p>
<p>En interne, les méthodes standard (<code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, <code>HEAD</code> et <code>DELETE</code>) sont mises en majuscule afin d’éviter les erreurs côté serveur dues à la sensibilité à la casse.</p>
<h5>json</h5>
<p>Type&nbsp;: <code>object</code> et toute autre valeur acceptée par <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify"><code>JSON.stringify()</code></a></p>
<p>Raccourci pour l’envoi de JSON. À utiliser à la place de l’option <code>body</code>. Accepte tout objet ou valeur simple, qui sera converti en JSON via <code>JSON.stringify()</code> et envoyé dans le body avec l’en-tête approprié.</p>
<h5>searchParams</h5>
<p>Type&nbsp;: <code>string | object&lt;string, string | number | boolean&gt; | Array&lt;Array&lt;string | number | boolean&gt;&gt; | URLSearchParams</code><br>Valeur par défaut&nbsp;: <code>''</code></p>
<p>Paramètres de recherche à inclure dans l’URL de la requête. Les définir écrasera tous les paramètres de recherche existants dans l’URL d’entrée.</p>
<p>Accepte toute valeur supportée par <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams/URLSearchParams"><code>URLSearchParams()</code></a>.</p>
<h5>prefixUrl</h5>
<p>Type&nbsp;: <code>string | URL</code></p>
<p>Un préfixe à ajouter à l’URL <code>input</code> lors de la requête. Cela peut être n’importe quelle URL valide, relative ou absolue. Un slash final <code>/</code> est optionnel et sera ajouté automatiquement, si besoin, lorsqu’il est combiné avec <code>input</code>. Prend effet uniquement lorsque <code>input</code> est une chaîne. L’argument <code>input</code> ne peut pas commencer par un slash <code>/</code> lors de l’utilisation de cette option.</p>
<p>Utile en combinaison avec <a href="#kyextenddefaultoptions"><code>ky.extend()</code></a> pour créer des instances Ky spécifiques à un usage particulier.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// Sur https://example.com</span>

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'unicorn'</span>, {<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">'/api'</span>});
<span class="hljs-comment">//=&gt; 'https://example.com/api/unicorn'</span>

<span class="hljs-keyword">const</span> response2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'unicorn'</span>, {<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">'https://cats.com'</span>});
<span class="hljs-comment">//=&gt; 'https://cats.com/unicorn'</span>
</code></pre>
<p>Notes&nbsp;:</p>
<ul>
<li>Après la combinaison de <code>prefixUrl</code> et <code>input</code>, le résultat est résolu par rapport à l’<a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/baseURI">URL de base</a> de la page (si elle existe).</li>
<li>Les slashes initiaux dans <code>input</code> sont interdits lors de l’utilisation de cette option afin d’assurer la cohérence et d’éviter toute confusion sur la façon dont l’URL <code>input</code> est traitée, puisque <code>input</code> ne suivra pas les règles normales de résolution d’URL quand <code>prefixUrl</code> est utilisé, ce qui change la signification d’un slash initial.</li>
</ul>
<h5>retry</h5>
<p>Type&nbsp;: <code>object | number</code><br>Valeur par défaut&nbsp;:</p>
<ul>
<li><code>limit</code>&nbsp;: <code>2</code></li>
<li><code>methods</code>&nbsp;: <code>get</code> <code>put</code> <code>head</code> <code>delete</code> <code>options</code> <code>trace</code></li>
<li><code>statusCodes</code>&nbsp;: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/408"><code>408</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/413"><code>413</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429"><code>429</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500"><code>500</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502"><code>502</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/503"><code>503</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/504"><code>504</code></a></li>
<li><code>afterStatusCodes</code>&nbsp;: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/413"><code>413</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429"><code>429</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/503"><code>503</code></a></li>
<li><code>maxRetryAfter</code>&nbsp;: <code>undefined</code></li>
<li><code>backoffLimit</code>&nbsp;: <code>undefined</code></li>
<li><code>delay</code>&nbsp;: <code>attemptCount =&gt; 0.3 * (2 ** (attemptCount - 1)) * 1000</code></li>
</ul>
<p>Un objet représentant les champs <code>limit</code>, <code>methods</code>, <code>statusCodes</code>, <code>afterStatusCodes</code> et <code>maxRetryAfter</code> pour le nombre maximal de tentatives, les méthodes autorisées, les codes de statut autorisés, les codes de statut autorisés à utiliser le temps <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a> et le temps maximal <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a>.</p>
<p>Si <code>retry</code> est un nombre, il sera utilisé comme <code>limit</code> et les autres valeurs par défaut resteront inchangées.</p>
<p>Si la réponse fournit un code HTTP contenu dans <code>afterStatusCodes</code>, Ky attendra que la date, le délai d'attente ou le timestamp donné dans l’en-tête <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a> soit passé pour réessayer la requête. Si <code>Retry-After</code> est absent, l’en-tête non standard <a href="https://www.ietf.org/archive/id/draft-polli-ratelimit-headers-05.html#section-3.3"><code>RateLimit-Reset</code></a> est utilisé comme solution de repli. Si le code de statut fourni n'est pas dans la liste, l’en-tête <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a> sera ignoré.</p>
<p>Si <code>maxRetryAfter</code> est défini sur <code>undefined</code>, il utilisera <code>options.timeout</code>. Si l’en-tête <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a> est supérieur à <code>maxRetryAfter</code>, il utilisera <code>maxRetryAfter</code>.</p>
<p>L'option <code>backoffLimit</code> est la limite supérieure du délai par tentative en millisecondes.<br>Pour limiter le délai, définissez <code>backoffLimit</code> à 1000, par exemple.<br>Par défaut, le délai est calculé avec <code>0.3 * (2 ** (attemptCount - 1)) * 1000</code>. Le délai augmente exponentiellement.</p>
<p>L’option <code>delay</code> peut être utilisée pour changer la façon dont le délai entre les tentatives est calculé. La fonction reçoit un paramètre, le nombre de tentatives, commençant à <code>1</code>.</p>
<p>Les tentatives ne sont pas déclenchées suite à un <a href="#timeout">timeout</a>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">retry</span>: {
		<span class="hljs-attr">limit</span>: <span class="hljs-number">10</span>,
		<span class="hljs-attr">methods</span>: [<span class="hljs-string">'get'</span>],
		<span class="hljs-attr">statusCodes</span>: [<span class="hljs-number">413</span>],
		<span class="hljs-attr">backoffLimit</span>: <span class="hljs-number">3000</span>
	}
}).<span class="hljs-title function_">json</span>();
</code></pre>
<h5>timeout</h5>
<p>Type : <code>number | false</code><br>Par défaut : <code>10000</code></p>
<p>Délai d'attente en millisecondes pour obtenir une réponse, y compris toutes les tentatives. Ne peut pas dépasser 2147483647.<br>Si défini à <code>false</code>, il n’y aura pas de délai d’attente.</p>
<h5>hooks</h5>
<p>Type : <code>object&lt;string, Function[]&gt;</code><br>Par défaut : <code>{beforeRequest: [], beforeRetry: [], afterResponse: []}</code></p>
<p>Les hooks permettent des modifications pendant le cycle de vie de la requête. Les fonctions hook peuvent être asynchrones et sont exécutées en série.</p>
<h6>hooks.beforeRequest</h6>
<p>Type : <code>Function[]</code><br>Par défaut : <code>[]</code></p>
<p>Ce hook permet de modifier la requête juste avant qu'elle ne soit envoyée. Ky n’apportera plus aucun changement à la requête après cela. La fonction hook reçoit <code>request</code> et <code>options</code> en arguments. Vous pouvez, par exemple, modifier ici les <code>request.headers</code>.</p>
<p>Le hook peut retourner un <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>Request</code></a> pour remplacer la requête sortante, ou retourner une <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> pour éviter complètement de faire une requête HTTP. Cela peut être utilisé pour simuler une requête, vérifier un cache interne, etc. Une considération <strong>importante</strong> lors du retour d'une requête ou d'une réponse depuis ce hook est que tous les hooks <code>beforeRequest</code> restants seront ignorés, il peut donc être préférable de ne les retourner que depuis le dernier hook.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> api = ky.<span class="hljs-title function_">extend</span>({
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRequest</span>: [
			<span class="hljs-function"><span class="hljs-params">request</span> =&gt;</span> {
				request.<span class="hljs-property">headers</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'X-Requested-With'</span>, <span class="hljs-string">'ky'</span>);
			}
		]
	}
});

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'https://example.com/api/users'</span>);
</code></pre>
<h6>hooks.beforeRetry</h6>
<p>Type : <code>Function[]</code><br>Par défaut : <code>[]</code></p>
<p>Ce hook permet de modifier la requête juste avant la nouvelle tentative. Ky n’apportera plus aucun changement à la requête après cela. La fonction hook reçoit un objet avec la requête et les options normalisées, une instance d’erreur et le nombre de tentatives. Vous pouvez, par exemple, modifier ici les <code>request.headers</code>.</p>
<p>Si la requête a reçu une réponse, l’erreur sera de type <code>HTTPError</code> et l’objet <code>Response</code> sera disponible via <code>error.response</code>. Notez que certains types d’erreurs, comme les erreurs réseau, signifient par nature qu’aucune réponse n’a été reçue. Dans ce cas, l’erreur ne sera pas une instance de <code>HTTPError</code>.</p>
<p>Vous pouvez empêcher Ky de réessayer la requête en lançant une erreur. Ky ne la gérera d’aucune façon et l’erreur sera propagée à l’initiateur de la requête. Le reste des hooks <code>beforeRetry</code> ne sera pas appelé dans ce cas. Alternativement, vous pouvez retourner le symbole <a href="#kystop"><code>ky.stop</code></a> pour faire la même chose mais sans propager d’erreur (cela a quelques limitations, voir la documentation de <code>ky.stop</code> pour les détails).</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRetry</span>: [
			<span class="hljs-keyword">async</span> ({request, options, error, retryCount}) =&gt; {
				<span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com/refresh-token'</span>);
				request.<span class="hljs-property">headers</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">`token <span class="hljs-subst">${token}</span>`</span>);
			}
		]
	}
});
</code></pre>
<h6>hooks.beforeError</h6>
<p>Type : <code>Function[]</code><br>Par défaut : <code>[]</code></p>
<p>Ce hook permet de modifier le <code>HTTPError</code> juste avant qu’il ne soit levé. La fonction hook reçoit un <code>HTTPError</code> en argument et doit retourner une instance de <code>HTTPError</code>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeError</span>: [
			<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
				<span class="hljs-keyword">const</span> {response} = error;
				<span class="hljs-keyword">if</span> (response &amp;&amp; response.<span class="hljs-property">body</span>) {
					error.<span class="hljs-property">name</span> = <span class="hljs-string">'GitHubError'</span>;
					error.<span class="hljs-property">message</span> = <span class="hljs-string">`<span class="hljs-subst">${response.body.message}</span> (<span class="hljs-subst">${response.status}</span>)`</span>;
				}

				<span class="hljs-keyword">return</span> error;
			}
		]
	}
});
</code></pre>
<h6>hooks.afterResponse</h6>
<p>Type : <code>Function[]</code><br>Par défaut : <code>[]</code></p>
<p>Ce hook permet de lire et éventuellement de modifier la réponse. La fonction hook reçoit la requête normalisée, les options et un clone de la réponse en arguments. La valeur de retour de la fonction hook sera utilisée par Ky comme objet réponse si c’est une instance de <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">afterResponse</span>: [
			<span class="hljs-function">(<span class="hljs-params">_request, _options, response</span>) =&gt;</span> {
				<span class="hljs-comment">// Vous pouvez faire quelque chose avec la réponse, par exemple, un log.</span>
				<span class="hljs-title function_">log</span>(response);

				<span class="hljs-comment">// Ou retourner une instance de `Response` pour remplacer la réponse.</span>
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(<span class="hljs-string">'A different response'</span>, {<span class="hljs-attr">status</span>: <span class="hljs-number">200</span>});
			},

			<span class="hljs-comment">// Ou refaire une tentative avec un nouveau token sur une erreur 403</span>
			<span class="hljs-keyword">async</span> (request, options, response) =&gt; {
				<span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">403</span>) {
					<span class="hljs-comment">// Obtenir un nouveau token</span>
					<span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com/token'</span>).<span class="hljs-title function_">text</span>();

					<span class="hljs-comment">// Réessayer avec le token</span>
					request.<span class="hljs-property">headers</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">`token <span class="hljs-subst">${token}</span>`</span>);

					<span class="hljs-keyword">return</span> <span class="hljs-title function_">ky</span>(request);
				}
			}
		]
	}
});
</code></pre>
<h5>throwHttpErrors</h5>
<p>Type : <code>boolean</code><br>Par défaut : <code>true</code></p>
<p>Lève une <code>HTTPError</code> lorsque, après avoir suivi les redirections, la réponse a un code de statut non-2xx. Pour lever également pour les redirections au lieu de les suivre, définissez l’option <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters"><code>redirect</code></a> à <code>'manual'</code>.</p>
<p>Définir ceci à <code>false</code> peut être utile si vous vérifiez la disponibilité d'une ressource et attendez des réponses d’erreur.</p>
<p>Remarque : Si <code>false</code>, les réponses d’erreur sont considérées comme réussies et la requête ne sera pas réessayée.</p>
<h5>onDownloadProgress</h5>
<p>Type : <code>Function</code></p>
<p>Gestionnaire d’événement de progression du téléchargement.</p>
<p>La fonction reçoit les arguments suivants :</p>
<ul>
<li><code>progress</code> est un objet avec les propriétés suivantes :</li>
<li><ul>
<li><code>percent</code> est un nombre entre 0 et 1 représentant le pourcentage de progression.</li>
</ul>
</li>
<li><ul>
<li><code>transferredBytes</code> est le nombre d’octets transférés jusqu’à présent.</li>
</ul>
</li>
<li><ul>
<li><code>totalBytes</code> est le nombre total d’octets à transférer. Il s’agit d’une estimation et peut être 0 si la taille totale ne peut pas être déterminée.</li>
</ul>
</li>
<li><code>chunk</code> est une instance de <code>Uint8Array</code> contenant les données envoyées. Remarque : Elle est vide lors du premier appel.</li>
</ul>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">onDownloadProgress</span>: <span class="hljs-function">(<span class="hljs-params">progress, chunk</span>) =&gt;</span> {
		<span class="hljs-comment">// Exemple d’affichage&nbsp;:</span>
		<span class="hljs-comment">// `0% - 0 of 1271 bytes`</span>
		<span class="hljs-comment">// `100% - 1271 of 1271 bytes`</span>
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${progress.percent * <span class="hljs-number">100</span>}</span>% - <span class="hljs-subst">${progress.transferredBytes}</span> of <span class="hljs-subst">${progress.totalBytes}</span> bytes`</span>);
	}
});
</code></pre>
<h5>onUploadProgress</h5>
<p>Type : <code>Function</code><br>Gestionnaire d'événement de progression de l’envoi.</p>
<p>La fonction reçoit les arguments suivants :</p>
<ul>
<li><code>progress</code> est un objet avec les propriétés suivantes :</li>
<li><ul>
<li><code>percent</code> est un nombre compris entre 0 et 1 représentant le pourcentage de progression.</li>
</ul>
</li>
<li><ul>
<li><code>transferredBytes</code> est le nombre d’octets transférés jusqu’à présent.</li>
</ul>
</li>
<li><ul>
<li><code>totalBytes</code> est le nombre total d’octets à transférer. Il s’agit d’une estimation et il peut être égal à 0 si la taille totale ne peut pas être déterminée.</li>
</ul>
</li>
<li><code>chunk</code> est une instance de <code>Uint8Array</code> contenant les données qui ont été envoyées. Remarque : Il est vide lors du dernier appel.</li>
</ul>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(<span class="hljs-string">'https://example.com/upload'</span>, {
	<span class="hljs-attr">body</span>: largeFile,
	<span class="hljs-attr">onUploadProgress</span>: <span class="hljs-function">(<span class="hljs-params">progress, chunk</span>) =&gt;</span> {
		<span class="hljs-comment">// Exemple de sortie :</span>
		<span class="hljs-comment">// `0% - 0 sur 1271 octets`</span>
		<span class="hljs-comment">// `100% - 1271 sur 1271 octets`</span>
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${progress.percent * <span class="hljs-number">100</span>}</span>% - <span class="hljs-subst">${progress.transferredBytes}</span> sur <span class="hljs-subst">${progress.totalBytes}</span> octets`</span>);
	}
});
</code></pre>
<h5>parseJson</h5>
<p>Type : <code>Function</code><br>Par défaut : <code>JSON.parse()</code></p>
<p>Fonction de parsing JSON définie par l’utilisateur.</p>
<p>Cas d’utilisation :</p>
<ol>
<li>Parser le JSON via le paquet <a href="https://github.com/hapijs/bourne"><code>bourne</code></a> pour se protéger contre la pollution du prototype.</li>
<li>Parser le JSON avec l’option <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse"><code>reviver</code> de <code>JSON.parse()</code></a>.</li>
</ol>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;
<span class="hljs-keyword">import</span> bourne <span class="hljs-keyword">from</span> <span class="hljs-string">'@hapijs/bourne'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">parseJson</span>: <span class="hljs-function"><span class="hljs-params">text</span> =&gt;</span> <span class="hljs-title function_">bourne</span>(text)
}).<span class="hljs-title function_">json</span>();
</code></pre>
<h5>stringifyJson</h5>
<p>Type : <code>Function</code><br>Par défaut : <code>JSON.stringify()</code></p>
<p>Fonction de transformation JSON en chaîne définie par l’utilisateur.</p>
<p>Cas d’utilisation :</p>
<ol>
<li>Transformer le JSON avec une fonction <code>replacer</code> personnalisée.</li>
</ol>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">DateTime</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'luxon'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">stringifyJson</span>: <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data, <span class="hljs-function">(<span class="hljs-params">key, value</span>) =&gt;</span> {
		<span class="hljs-keyword">if</span> (key.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'_at'</span>)) {
			<span class="hljs-keyword">return</span> <span class="hljs-title class_">DateTime</span>.<span class="hljs-title function_">fromISO</span>(value).<span class="hljs-title function_">toSeconds</span>();
		}

		<span class="hljs-keyword">return</span> value;
	})
}).<span class="hljs-title function_">json</span>();
</code></pre>
<h5>fetch</h5>
<p>Type : <code>Function</code><br>Par défaut : <code>fetch</code></p>
<p>Fonction <code>fetch</code> définie par l’utilisateur.<br>Doit être entièrement compatible avec le standard <a href="https://developer.mozilla.org/fr/docs/Web/API/Fetch_API">Fetch API</a>.</p>
<p>Cas d’utilisation :</p>
<ol>
<li>Utiliser des implémentations personnalisées de <code>fetch</code> comme <a href="https://www.npmjs.com/package/isomorphic-unfetch"><code>isomorphic-unfetch</code></a>.</li>
<li>Utiliser la fonction wrapper <code>fetch</code> fournie par certains frameworks qui utilisent le rendu côté serveur (SSR).</li>
</ol>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;
<span class="hljs-keyword">import</span> fetch <span class="hljs-keyword">from</span> <span class="hljs-string">'isomorphic-unfetch'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {fetch}).<span class="hljs-title function_">json</span>();
</code></pre>
<h3>ky.extend(defaultOptions)</h3>
<p>Crée une nouvelle instance de <code>ky</code> avec certains paramètres par défaut remplacés par les vôtres.</p>
<p>Contrairement à <code>ky.create()</code>, <code>ky.extend()</code> hérite des valeurs par défaut de son parent.</p>
<p>Vous pouvez passer les en-têtes comme une instance de <code>Headers</code> ou comme un objet classique.</p>
<p>Vous pouvez supprimer un en-tête avec <code>.extend()</code> en passant l’en-tête avec une valeur <code>undefined</code>.<br>Passer <code>undefined</code> sous forme de chaîne supprime l’en-tête uniquement s’il provient d’une instance <code>Headers</code>.</p>
<p>De même, vous pouvez supprimer des entrées de <code>hooks</code> existantes en étendant le hook avec un <code>undefined</code> explicite.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> url = <span class="hljs-string">'https://sindresorhus.com'</span>;

<span class="hljs-keyword">const</span> original = ky.<span class="hljs-title function_">create</span>({
	<span class="hljs-attr">headers</span>: {
		<span class="hljs-attr">rainbow</span>: <span class="hljs-string">'rainbow'</span>,
		<span class="hljs-attr">unicorn</span>: <span class="hljs-string">'unicorn'</span>
	},
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRequest</span>: [ <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'before 1'</span>) ],
		<span class="hljs-attr">afterResponse</span>: [ <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'after 1'</span>) ],
	},
});

<span class="hljs-keyword">const</span> extended = original.<span class="hljs-title function_">extend</span>({
	<span class="hljs-attr">headers</span>: {
		<span class="hljs-attr">rainbow</span>: <span class="hljs-literal">undefined</span>
	},
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRequest</span>: <span class="hljs-literal">undefined</span>,
		<span class="hljs-attr">afterResponse</span>: [ <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'after 2'</span>) ],
	}
});

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">extended</span>(url).<span class="hljs-title function_">json</span>();
<span class="hljs-comment">//=&gt; after 1</span>
<span class="hljs-comment">//=&gt; after 2</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'rainbow'</span> <span class="hljs-keyword">in</span> response);
<span class="hljs-comment">//=&gt; false</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'unicorn'</span> <span class="hljs-keyword">in</span> response);
<span class="hljs-comment">//=&gt; true</span>
</code></pre>
<p>Vous pouvez également référencer les valeurs par défaut du parent en fournissant une fonction à <code>.extend()</code>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> api = ky.<span class="hljs-title function_">create</span>({<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">'https://example.com/api'</span>});

<span class="hljs-keyword">const</span> usersApi = api.<span class="hljs-title function_">extend</span>(<span class="hljs-function">(<span class="hljs-params">options</span>) =&gt;</span> ({<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">`<span class="hljs-subst">${options.prefixUrl}</span>/users`</span>}));

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> usersApi.<span class="hljs-title function_">get</span>(<span class="hljs-string">'123'</span>);
<span class="hljs-comment">//=&gt; 'https://example.com/api/users/123'</span>

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'version'</span>);
<span class="hljs-comment">//=&gt; 'https://example.com/api/version'</span>
</code></pre>
<h3>ky.create(defaultOptions)</h3>
<p>Crée une nouvelle instance Ky avec de nouveaux paramètres par défaut.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// Sur https://my-site.com</span>

<span class="hljs-keyword">const</span> api = ky.<span class="hljs-title function_">create</span>({<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">'https://example.com/api'</span>});

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'users/123'</span>);
<span class="hljs-comment">//=&gt; 'https://example.com/api/users/123'</span>

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/status'</span>, {<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">''</span>});
<span class="hljs-comment">//=&gt; 'https://my-site.com/status'</span>
</code></pre>
<h4>defaultOptions</h4>
<p>Type : <code>object</code></p>
<h3>ky.stop</h3>
<p>Un <code>Symbol</code> qui peut être retourné par un hook <code>beforeRetry</code> pour arrêter la nouvelle tentative. Cela court-circuite également les hooks <code>beforeRetry</code> restants.</p>
<p>Remarque : Retourner ce symbole fait que Ky s’arrête et retourne une réponse <code>undefined</code>. Assurez-vous de vérifier la présence d’une réponse avant d’accéder à ses propriétés ou utilisez le <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Operators/Optional_chaining">chaînage optionnel</a>. Il est également incompatible avec les méthodes de corps, telles que <code>.json()</code> ou <code>.text()</code>, car il n’y a pas de réponse à analyser. En général, nous recommandons de lever une erreur plutôt que de retourner ce symbole, car cela fera que Ky s’arrêtera puis lèvera une exception, ce qui évite ces limitations.</p>
<p>Un cas d’utilisation valide pour <code>ky.stop</code> est d’empêcher les nouvelles tentatives lors de requêtes à effet de bord, lorsque les données retournées ne sont pas importantes. Par exemple, la journalisation de l’activité client vers le serveur.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> options = {
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRetry</span>: [
			<span class="hljs-keyword">async</span> ({request, options, error, retryCount}) =&gt; {
				<span class="hljs-keyword">const</span> shouldStopRetry = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com/api'</span>);
				<span class="hljs-keyword">if</span> (shouldStopRetry) {
					<span class="hljs-keyword">return</span> ky.<span class="hljs-property">stop</span>;
				}
			}
		]
	}
};
</code></pre>
<pre><code class="language-js hljs language-javascript"><span class="hljs-comment">// Notez que la réponse sera `undefined` dans le cas où `ky.stop` est retourné.</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(<span class="hljs-string">'https://example.com'</span>, options);

<span class="hljs-comment">// L'utilisation de `.text()` ou d'autres méthodes de corps n'est pas prise en charge.</span>
<span class="hljs-keyword">const</span> text = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, options).<span class="hljs-title function_">text</span>();
</code></pre>
<h3>HTTPError</h3>
<p>Exposé pour les vérifications <code>instanceof</code>. L'erreur possède une propriété <code>response</code> avec l'objet <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a>, une propriété <code>request</code> avec l'objet <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>Request</code></a>, et une propriété <code>options</code> avec les options normalisées (soit passées à <code>ky</code> lors de la création d'une instance avec <code>ky.create()</code>, soit directement lors de l'exécution de la requête).</p>
<p>Sachez que certains types d'erreurs, comme les erreurs réseau, impliquent intrinsèquement qu'aucune réponse n'a été reçue. Dans ce cas, l'erreur ne sera pas une instance de HTTPError et ne contiendra pas de propriété <code>response</code>.</p>
<p>Si vous avez besoin de lire la réponse réelle lorsqu'une <code>HTTPError</code> s'est produite, appelez la méthode d'analyseur respective sur l'objet response. Par exemple :</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">try</span> {
	<span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>).<span class="hljs-title function_">json</span>();
} <span class="hljs-keyword">catch</span> (error) {
	<span class="hljs-keyword">if</span> (error.<span class="hljs-property">name</span> === <span class="hljs-string">'HTTPError'</span>) {
		<span class="hljs-keyword">const</span> errorJson = <span class="hljs-keyword">await</span> error.<span class="hljs-property">response</span>.<span class="hljs-title function_">json</span>();
	}
}
</code></pre>
<p>⌨️ <strong>TypeScript :</strong> Accepte un <a href="https://www.typescriptlang.org/docs/handbook/2/generics.html">paramètre de type</a> optionnel, qui par défaut est <a href="https://www.typescriptlang.org/docs/handbook/2/functions.html#unknown"><code>unknown</code></a>, et est transmis au type de retour de <code>error.response.json()</code>.</p>
<h3>TimeoutError</h3>
<p>L'erreur levée lorsque la requête expire. Elle possède une propriété <code>request</code> avec l'objet <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>Request</code></a>.</p>
<h2>Conseils</h2>
<h3>Envoi de données de formulaire</h3>
<p>L'envoi de données de formulaire dans Ky est identique à <code>fetch</code>. Il suffit de passer une instance <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData"><code>FormData</code></a> à l'option <code>body</code>. L'en-tête <code>Content-Type</code> sera automatiquement défini sur <code>multipart/form-data</code>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// `multipart/form-data`</span>
<span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();
formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'food'</span>, <span class="hljs-string">'fries'</span>);
formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'drink'</span>, <span class="hljs-string">'icetea'</span>);

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(url, {<span class="hljs-attr">body</span>: formData});
</code></pre>
<p>Si vous souhaitez envoyer les données au format <code>application/x-www-form-urlencoded</code>, vous devrez encoder les données avec <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams"><code>URLSearchParams</code></a>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// `application/x-www-form-urlencoded`</span>
<span class="hljs-keyword">const</span> searchParams = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>();
searchParams.<span class="hljs-title function_">set</span>(<span class="hljs-string">'food'</span>, <span class="hljs-string">'fries'</span>);
searchParams.<span class="hljs-title function_">set</span>(<span class="hljs-string">'drink'</span>, <span class="hljs-string">'icetea'</span>);

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(url, {<span class="hljs-attr">body</span>: searchParams});
</code></pre>
<h3>Définir un <code>Content-Type</code> personnalisé</h3>
<p>Ky définit automatiquement un en-tête <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> approprié pour chaque requête en fonction des données dans le corps de la requête. Cependant, certaines API nécessitent des types de contenu personnalisés ou non standards, comme <code>application/x-amz-json-1.1</code>. À l'aide de l'option <code>headers</code>, vous pouvez remplacer manuellement le type de contenu.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">headers</span>: {
		<span class="hljs-string">'content-type'</span>: <span class="hljs-string">'application/json'</span>
	},
	<span class="hljs-attr">json</span>: {
		<span class="hljs-attr">foo</span>: <span class="hljs-literal">true</span>
	},
}).<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json);
<span class="hljs-comment">//=&gt; {data: '🦄'}</span>
</code></pre>
<h3>Annulation</h3>
<p>Fetch (et donc Ky) prend en charge nativement l'annulation de requête via l'API <a href="https://developer.mozilla.org/en-US/docs/Web/API/AbortController"><code>AbortController</code></a>. <a href="https://developers.google.com/web/updates/2017/09/abortable-fetch">En savoir plus.</a></p>
<p>Exemple :</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();
<span class="hljs-keyword">const</span> {signal} = controller;

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
	controller.<span class="hljs-title function_">abort</span>();
}, <span class="hljs-number">5000</span>);

<span class="hljs-keyword">try</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(url, {signal}).<span class="hljs-title function_">text</span>());
} <span class="hljs-keyword">catch</span> (error) {
	<span class="hljs-keyword">if</span> (error.<span class="hljs-property">name</span> === <span class="hljs-string">'AbortError'</span>) {
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Fetch annulé'</span>);
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Erreur fetch :'</span>, error);
	}
}
</code></pre>
<h2>FAQ</h2>
<h4>Comment utiliser ceci dans Node.js ?</h4>
<p>Node.js 18 et versions ultérieures prennent en charge <code>fetch</code> nativement, vous pouvez donc utiliser ce package directement.</p>
<h4>Comment utiliser ceci avec une application web (React, Vue.js, etc.) qui utilise le rendu côté serveur (SSR) ?</h4>
<p>Comme ci-dessus.</p>
<h4>Comment tester une bibliothèque navigateur qui utilise ceci ?</h4>
<p>Utilisez soit un lanceur de tests qui peut s'exécuter dans le navigateur, comme Mocha, soit <a href="https://avajs.dev">AVA</a> avec <code>ky-universal</code>. <a href="https://github.com/sindresorhus/ky-universal#faq">En savoir plus.</a></p>
<h4>Comment utiliser ceci sans un bundler comme Webpack ?</h4>
<p>Assurez-vous que votre code s'exécute en tant que module JavaScript (ESM), par exemple en utilisant une balise <code>&lt;script type="module"&gt;</code> dans votre document HTML. Ky peut alors être importé directement par ce module sans bundler ni autres outils.</p>
<pre><code class="language-html hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="language-javascript">
<span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'https://unpkg.com/ky/distribution/index.js'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>).<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json.<span class="hljs-property">title</span>);
<span class="hljs-comment">//=&gt; 'delectus aut autem'</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h4>En quoi est-ce différent de <a href="https://github.com/sindresorhus/got"><code>got</code></a></h4>
<p>Voir ma réponse <a href="https://twitter.com/sindresorhus/status/1037406558945042432">ici</a>. Got est maintenu par les mêmes personnes que Ky.</p>
<h4>En quoi est-ce différent de <a href="https://github.com/axios/axios"><code>axios</code></a> ?</h4>
<p>Voir ma réponse <a href="https://twitter.com/sindresorhus/status/1037763588826398720">ici</a>.</p>
<h4>En quoi est-ce différent de <a href="https://github.com/mikeal/r2"><code>r2</code></a> ?</h4>
<p>Voir ma réponse dans <a href="https://github.com/sindresorhus/ky/issues/10">#10</a>.</p>
<h4>Que signifie <code>ky</code> ?</h4>
<p>C'est juste un nom de package npm court et aléatoire que j'ai réussi à obtenir. Cependant, il a une signification en japonais :</p>
<blockquote>
<p>Une forme d'argot textuel, KY est une abréviation de 空気読めない (kuuki yomenai), qui se traduit littéralement par « ne peut pas lire l'air ». C'est une expression appliquée à quelqu'un qui manque le sens implicite.</p>
</blockquote>
<h2>Compatibilité navigateur</h2>
<p>La dernière version de Chrome, Firefox et Safari.</p>
<h2>Compatibilité Node.js</h2>
<p>Node.js 18 et versions ultérieures.</p>
<h2>Liens connexes</h2>
<ul>
<li><a href="https://github.com/sindresorhus/fetch-extras">fetch-extras</a> - Utilitaires pratiques pour travailler avec Fetch</li>
<li><a href="https://github.com/alice-health/ky-hooks-change-case">ky-hooks-change-case</a> - Hooks Ky pour modifier les cas sur les requêtes et réponses des objets</li>
</ul>
<h2>Mainteneurs</h2>
<ul>
<li><a href="https://github.com/sindresorhus">Sindre Sorhus</a></li>
<li><a href="https://github.com/sholladay">Seth Holladay</a></li>
<li><a href="https://github.com/szmarczak">Szymon Marczak</a></li>
</ul>
<pre><code class="hljs language-yaml">

<span class="hljs-meta">---

</span>
<span class="hljs-string">Tranlated</span> <span class="hljs-string">By</span> [<span class="hljs-string">Open</span> <span class="hljs-string">Ai</span> <span class="hljs-string">Tx</span>]<span class="hljs-string">(https://github.com/OpenAiTx/OpenAiTx)</span> <span class="hljs-string">|</span> <span class="hljs-attr">Last indexed:</span> <span class="hljs-number">2025-06-11</span>


<span class="hljs-meta">---
</span></code></pre>
</div>
    </div>

    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async=""></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
    <script src="view.js?v=20250613"></script>


</body></html>