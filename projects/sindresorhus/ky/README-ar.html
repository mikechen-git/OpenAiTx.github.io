<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sindresorhus/ky - ky</title>

    <!-- Primary Meta Tags -->
    <meta name="title" content="sindresorhus/ky - ky">
    <meta name="description" content="sindresorhus/ky - GitHub repository documentation and information">
    <meta name="keywords" content="sindresorhus, ky, GitHub, repository, documentation, ">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ar">
    <meta property="og:title" content="sindresorhus/ky - ky">
    <meta property="og:description" content="sindresorhus/ky - GitHub repository documentation and information">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">

    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="icon.jpg">
    <link rel="apple-touch-icon" href="icon.jpg">

    <!-- Marked.js for Markdown rendering -->
    <script type="text/javascript" async="" src="https://www.statcounter.com/counter/recorder.js"></script><script src="js/marked.min.js?v=20250613"></script>
    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="css/github.min.css?v=20250613">
    <script src="js/highlight.min.js?v=20250613"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="view.css?v=20250613">
    <style>
        /* Layout */
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .main-container {
            margin: 0 auto;
            width: 100%;
            max-width: 980px;
            padding: 0 20px;
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 0 15px;
            }
        }

        /* Image size restrictions */
        .markdown-body img {
            max-width: 100%;
            height: auto;
        }

        /* Existing styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f6f8fa;
            border-bottom: 1px solid #e1e4e8;
            position: relative;
        }

        .back-button {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #0366d6;
            text-decoration: none;
            display: flex;
            align-items: center;
            font-size: 14px;
            padding: 5px 10px;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            background-color: #fff;
        }

        .back-button:hover {
            background-color: #f6f8fa;
            border-color: #0366d6;
        }

        .back-button::before {
            content: "←";
            margin-right: 5px;
            font-size: 16px;
        }

        .header .links {
            margin-top: 10px;
            font-size: 16px;
        }

        .header .links a {
            color: #0366d6;
            text-decoration: none;
            margin-left: 5px;
        }

        .header .links a:hover {
            text-decoration: underline;
        }
        
        /* Language badges styles */
        .language-badges {
            margin-top: 15px;
            text-align: center;
        }
        .language-badges a {
            display: inline-block;
            margin: 2px;
            text-decoration: none;
        }
        .language-badges img {
            height: 20px;
            border-radius: 3px;
        }
        .language-badges a:hover img {
            opacity: 0.8;
        }
    </style>
</head>

<body>
    <div class="header">
        <a href="javascript:history.back()" class="back-button">Back</a>
        <div class="links">
            GitHub Repository: <a href="https://github.com/sindresorhus/ky" id="githubRepoLink" target="_blank">sindresorhus/ky</a>
        </div>
        <div class="language-badges" id="languageBadges"><a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=en"><img src="https://img.shields.io/badge/EN-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=zh-CN"><img src="https://img.shields.io/badge/简中-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=zh-TW"><img src="https://img.shields.io/badge/繁中-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ja"><img src="https://img.shields.io/badge/日本語-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ko"><img src="https://img.shields.io/badge/한국어-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=th"><img src="https://img.shields.io/badge/ไทย-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=fr"><img src="https://img.shields.io/badge/Français-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=de"><img src="https://img.shields.io/badge/Deutsch-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=es"><img src="https://img.shields.io/badge/Español-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=it"><img src="https://img.shields.io/badge/Italiano-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ru"><img src="https://img.shields.io/badge/Русский-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=pt"><img src="https://img.shields.io/badge/Português-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=nl"><img src="https://img.shields.io/badge/Nederlands-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=pl"><img src="https://img.shields.io/badge/Polski-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=ar"><img src="https://img.shields.io/badge/العربية-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=tr"><img src="https://img.shields.io/badge/Türkçe-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=sindresorhus&amp;project=ky&amp;lang=vi"><img src="https://img.shields.io/badge/Tiếng Việt-white" alt="version"></a></div>
    </div>

    <div class="main-container">
        <div class="markdown-body" id="content"><div align="center">
	<br>
	<div>
		<img width="600" height="600" src="https://raw.githubusercontent.com/sindresorhus/ky/main/media/logo.svg" alt="ky">
	</div>
	<br>
	<br>
	<br>
</div>

<blockquote>
<p>Ky هو عميل HTTP صغير وأنيق مبني على <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch">واجهة برمجة تطبيقات الجلب Fetch API</a></p>
</blockquote>
<p><a href="https://codecov.io/gh/sindresorhus/ky"><img src="https://codecov.io/gh/sindresorhus/ky/branch/main/graph/badge.svg" alt="Coverage Status"></a><br><a href="https://bundlephobia.com/result?p=ky"><img src="https://badgen.net/bundlephobia/minzip/ky" alt=""></a></p>
<p>يستهدف Ky <a href="#browser-support">المتصفحات الحديثة</a>، وNode.js، وBun، وDeno.</p>
<p>إنه مجرد حزمة صغيرة بدون أي تبعيات.</p>
<h2>الفوائد مقارنة بـ <code>fetch</code> العادي</h2>
<ul>
<li>واجهة برمجة تطبيقات أبسط</li>
<li>اختصارات للطرق (<code>ky.post()</code>)</li>
<li>يعامل رموز الحالة غير 2xx كأخطاء (بعد عمليات إعادة التوجيه)</li>
<li>يعيد المحاولة للطلبات الفاشلة</li>
<li>خيار JSON</li>
<li>دعم المهلة الزمنية</li>
<li>خيار بادئة عنوان URL</li>
<li>مثيلات بإعدادات افتراضية مخصصة</li>
<li>Hooks</li>
<li>ميزات TypeScript (على سبيل المثال، <code>.json()</code> يدعم الأنواع العامة ويفترض افتراضياً القيمة <code>unknown</code> وليس <code>any</code>)</li>
</ul>
<h2>التثبيت</h2>
<pre><code class="language-sh hljs language-bash">npm install ky
</code></pre>
<h6>CDN</h6>
<ul>
<li><a href="https://cdn.jsdelivr.net/npm/ky/+esm">jsdelivr</a></li>
<li><a href="https://unpkg.com/ky">unpkg</a></li>
<li><a href="https://esm.sh/ky">esm.sh</a></li>
</ul>
<h2>الاستخدام</h2>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(<span class="hljs-string">'https://example.com'</span>, {<span class="hljs-attr">json</span>: {<span class="hljs-attr">foo</span>: <span class="hljs-literal">true</span>}}).<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json);
<span class="hljs-comment">//=&gt; {data: '🦄'}</span>
</code></pre>
<p>باستخدام <code>fetch</code> العادي، سيكون الأمر كالتالي:</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HTTPError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Error</span> {}

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
	<span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({<span class="hljs-attr">foo</span>: <span class="hljs-literal">true</span>}),
	<span class="hljs-attr">headers</span>: {
		<span class="hljs-string">'content-type'</span>: <span class="hljs-string">'application/json'</span>
	}
});

<span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
	<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HTTPError</span>(<span class="hljs-string">`Fetch error: <span class="hljs-subst">${response.statusText}</span>`</span>);
}

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json);
<span class="hljs-comment">//=&gt; {data: '🦄'}</span>
</code></pre>
<p>إذا كنت تستخدم <a href="https://github.com/denoland/deno">Deno</a>، قم باستيراد Ky من عنوان URL. على سبيل المثال، باستخدام CDN:</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'https://esm.sh/ky'</span>;
</code></pre>
<h2>واجهة برمجة التطبيقات (API)</h2>
<h3>ky(input, options?)</h3>
<p>المعاملان <code>input</code> و<code>options</code> هما نفس معاملَي <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch"><code>fetch</code></a>، مع توفر خيارات إضافية (انظر أدناه).</p>
<p>تعيد <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">كائن <code>Response</code></a> مع <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch#body">طرق <code>Body</code></a> مضافة من أجل الراحة. لذا يمكنك، على سبيل المثال، استدعاء <code>ky.get(input).json()</code> مباشرة دون الحاجة إلى انتظار <code>Response</code> أولاً. عند الاستدعاء بهذه الطريقة، سيتم تعيين ترويسة <code>Accept</code> المناسبة حسب طريقة الجسم المستخدمة. على عكس طرق الجسم في <code>window.Fetch</code>، ستقوم هذه الطرق برمي خطأ من نوع <code>HTTPError</code> إذا لم تكن حالة الاستجابة ضمن النطاق <code>200...299</code>. أيضاً، ستعيد <code>.json()</code> سلسلة فارغة إذا كان الجسم فارغاً أو كانت حالة الاستجابة <code>204</code> بدلاً من رمي خطأ تحليل بسبب الجسم الفارغ.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'/api/user'</span>).<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user);
</code></pre>
<p>⌨️ <strong>TypeScript:</strong> تقبل معلمة نوعية اختيارية <a href="https://www.typescriptlang.org/docs/handbook/2/generics.html">type parameter</a>، والتي تفترض افتراضياً <a href="https://www.typescriptlang.org/docs/handbook/2/functions.html#unknown"><code>unknown</code></a>، ويتم تمريرها إلى نوع القيمة المرجعة من <code>.json()</code>.</p>
<pre><code class="language-ts hljs language-typescript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// user1 هو unknown</span>
<span class="hljs-keyword">const</span> user1 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'/api/users/1'</span>).<span class="hljs-title function_">json</span>();
<span class="hljs-comment">// user2 هو User</span>
<span class="hljs-keyword">const</span> user2 = <span class="hljs-keyword">await</span> ky&lt;<span class="hljs-title class_">User</span>&gt;(<span class="hljs-string">'/api/users/2'</span>).<span class="hljs-title function_">json</span>();
<span class="hljs-comment">// user3 هو User</span>
<span class="hljs-keyword">const</span> user3 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'/api/users/3'</span>).<span class="hljs-property">json</span>&lt;<span class="hljs-title class_">User</span>&gt;();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([user1, user2, user3]);
</code></pre>
<h3>ky.get(input, options?)</h3>
<h3>ky.post(input, options?)</h3>
<h3>ky.put(input, options?)</h3>
<h3>ky.patch(input, options?)</h3>
<h3>ky.head(input, options?)</h3>
<h3>ky.delete(input, options?)</h3>
<p>يضبط <code>options.method</code> على اسم الطريقة ويجري الطلب.</p>
<p>⌨️ <strong>TypeScript:</strong> يقبل معلمة نوعية اختيارية للاستخدام مع استجابات JSON (انظر <a href="#kyinput-options"><code>ky()</code></a>).</p>
<h4>input</h4>
<p>النوع: <code>string</code> | <code>URL</code> | <code>Request</code></p>
<p>نفس <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request/Request#input">مدخلات <code>fetch</code></a>.</p>
<p>عند استخدام كائن <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>Request</code></a> كمدخل <code>input</code>، سيتم تجاهل أي خيارات تغير عنوان URL (مثل <code>prefixUrl</code>).</p>
<h4>options</h4>
<p>النوع: <code>object</code></p>
<p>نفس <a href="https://developer.mozilla.org/en-US/docs/Web/API/fetch#options">خيارات <code>fetch</code></a>، بالإضافة إلى الخيارات الإضافية التالية:</p>
<h5>method</h5>
<p>النوع: <code>string</code><br>القيمة الافتراضية: <code>'get'</code></p>
<p>طريقة HTTP المستخدمة لإجراء الطلب.</p>
<p>داخلياً، يتم تحويل الطرق القياسية (<code>GET</code>، <code>POST</code>، <code>PUT</code>، <code>PATCH</code>، <code>HEAD</code> و<code>DELETE</code>) إلى أحرف كبيرة لتجنب أخطاء الخادم الناتجة عن حساسية حالة الأحرف.</p>
<h5>json</h5>
<p>النوع: <code>object</code> وأي قيمة أخرى تقبلها <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify"><code>JSON.stringify()</code></a></p>
<p>اختصار لإرسال JSON. استخدم هذا بدلاً من خيار <code>body</code>. يقبل أي كائن عادي أو قيمة، وسيتم تحويلها إلى <code>JSON.stringify()</code> وإرسالها في الجسم مع تعيين الترويسة الصحيحة تلقائياً.</p>
<h5>searchParams</h5>
<p>النوع: <code>string | object&lt;string, string | number | boolean&gt; | Array&lt;Array&lt;string | number | boolean&gt;&gt; | URLSearchParams</code><br>القيمة الافتراضية: <code>''</code></p>
<p>معاملات البحث التي سيتم تضمينها في عنوان URL للطلب. تعيين هذا سيستبدل جميع معاملات البحث الموجودة في عنوان URL المدخل.</p>
<p>يقبل أي قيمة مدعومة من <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams/URLSearchParams"><code>URLSearchParams()</code></a>.</p>
<h5>prefixUrl</h5>
<p>النوع: <code>string | URL</code></p>
<p>بادئة لإضافتها إلى عنوان URL المدخل عند إجراء الطلب. يمكن أن تكون أي عنوان URL صالح، سواء نسبي أو مطلق. الفاصلة المائلة <code>/</code> في النهاية اختيارية وستتم إضافتها تلقائياً إذا لزم الأمر عند ربطها بـ<code>input</code>. يسري هذا الخيار فقط عندما يكون <code>input</code> نصياً. لا يمكن أن يبدأ معامل <code>input</code> بشرطة مائلة <code>/</code> عند استخدام هذا الخيار.</p>
<p>مفيد عند استخدامه مع <a href="#kyextenddefaultoptions"><code>ky.extend()</code></a> لإنشاء مثيلات Ky مخصصة لمجالات محددة.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// على https://example.com</span>

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'unicorn'</span>, {<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">'/api'</span>});
<span class="hljs-comment">//=&gt; 'https://example.com/api/unicorn'</span>

<span class="hljs-keyword">const</span> response2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'unicorn'</span>, {<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">'https://cats.com'</span>});
<span class="hljs-comment">//=&gt; 'https://cats.com/unicorn'</span>
</code></pre>
<p>ملاحظات:</p>
<ul>
<li>بعد دمج <code>prefixUrl</code> و<code>input</code>، يتم حل النتيجة مقابل <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/baseURI">عنوان URL الأساسي</a> للصفحة (إن وجد).</li>
<li>الشرطات المائلة في بداية <code>input</code> غير مسموحة عند استخدام هذا الخيار للحفاظ على الاتساق وتجنب الالتباس حول كيفية التعامل مع عنوان URL المدخل، حيث أن <code>input</code> لن يتبع قواعد حل عنوان URL المعتادة عند استخدام <code>prefixUrl</code>، مما يغير معنى الشرطة المائلة في البداية.</li>
</ul>
<h5>retry</h5>
<p>النوع: <code>object | number</code><br>القيم الافتراضية:</p>
<ul>
<li><code>limit</code>: <code>2</code></li>
<li><code>methods</code>: <code>get</code> <code>put</code> <code>head</code> <code>delete</code> <code>options</code> <code>trace</code></li>
<li><code>statusCodes</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/408"><code>408</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/413"><code>413</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429"><code>429</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500"><code>500</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502"><code>502</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/503"><code>503</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/504"><code>504</code></a></li>
<li><code>afterStatusCodes</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/413"><code>413</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429"><code>429</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/503"><code>503</code></a></li>
<li><code>maxRetryAfter</code>: <code>undefined</code></li>
<li><code>backoffLimit</code>: <code>undefined</code></li>
<li><code>delay</code>: <code>attemptCount =&gt; 0.3 * (2 ** (attemptCount - 1)) * 1000</code></li>
</ul>
<p>كائن يُمثّل حقول <code>limit</code> و<code>methods</code> و<code>statusCodes</code> و<code>afterStatusCodes</code> و<code>maxRetryAfter</code> لعدد المحاولات القصوى، والأساليب المسموح بها، وأكواد الحالة المسموح بها، وأكواد الحالة المسموح لها باستخدام وقت <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a>، وأقصى وقت لـ <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a>.</p>
<p>إذا كانت قيمة <code>retry</code> رقمًا، سيتم استخدامها كـ <code>limit</code> وستبقى القيم الافتراضية الأخرى كما هي.</p>
<p>إذا قدّم الرد كود HTTP موجود في <code>afterStatusCodes</code>، ستنتظر Ky حتى يمر التاريخ أو المهلة أو الطابع الزمني المُعطى في ترويسة <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a> قبل إعادة محاولة الطلب. إذا كانت ترويسة <code>Retry-After</code> مفقودة، سيتم استخدام الترويسة غير القياسية <a href="https://www.ietf.org/archive/id/draft-polli-ratelimit-headers-05.html#section-3.3"><code>RateLimit-Reset</code></a> كخيار بديل. إذا لم يكن كود الحالة المُقدم موجودًا في القائمة، سيتم تجاهل ترويسة <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a>.</p>
<p>إذا تم تعيين <code>maxRetryAfter</code> إلى <code>undefined</code>، سيتم استخدام <code>options.timeout</code>. إذا كانت قيمة ترويسة <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a> أكبر من <code>maxRetryAfter</code>، سيتم استخدام <code>maxRetryAfter</code>.</p>
<p>خيار <code>backoffLimit</code> هو الحد الأعلى للتأخير لكل محاولة إعادة في المللي ثانية.<br>لتقييد التأخير، عيّن <code>backoffLimit</code> إلى 1000، كمثال.<br>افتراضيًا، يتم حساب التأخير باستخدام <code>0.3 * (2 ** (attemptCount - 1)) * 1000</code>. يزداد التأخير بشكل أُسي.</p>
<p>يمكن استخدام خيار <code>delay</code> لتغيير كيفية حساب التأخير بين المحاولات. تستقبل الدالة معاملًا واحدًا، وهو عدد المحاولة، بدءًا من <code>1</code>.</p>
<p>لا يتم تفعيل إعادة المحاولة بعد <a href="#timeout">انتهاء المهلة</a>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">retry</span>: {
		<span class="hljs-attr">limit</span>: <span class="hljs-number">10</span>,
		<span class="hljs-attr">methods</span>: [<span class="hljs-string">'get'</span>],
		<span class="hljs-attr">statusCodes</span>: [<span class="hljs-number">413</span>],
		<span class="hljs-attr">backoffLimit</span>: <span class="hljs-number">3000</span>
	}
}).<span class="hljs-title function_">json</span>();
</code></pre>
<h5>timeout</h5>
<p>النوع: <code>number | false</code><br>القيمة الافتراضية: <code>10000</code></p>
<p>المهلة بالمللي ثانية للحصول على استجابة، بما في ذلك أي محاولات إعادة. لا يمكن أن تكون أكبر من 2147483647.<br>إذا تم تعيينها إلى <code>false</code>، لن يكون هناك مهلة.</p>
<h5>hooks</h5>
<p>النوع: <code>object&lt;string, Function[]&gt;</code><br>القيمة الافتراضية: <code>{beforeRequest: [], beforeRetry: [], afterResponse: []}</code></p>
<p>تسمح الـ Hooks بالتعديلات أثناء دورة حياة الطلب. قد تكون دوال الـ Hook غير متزامنة ويتم تنفيذها بشكل تسلسلي.</p>
<h6>hooks.beforeRequest</h6>
<p>النوع: <code>Function[]</code><br>القيمة الافتراضية: <code>[]</code></p>
<p>يتيح لك هذا الـ hook تعديل الطلب مباشرة قبل إرساله. لن تقوم Ky بأي تغييرات أخرى على الطلب بعد ذلك. تستقبل دالة الـ hook وسيطي <code>request</code> و<code>options</code> كوسائط. يمكنك، على سبيل المثال، تعديل <code>request.headers</code> هنا.</p>
<p>يمكن أن تُرجع الـ hook كائن <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>Request</code></a> لاستبدال الطلب المُرسل، أو تُرجع كائن <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> لتجنب إجراء طلب HTTP بالكامل. يمكن استخدام ذلك لمحاكاة طلب، أو التحقق من ذاكرة تخزين مؤقت داخلية، إلخ. من <strong>المهم</strong> عند إعادة طلب أو استجابة من هذا الـ hook أن أي hooks متبقية من <code>beforeRequest</code> سيتم تجاوزها، لذا قد ترغب في إرجاعها فقط من الـ hook الأخير.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> api = ky.<span class="hljs-title function_">extend</span>({
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRequest</span>: [
			<span class="hljs-function"><span class="hljs-params">request</span> =&gt;</span> {
				request.<span class="hljs-property">headers</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'X-Requested-With'</span>, <span class="hljs-string">'ky'</span>);
			}
		]
	}
});

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'https://example.com/api/users'</span>);
</code></pre>
<h6>hooks.beforeRetry</h6>
<p>النوع: <code>Function[]</code><br>القيمة الافتراضية: <code>[]</code></p>
<p>يتيح لك هذا الـ hook تعديل الطلب مباشرة قبل إعادة المحاولة. لن تقوم Ky بأي تغييرات أخرى على الطلب بعد ذلك. تستقبل دالة الـ hook كائنًا يحتوي على الطلب والخيارات المُوحّدة، وكائن خطأ، وعدد المحاولة. يمكنك، على سبيل المثال، تعديل <code>request.headers</code> هنا.</p>
<p>إذا تلقى الطلب استجابة، سيكون الخطأ من نوع <code>HTTPError</code> وسيكون كائن <code>Response</code> متاحًا في <code>error.response</code>. انتبه إلى أن بعض أنواع الأخطاء، مثل أخطاء الشبكة، تعني بطبيعتها أنه لم يتم استلام استجابة. في هذه الحالة، لن يكون الخطأ من نوع <code>HTTPError</code>.</p>
<p>يمكنك منع Ky من إعادة محاولة الطلب عن طريق رمي خطأ. لن تتعامل Ky معه بأي طريقة وسيتم تمرير الخطأ إلى جهة استدعاء الطلب. لن يتم استدعاء بقية الـ hooks من نوع <code>beforeRetry</code> في هذه الحالة. بدلاً من ذلك، يمكنك إرجاع الرمز <a href="#kystop"><code>ky.stop</code></a> لتحقيق نفس الغرض ولكن دون تمرير خطأ (لهذا بعض القيود، راجع وثائق <code>ky.stop</code> لمزيد من التفاصيل).</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRetry</span>: [
			<span class="hljs-keyword">async</span> ({request, options, error, retryCount}) =&gt; {
				<span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com/refresh-token'</span>);
				request.<span class="hljs-property">headers</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">`token <span class="hljs-subst">${token}</span>`</span>);
			}
		]
	}
});
</code></pre>
<h6>hooks.beforeError</h6>
<p>النوع: <code>Function[]</code><br>القيمة الافتراضية: <code>[]</code></p>
<p>يتيح لك هذا الـ hook تعديل كائن <code>HTTPError</code> مباشرة قبل رميه. تستقبل دالة الـ hook كائن <code>HTTPError</code> كوسيط ويجب أن تُعيد نسخة من <code>HTTPError</code>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeError</span>: [
			<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
				<span class="hljs-keyword">const</span> {response} = error;
				<span class="hljs-keyword">if</span> (response &amp;&amp; response.<span class="hljs-property">body</span>) {
					error.<span class="hljs-property">name</span> = <span class="hljs-string">'GitHubError'</span>;
					error.<span class="hljs-property">message</span> = <span class="hljs-string">`<span class="hljs-subst">${response.body.message}</span> (<span class="hljs-subst">${response.status}</span>)`</span>;
				}

				<span class="hljs-keyword">return</span> error;
			}
		]
	}
});
</code></pre>
<h6>hooks.afterResponse</h6>
<p>النوع: <code>Function[]</code><br>القيمة الافتراضية: <code>[]</code></p>
<p>يتيح لك هذا الـ hook قراءة الاستجابة واختيارياً تعديلها. تستقبل دالة الـ hook الطلب المُوحّد، الخيارات، ونسخة من الاستجابة كوسائط. سيتم استخدام قيمة الإرجاع من دالة الـ hook بواسطة Ky ككائن استجابة إذا كانت نسخة من <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">afterResponse</span>: [
			<span class="hljs-function">(<span class="hljs-params">_request, _options, response</span>) =&gt;</span> {
				<span class="hljs-comment">// يمكنك القيام بشيء مع الاستجابة، مثلاً تسجيلها.</span>
				<span class="hljs-title function_">log</span>(response);

				<span class="hljs-comment">// أو إرجاع نسخة `Response` لاستبدال الاستجابة.</span>
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(<span class="hljs-string">'A different response'</span>, {<span class="hljs-attr">status</span>: <span class="hljs-number">200</span>});
			},

			<span class="hljs-comment">// أو إعادة المحاولة باستخدام رمز جديد عند حدوث خطأ 403</span>
			<span class="hljs-keyword">async</span> (request, options, response) =&gt; {
				<span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">403</span>) {
					<span class="hljs-comment">// الحصول على رمز جديد</span>
					<span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com/token'</span>).<span class="hljs-title function_">text</span>();

					<span class="hljs-comment">// إعادة المحاولة باستخدام الرمز</span>
					request.<span class="hljs-property">headers</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">`token <span class="hljs-subst">${token}</span>`</span>);

					<span class="hljs-keyword">return</span> <span class="hljs-title function_">ky</span>(request);
				}
			}
		]
	}
});
</code></pre>
<h5>throwHttpErrors</h5>
<p>النوع: <code>boolean</code><br>القيمة الافتراضية: <code>true</code></p>
<p>إلقاء خطأ <code>HTTPError</code> عند حصول استجابة بكود حالة غير 2xx بعد اتباع التحويلات. لإلقاء خطأ أيضاً عند التحويلات بدلاً من متابعتها، عيّن خيار <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters"><code>redirect</code></a> إلى <code>'manual'</code>.</p>
<p>قد يكون تعيين هذا إلى <code>false</code> مفيدًا إذا كنت تتحقق من توفر المورد وتتوقع استجابات أخطاء.</p>
<p>ملاحظة: إذا كانت <code>false</code>، تعتبر استجابات الخطأ ناجحة ولن يتم إعادة محاولة الطلب.</p>
<h5>onDownloadProgress</h5>
<p>النوع: <code>Function</code></p>
<p>معالج حدث تقدم التحميل.</p>
<p>تستقبل الدالة هذه الوسائط:</p>
<ul>
<li><code>progress</code> وهو كائن يحتوي على هذه الخصائص:</li>
<li><ul>
<li><code>percent</code> رقم بين 0 و 1 يمثل نسبة التقدم.</li>
</ul>
</li>
<li><ul>
<li><code>transferredBytes</code> هو عدد البايتات المنقولة حتى الآن.</li>
</ul>
</li>
<li><ul>
<li><code>totalBytes</code> هو إجمالي عدد البايتات المطلوب نقلها. هذا تقديري وقد يكون 0 إذا تعذر تحديد الحجم الكلي.</li>
</ul>
</li>
<li><code>chunk</code> هو نسخة من <code>Uint8Array</code> تحتوي على البيانات المرسلة. ملاحظة: تكون فارغة في أول استدعاء.</li>
</ul>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">onDownloadProgress</span>: <span class="hljs-function">(<span class="hljs-params">progress, chunk</span>) =&gt;</span> {
		<span class="hljs-comment">// مثال على الإخراج:</span>
		<span class="hljs-comment">// `0% - 0 of 1271 bytes`</span>
		<span class="hljs-comment">// `100% - 1271 of 1271 bytes`</span>
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${progress.percent * <span class="hljs-number">100</span>}</span>% - <span class="hljs-subst">${progress.transferredBytes}</span> of <span class="hljs-subst">${progress.totalBytes}</span> bytes`</span>);
	}
});
</code></pre>
<h5>onUploadProgress</h5>
<p>النوع: <code>Function</code></p>
<p>معالج حدث تقدم التحميل.</p>
<p>تستقبل الدالة الوسيطات التالية:</p>
<ul>
<li><code>progress</code> هو كائن يحتوي على الخصائص التالية:</li>
<li><ul>
<li><code>percent</code> هو رقم بين 0 و 1 يمثل نسبة التقدم.</li>
</ul>
</li>
<li><ul>
<li><code>transferredBytes</code> هو عدد البايتات التي تم نقلها حتى الآن.</li>
</ul>
</li>
<li><ul>
<li><code>totalBytes</code> هو إجمالي عدد البايتات التي سيتم نقلها. هذا تقدير وقد يكون 0 إذا تعذر تحديد الحجم الكلي.</li>
</ul>
</li>
<li><code>chunk</code> هو مثيل من <code>Uint8Array</code> يحتوي على البيانات التي تم إرسالها. ملاحظة: يكون فارغًا في الاستدعاء الأخير.</li>
</ul>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(<span class="hljs-string">'https://example.com/upload'</span>, {
	<span class="hljs-attr">body</span>: largeFile,
	<span class="hljs-attr">onUploadProgress</span>: <span class="hljs-function">(<span class="hljs-params">progress, chunk</span>) =&gt;</span> {
		<span class="hljs-comment">// مثال على المخرجات:</span>
		<span class="hljs-comment">// `0% - 0 of 1271 bytes`</span>
		<span class="hljs-comment">// `100% - 1271 of 1271 bytes`</span>
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${progress.percent * <span class="hljs-number">100</span>}</span>% - <span class="hljs-subst">${progress.transferredBytes}</span> of <span class="hljs-subst">${progress.totalBytes}</span> bytes`</span>);
	}
});
</code></pre>
<h5>parseJson</h5>
<p>النوع: <code>Function</code><br>القيمة الافتراضية: <code>JSON.parse()</code></p>
<p>دالة تحليل JSON مخصصة من قبل المستخدم.</p>
<p>حالات الاستخدام:</p>
<ol>
<li>تحليل JSON عبر حزمة <a href="https://github.com/hapijs/bourne"><code>bourne</code></a> للحماية من تلوث النماذج الأولية (prototype pollution).</li>
<li>تحليل JSON مع خيار <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse"><code>reviver</code> في <code>JSON.parse()</code></a>.</li>
</ol>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;
<span class="hljs-keyword">import</span> bourne <span class="hljs-keyword">from</span> <span class="hljs-string">'@hapijs/bourne'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">parseJson</span>: <span class="hljs-function"><span class="hljs-params">text</span> =&gt;</span> <span class="hljs-title function_">bourne</span>(text)
}).<span class="hljs-title function_">json</span>();
</code></pre>
<h5>stringifyJson</h5>
<p>النوع: <code>Function</code><br>القيمة الافتراضية: <code>JSON.stringify()</code></p>
<p>دالة تحويل JSON إلى سلسلة نصية مخصصة من قبل المستخدم.</p>
<p>حالات الاستخدام:</p>
<ol>
<li>تحويل JSON إلى نص مع دالة <code>replacer</code> مخصصة.</li>
</ol>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">DateTime</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'luxon'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">stringifyJson</span>: <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data, <span class="hljs-function">(<span class="hljs-params">key, value</span>) =&gt;</span> {
		<span class="hljs-keyword">if</span> (key.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'_at'</span>)) {
			<span class="hljs-keyword">return</span> <span class="hljs-title class_">DateTime</span>.<span class="hljs-title function_">fromISO</span>(value).<span class="hljs-title function_">toSeconds</span>();
		}

		<span class="hljs-keyword">return</span> value;
	})
}).<span class="hljs-title function_">json</span>();
</code></pre>
<h5>fetch</h5>
<p>النوع: <code>Function</code><br>القيمة الافتراضية: <code>fetch</code></p>
<p>دالة <code>fetch</code> مخصصة من قبل المستخدم.<br>يجب أن تكون متوافقة بالكامل مع معيار <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">واجهة برمجة التطبيقات Fetch</a>.</p>
<p>حالات الاستخدام:</p>
<ol>
<li>استخدام تطبيقات <code>fetch</code> مخصصة مثل <a href="https://www.npmjs.com/package/isomorphic-unfetch"><code>isomorphic-unfetch</code></a>.</li>
<li>استخدام دالة تغليف <code>fetch</code> التي توفرها بعض الأطر التي تستخدم العرض من جهة الخادم (SSR).</li>
</ol>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;
<span class="hljs-keyword">import</span> fetch <span class="hljs-keyword">from</span> <span class="hljs-string">'isomorphic-unfetch'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>, {fetch}).<span class="hljs-title function_">json</span>();
</code></pre>
<h3>ky.extend(defaultOptions)</h3>
<p>إنشاء مثيل جديد من <code>ky</code> مع بعض القيم الافتراضية التي يتم تجاوزها بقيمك الخاصة.</p>
<p>على عكس <code>ky.create()</code>, فإن <code>ky.extend()</code> يرث القيم الافتراضية من الأصل.</p>
<p>يمكنك تمرير الرؤوس ككائن <code>Headers</code> أو ككائن عادي.</p>
<p>يمكنك إزالة رأس باستخدام <code>.extend()</code> عن طريق تمرير الرأس بقيمة <code>undefined</code>.<br>تمرير <code>undefined</code> كسلسلة يزيل الرأس فقط إذا كان قادمًا من كائن <code>Headers</code>.</p>
<p>وبالمثل، يمكنك إزالة إدخالات <code>hooks</code> الموجودة عن طريق توسيع hook بقيمة <code>undefined</code> صريحة.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> url = <span class="hljs-string">'https://sindresorhus.com'</span>;

<span class="hljs-keyword">const</span> original = ky.<span class="hljs-title function_">create</span>({
	<span class="hljs-attr">headers</span>: {
		<span class="hljs-attr">rainbow</span>: <span class="hljs-string">'rainbow'</span>,
		<span class="hljs-attr">unicorn</span>: <span class="hljs-string">'unicorn'</span>
	},
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRequest</span>: [ <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'before 1'</span>) ],
		<span class="hljs-attr">afterResponse</span>: [ <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'after 1'</span>) ],
	},
});

<span class="hljs-keyword">const</span> extended = original.<span class="hljs-title function_">extend</span>({
	<span class="hljs-attr">headers</span>: {
		<span class="hljs-attr">rainbow</span>: <span class="hljs-literal">undefined</span>
	},
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRequest</span>: <span class="hljs-literal">undefined</span>,
		<span class="hljs-attr">afterResponse</span>: [ <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'after 2'</span>) ],
	}
});

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">extended</span>(url).<span class="hljs-title function_">json</span>();
<span class="hljs-comment">//=&gt; after 1</span>
<span class="hljs-comment">//=&gt; after 2</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'rainbow'</span> <span class="hljs-keyword">in</span> response);
<span class="hljs-comment">//=&gt; false</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'unicorn'</span> <span class="hljs-keyword">in</span> response);
<span class="hljs-comment">//=&gt; true</span>
</code></pre>
<p>يمكنك أيضًا الرجوع إلى القيم الافتراضية للأصل عن طريق توفير دالة إلى <code>.extend()</code>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> api = ky.<span class="hljs-title function_">create</span>({<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">'https://example.com/api'</span>});

<span class="hljs-keyword">const</span> usersApi = api.<span class="hljs-title function_">extend</span>(<span class="hljs-function">(<span class="hljs-params">options</span>) =&gt;</span> ({<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">`<span class="hljs-subst">${options.prefixUrl}</span>/users`</span>}));

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> usersApi.<span class="hljs-title function_">get</span>(<span class="hljs-string">'123'</span>);
<span class="hljs-comment">//=&gt; 'https://example.com/api/users/123'</span>

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'version'</span>);
<span class="hljs-comment">//=&gt; 'https://example.com/api/version'</span>
</code></pre>
<h3>ky.create(defaultOptions)</h3>
<p>إنشاء مثيل جديد من Ky مع قيم افتراضية جديدة بالكامل.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// على https://my-site.com</span>

<span class="hljs-keyword">const</span> api = ky.<span class="hljs-title function_">create</span>({<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">'https://example.com/api'</span>});

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'users/123'</span>);
<span class="hljs-comment">//=&gt; 'https://example.com/api/users/123'</span>

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/status'</span>, {<span class="hljs-attr">prefixUrl</span>: <span class="hljs-string">''</span>});
<span class="hljs-comment">//=&gt; 'https://my-site.com/status'</span>
</code></pre>
<h4>defaultOptions</h4>
<p>النوع: <code>object</code></p>
<h3>ky.stop</h3>
<p>رمز <code>Symbol</code> يمكن إرجاعه بواسطة hook <code>beforeRetry</code> لإيقاف إعادة المحاولة. سيؤدي ذلك أيضًا إلى إنهاء hooks <code>beforeRetry</code> المتبقية.</p>
<p>ملاحظة: إرجاع هذا الرمز يجعل Ky يتوقف ويعيد استجابة بقيمة <code>undefined</code>. تأكد من التحقق من وجود استجابة قبل الوصول إلى أي خاصية فيها أو استخدم <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining">اختيارية السلسلة</a>. كما أنه غير متوافق مع دوال الجسم مثل <code>.json()</code> أو <code>.text()</code>، لأنه لا توجد استجابة لتحليلها. بشكل عام، ننصح برمي خطأ بدلاً من إرجاع هذا الرمز، لأن ذلك سيجعل Ky يتوقف ثم يرمي خطأ، مما يتجنب هذه القيود.</p>
<p>حالة استخدام صالحة لـ <code>ky.stop</code> هي منع إعادة المحاولة عند إجراء طلبات من أجل تأثيرات جانبية، حيث أن البيانات المرجعة غير مهمة. على سبيل المثال، تسجيل نشاط العميل على الخادم.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> options = {
	<span class="hljs-attr">hooks</span>: {
		<span class="hljs-attr">beforeRetry</span>: [
			<span class="hljs-keyword">async</span> ({request, options, error, retryCount}) =&gt; {
				<span class="hljs-keyword">const</span> shouldStopRetry = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com/api'</span>);
				<span class="hljs-keyword">if</span> (shouldStopRetry) {
					<span class="hljs-keyword">return</span> ky.<span class="hljs-property">stop</span>;
				}
			}
		]
	}
};
</code></pre>
<pre><code class="language-markdown hljs">// لاحظ أن response ستكون <span class="hljs-code">`undefined`</span> في حالة إرجاع <span class="hljs-code">`ky.stop`</span>.
const response = await ky.post('https://example.com', options);

// استخدام <span class="hljs-code">`.text()`</span> أو طرق أخرى للجسم غير مدعوم.
const text = await ky('https://example.com', options).text();
</code></pre>
<h3>HTTPError</h3>
<p>مكشوف لاستخدامه في فحص <code>instanceof</code>. يحتوي الخطأ على خاصية <code>response</code> مع <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">كائن Response</a>، وخاصية <code>request</code> مع <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request">كائن Request</a>، وخاصية <code>options</code> مع الخيارات المعيارية (إما الممررة إلى <code>ky</code> عند إنشاء نسخة باستخدام <code>ky.create()</code> أو مباشرة عند تنفيذ الطلب).</p>
<p>كن على علم أن بعض أنواع الأخطاء، مثل أخطاء الشبكة، تعني بطبيعتها أنه لم يتم استلام رد. في هذه الحالة، لن يكون الخطأ من نوع HTTPError ولن يحتوي على خاصية <code>response</code>.</p>
<p>إذا كنت بحاجة لقراءة الرد الفعلي عند حدوث <code>HTTPError</code>، استدعي طريقة التحليل المناسبة على كائن الرد. على سبيل المثال:</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">try</span> {
	<span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://example.com'</span>).<span class="hljs-title function_">json</span>();
} <span class="hljs-keyword">catch</span> (error) {
	<span class="hljs-keyword">if</span> (error.<span class="hljs-property">name</span> === <span class="hljs-string">'HTTPError'</span>) {
		<span class="hljs-keyword">const</span> errorJson = <span class="hljs-keyword">await</span> error.<span class="hljs-property">response</span>.<span class="hljs-title function_">json</span>();
	}
}
</code></pre>
<p>⌨️ <strong>TypeScript:</strong> يقبل <a href="https://www.typescriptlang.org/docs/handbook/2/generics.html">معامل نوع اختياري</a>، والذي يكون افتراضياً <a href="https://www.typescriptlang.org/docs/handbook/2/functions.html#unknown"><code>unknown</code></a>، ويتم تمريره إلى نوع الإرجاع لـ <code>error.response.json()</code>.</p>
<h3>TimeoutError</h3>
<p>الخطأ الذي يتم إطلاقه عند انتهاء مهلة الطلب. يحتوي على خاصية <code>request</code> مع <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request">كائن Request</a>.</p>
<h2>نصائح</h2>
<h3>إرسال بيانات النماذج</h3>
<p>إرسال بيانات النماذج في Ky مطابق تماماً لـ <code>fetch</code>. فقط مرر <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData">كائن FormData</a> إلى خيار <code>body</code>. سيتم تعيين ترويسة <code>Content-Type</code> تلقائياً إلى <code>multipart/form-data</code>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// `multipart/form-data`</span>
<span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();
formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'food'</span>, <span class="hljs-string">'fries'</span>);
formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'drink'</span>, <span class="hljs-string">'icetea'</span>);

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(url, {<span class="hljs-attr">body</span>: formData});
</code></pre>
<p>إذا كنت ترغب في إرسال البيانات بصيغة <code>application/x-www-form-urlencoded</code>، ستحتاج إلى ترميز البيانات باستخدام <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams">URLSearchParams</a>.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-comment">// `application/x-www-form-urlencoded`</span>
<span class="hljs-keyword">const</span> searchParams = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>();
searchParams.<span class="hljs-title function_">set</span>(<span class="hljs-string">'food'</span>, <span class="hljs-string">'fries'</span>);
searchParams.<span class="hljs-title function_">set</span>(<span class="hljs-string">'drink'</span>, <span class="hljs-string">'icetea'</span>);

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(url, {<span class="hljs-attr">body</span>: searchParams});
</code></pre>
<h3>تعيين <code>Content-Type</code> مخصص</h3>
<p>يقوم Ky تلقائياً بتعيين ترويسة <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> مناسبة لكل طلب بناءً على البيانات في جسم الطلب. ومع ذلك، تتطلب بعض واجهات برمجة التطبيقات أنواع محتوى مخصصة وغير قياسية، مثل <code>application/x-amz-json-1.1</code>. باستخدام خيار <code>headers</code> يمكنك تجاوز نوع المحتوى يدوياً.</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> ky.<span class="hljs-title function_">post</span>(<span class="hljs-string">'https://example.com'</span>, {
	<span class="hljs-attr">headers</span>: {
		<span class="hljs-string">'content-type'</span>: <span class="hljs-string">'application/json'</span>
	},
	<span class="hljs-attr">json</span>: {
		<span class="hljs-attr">foo</span>: <span class="hljs-literal">true</span>
	},
}).<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json);
<span class="hljs-comment">//=&gt; {data: '🦄'}</span>
</code></pre>
<h3>الإلغاء</h3>
<p>يدعم Fetch (وبالتالي Ky) إلغاء الطلبات مدمجاً من خلال <a href="https://developer.mozilla.org/en-US/docs/Web/API/AbortController">واجهة AbortController</a>. <a href="https://developers.google.com/web/updates/2017/09/abortable-fetch">اقرأ المزيد.</a></p>
<p>مثال:</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'ky'</span>;

<span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();
<span class="hljs-keyword">const</span> {signal} = controller;

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
	controller.<span class="hljs-title function_">abort</span>();
}, <span class="hljs-number">5000</span>);

<span class="hljs-keyword">try</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(url, {signal}).<span class="hljs-title function_">text</span>());
} <span class="hljs-keyword">catch</span> (error) {
	<span class="hljs-keyword">if</span> (error.<span class="hljs-property">name</span> === <span class="hljs-string">'AbortError'</span>) {
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'تم إلغاء الجلب'</span>);
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'خطأ في الجلب:'</span>, error);
	}
}
</code></pre>
<h2>الأسئلة الشائعة</h2>
<h4>كيف أستخدم هذا في Node.js؟</h4>
<p>يدعم Node.js 18 وما بعده <code>fetch</code> بشكل أصلي، لذلك يمكنك استخدام هذه الحزمة مباشرة.</p>
<h4>كيف أستخدم هذا مع تطبيق ويب (React, Vue.js, إلخ) يستخدم التصيير من جهة الخادم (SSR)؟</h4>
<p>نفس الطريقة المذكورة أعلاه.</p>
<h4>كيف أختبر مكتبة متصفح تستخدم هذا؟</h4>
<p>إما استخدم أداة اختبار يمكنها العمل في المتصفح، مثل Mocha، أو استخدم <a href="https://avajs.dev">AVA</a> مع <code>ky-universal</code>. <a href="https://github.com/sindresorhus/ky-universal#faq">اقرأ المزيد.</a></p>
<h4>كيف أستخدم هذا بدون أداة تجميع مثل Webpack؟</h4>
<p>تأكد من أن الكود الخاص بك يعمل كـ وحدة جافاسكريبت (ESM)، على سبيل المثال باستخدام وسم <code>&lt;script type="module"&gt;</code> في مستند HTML. بعد ذلك يمكن استيراد Ky مباشرة من تلك الوحدة دون الحاجة لأداة تجميع أو أدوات أخرى.</p>
<pre><code class="language-html hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="language-javascript">
<span class="hljs-keyword">import</span> ky <span class="hljs-keyword">from</span> <span class="hljs-string">'https://unpkg.com/ky/distribution/index.js'</span>;

<span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> <span class="hljs-title function_">ky</span>(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>).<span class="hljs-title function_">json</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json.<span class="hljs-property">title</span>);
<span class="hljs-comment">//=&gt; 'delectus aut autem'</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h4>كيف يختلف هذا عن <a href="https://github.com/sindresorhus/got"><code>got</code></a></h4>
<p>راجع إجابتي <a href="https://twitter.com/sindresorhus/status/1037406558945042432">هنا</a>. تتم صيانة Got بواسطة نفس الأشخاص الذين يطورون Ky.</p>
<h4>كيف يختلف هذا عن <a href="https://github.com/axios/axios"><code>axios</code></a>؟</h4>
<p>راجع إجابتي <a href="https://twitter.com/sindresorhus/status/1037763588826398720">هنا</a>.</p>
<h4>كيف يختلف هذا عن <a href="https://github.com/mikeal/r2"><code>r2</code></a>؟</h4>
<p>راجع إجابتي في <a href="https://github.com/sindresorhus/ky/issues/10">#10</a>.</p>
<h4>ماذا يعني <code>ky</code>؟</h4>
<p>إنه مجرد اسم حزمة npm قصير وعشوائي تمكنت من الحصول عليه. ومع ذلك، له معنى في اللغة اليابانية:</p>
<blockquote>
<p>شكل من أشكال الاختصار النصي، KY هو اختصار لـ 空気読めない (kuuki yomenai)، والذي يترجم حرفياً إلى "لا يستطيع قراءة الجو". إنها عبارة تطلق على شخص لا يفهم المعنى الضمني.</p>
</blockquote>
<h2>دعم المتصفحات</h2>
<p>أحدث إصدار من Chrome وFirefox وSafari.</p>
<h2>دعم Node.js</h2>
<p>Node.js 18 وما بعده.</p>
<h2>ذات صلة</h2>
<ul>
<li><a href="https://github.com/sindresorhus/fetch-extras">fetch-extras</a> - أدوات مساعدة للعمل مع Fetch</li>
<li><a href="https://github.com/alice-health/ky-hooks-change-case">ky-hooks-change-case</a> - هوكات Ky لتعديل الحالات في الطلبات والردود على الكائنات</li>
</ul>
<h2>القائمون على الصيانة</h2>
<ul>
<li><a href="https://github.com/sindresorhus">Sindre Sorhus</a></li>
<li><a href="https://github.com/sholladay">Seth Holladay</a></li>
<li><a href="https://github.com/szmarczak">Szymon Marczak</a></li>
</ul>
<pre><code class="hljs language-yaml">

<span class="hljs-meta">---

</span>
<span class="hljs-string">Tranlated</span> <span class="hljs-string">By</span> [<span class="hljs-string">Open</span> <span class="hljs-string">Ai</span> <span class="hljs-string">Tx</span>]<span class="hljs-string">(https://github.com/OpenAiTx/OpenAiTx)</span> <span class="hljs-string">|</span> <span class="hljs-attr">Last indexed:</span> <span class="hljs-number">2025-06-11</span>


<span class="hljs-meta">---
</span></code></pre>
</div>
    </div>

    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async=""></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
    <script src="view.js?v=20250613"></script>


</body></html>