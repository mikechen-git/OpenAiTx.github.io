<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ky - sindresorhus/ky</title>
    <meta name="title" content="ky - sindresorhus/ky">
    <meta name="description" content="sindresorhus/ky - GitHub repository ar documentation and informationKy هو عميل HTTP صغير وأنيق مبني على واجهة برمجة تطبيقات الجلب Fetch API يستهدف Ky المتصفحات الحديثة، وNode.js، وBun، وDeno. إنه مجرد حزمة صغيرة بدون أي تبعيات. ...">
    <meta name="keywords" content="sindresorhus, ky, GitHub, repository, ar documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/sindresorhus/ky/README-ar.html">
    <meta property="og:title" content="ky - sindresorhus/ky">
    <meta property="og:description" content="sindresorhus/ky - GitHub repository ar documentation and information">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/sindresorhus/ky" id="githubRepoLink" target="_blank">sindresorhus/ky</a>
<h1 style="display: none;">Ky هو عميل HTTP صغير وأنيق مبني على واجهة برمجة تطبيقات الجلب Fetch API يستهدف Ky المتصفحات الحديثة، وNode.js، وBun، وDeno. إنه مجرد حزمة صغيرة بدون أي تبعيات. ...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <div align="center">
	<br>
	<div>
		<img width="600" height="600" src="https://raw.githubusercontent.com/sindresorhus/ky/main/media/logo.svg" alt="ky">
	</div>
	<br>
	<br>
	<br>
</div>
<blockquote>
<p>Ky هو عميل HTTP صغير وأنيق مبني على <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch">واجهة برمجة تطبيقات الجلب Fetch API</a></p>
</blockquote>
<p><a href="https://codecov.io/gh/sindresorhus/ky"><img src="https://codecov.io/gh/sindresorhus/ky/branch/main/graph/badge.svg" alt="Coverage Status" /></a>
<a href="https://bundlephobia.com/result?p=ky"><img src="https://badgen.net/bundlephobia/minzip/ky" alt="" /></a></p>
<p>يستهدف Ky <a href="#browser-support">المتصفحات الحديثة</a>، وNode.js، وBun، وDeno.</p>
<p>إنه مجرد حزمة صغيرة بدون أي تبعيات.</p>
<h2>الفوائد مقارنة بـ <code>fetch</code> العادي</h2>
<ul>
<li>واجهة برمجة تطبيقات أبسط</li>
<li>اختصارات للطرق (<code>ky.post()</code>)</li>
<li>يعامل رموز الحالة غير 2xx كأخطاء (بعد عمليات إعادة التوجيه)</li>
<li>يعيد المحاولة للطلبات الفاشلة</li>
<li>خيار JSON</li>
<li>دعم المهلة الزمنية</li>
<li>خيار بادئة عنوان URL</li>
<li>مثيلات بإعدادات افتراضية مخصصة</li>
<li>Hooks</li>
<li>ميزات TypeScript (على سبيل المثال، <code>.json()</code> يدعم الأنواع العامة ويفترض افتراضياً القيمة <code>unknown</code> وليس <code>any</code>)</li>
</ul>
<h2>التثبيت</h2>
<pre><code class="language-sh">npm install ky
</code></pre>
<h6>CDN</h6>
<ul>
<li><a href="https://cdn.jsdelivr.net/npm/ky/+esm">jsdelivr</a></li>
<li><a href="https://unpkg.com/ky">unpkg</a></li>
<li><a href="https://esm.sh/ky">esm.sh</a></li>
</ul>
<h2>الاستخدام</h2>
<pre><code class="language-js">import ky from 'ky';

const json = await ky.post('https://example.com', {json: {foo: true}}).json();

console.log(json);
//=&gt; {data: '🦄'}
</code></pre>
<p>باستخدام <code>fetch</code> العادي، سيكون الأمر كالتالي:</p>
<pre><code class="language-js">class HTTPError extends Error {}

const response = await fetch('https://example.com', {
	method: 'POST',
	body: JSON.stringify({foo: true}),
	headers: {
		'content-type': 'application/json'
	}
});

if (!response.ok) {
	throw new HTTPError(`Fetch error: ${response.statusText}`);
}

const json = await response.json();

console.log(json);
//=&gt; {data: '🦄'}
</code></pre>
<p>إذا كنت تستخدم <a href="https://github.com/denoland/deno">Deno</a>، قم باستيراد Ky من عنوان URL. على سبيل المثال، باستخدام CDN:</p>
<pre><code class="language-js">import ky from 'https://esm.sh/ky';
</code></pre>
<h2>واجهة برمجة التطبيقات (API)</h2>
<h3>ky(input, options?)</h3>
<p>المعاملان <code>input</code> و<code>options</code> هما نفس معاملَي <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch"><code>fetch</code></a>، مع توفر خيارات إضافية (انظر أدناه).</p>
<p>تعيد <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">كائن <code>Response</code></a> مع <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch#body">طرق <code>Body</code></a> مضافة من أجل الراحة. لذا يمكنك، على سبيل المثال، استدعاء <code>ky.get(input).json()</code> مباشرة دون الحاجة إلى انتظار <code>Response</code> أولاً. عند الاستدعاء بهذه الطريقة، سيتم تعيين ترويسة <code>Accept</code> المناسبة حسب طريقة الجسم المستخدمة. على عكس طرق الجسم في <code>window.Fetch</code>، ستقوم هذه الطرق برمي خطأ من نوع <code>HTTPError</code> إذا لم تكن حالة الاستجابة ضمن النطاق <code>200...299</code>. أيضاً، ستعيد <code>.json()</code> سلسلة فارغة إذا كان الجسم فارغاً أو كانت حالة الاستجابة <code>204</code> بدلاً من رمي خطأ تحليل بسبب الجسم الفارغ.</p>
<pre><code class="language-js">import ky from 'ky';

const user = await ky('/api/user').json();

console.log(user);
</code></pre>
<p>⌨️ <strong>TypeScript:</strong> تقبل معلمة نوعية اختيارية <a href="https://www.typescriptlang.org/docs/handbook/2/generics.html">type parameter</a>، والتي تفترض افتراضياً <a href="https://www.typescriptlang.org/docs/handbook/2/functions.html#unknown"><code>unknown</code></a>، ويتم تمريرها إلى نوع القيمة المرجعة من <code>.json()</code>.</p>
<pre><code class="language-ts">import ky from 'ky';

// user1 هو unknown
const user1 = await ky('/api/users/1').json();
// user2 هو User
const user2 = await ky&lt;User&gt;('/api/users/2').json();
// user3 هو User
const user3 = await ky('/api/users/3').json&lt;User&gt;();

console.log([user1, user2, user3]);
</code></pre>
<h3>ky.get(input, options?)</h3>
<h3>ky.post(input, options?)</h3>
<h3>ky.put(input, options?)</h3>
<h3>ky.patch(input, options?)</h3>
<h3>ky.head(input, options?)</h3>
<h3>ky.delete(input, options?)</h3>
<p>يضبط <code>options.method</code> على اسم الطريقة ويجري الطلب.</p>
<p>⌨️ <strong>TypeScript:</strong> يقبل معلمة نوعية اختيارية للاستخدام مع استجابات JSON (انظر <a href="#kyinput-options"><code>ky()</code></a>).</p>
<h4>input</h4>
<p>النوع: <code>string</code> | <code>URL</code> | <code>Request</code></p>
<p>نفس <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request/Request#input">مدخلات <code>fetch</code></a>.</p>
<p>عند استخدام كائن <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>Request</code></a> كمدخل <code>input</code>، سيتم تجاهل أي خيارات تغير عنوان URL (مثل <code>prefixUrl</code>).</p>
<h4>options</h4>
<p>النوع: <code>object</code></p>
<p>نفس <a href="https://developer.mozilla.org/en-US/docs/Web/API/fetch#options">خيارات <code>fetch</code></a>، بالإضافة إلى الخيارات الإضافية التالية:</p>
<h5>method</h5>
<p>النوع: <code>string</code><br />
القيمة الافتراضية: <code>'get'</code></p>
<p>طريقة HTTP المستخدمة لإجراء الطلب.</p>
<p>داخلياً، يتم تحويل الطرق القياسية (<code>GET</code>، <code>POST</code>، <code>PUT</code>، <code>PATCH</code>، <code>HEAD</code> و<code>DELETE</code>) إلى أحرف كبيرة لتجنب أخطاء الخادم الناتجة عن حساسية حالة الأحرف.</p>
<h5>json</h5>
<p>النوع: <code>object</code> وأي قيمة أخرى تقبلها <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify"><code>JSON.stringify()</code></a></p>
<p>اختصار لإرسال JSON. استخدم هذا بدلاً من خيار <code>body</code>. يقبل أي كائن عادي أو قيمة، وسيتم تحويلها إلى <code>JSON.stringify()</code> وإرسالها في الجسم مع تعيين الترويسة الصحيحة تلقائياً.</p>
<h5>searchParams</h5>
<p>النوع: <code>string | object&lt;string, string | number | boolean&gt; | Array&lt;Array&lt;string | number | boolean&gt;&gt; | URLSearchParams</code><br />
القيمة الافتراضية: <code>''</code></p>
<p>معاملات البحث التي سيتم تضمينها في عنوان URL للطلب. تعيين هذا سيستبدل جميع معاملات البحث الموجودة في عنوان URL المدخل.</p>
<p>يقبل أي قيمة مدعومة من <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams/URLSearchParams"><code>URLSearchParams()</code></a>.</p>
<h5>prefixUrl</h5>
<p>النوع: <code>string | URL</code></p>
<p>بادئة لإضافتها إلى عنوان URL المدخل عند إجراء الطلب. يمكن أن تكون أي عنوان URL صالح، سواء نسبي أو مطلق. الفاصلة المائلة <code>/</code> في النهاية اختيارية وستتم إضافتها تلقائياً إذا لزم الأمر عند ربطها بـ<code>input</code>. يسري هذا الخيار فقط عندما يكون <code>input</code> نصياً. لا يمكن أن يبدأ معامل <code>input</code> بشرطة مائلة <code>/</code> عند استخدام هذا الخيار.</p>
<p>مفيد عند استخدامه مع <a href="#kyextenddefaultoptions"><code>ky.extend()</code></a> لإنشاء مثيلات Ky مخصصة لمجالات محددة.</p>
<pre><code class="language-js">import ky from 'ky';

// على https://example.com

const response = await ky('unicorn', {prefixUrl: '/api'});
//=&gt; 'https://example.com/api/unicorn'

const response2 = await ky('unicorn', {prefixUrl: 'https://cats.com'});
//=&gt; 'https://cats.com/unicorn'
</code></pre>
<p>ملاحظات:</p>
<ul>
<li>بعد دمج <code>prefixUrl</code> و<code>input</code>، يتم حل النتيجة مقابل <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/baseURI">عنوان URL الأساسي</a> للصفحة (إن وجد).</li>
<li>الشرطات المائلة في بداية <code>input</code> غير مسموحة عند استخدام هذا الخيار للحفاظ على الاتساق وتجنب الالتباس حول كيفية التعامل مع عنوان URL المدخل، حيث أن <code>input</code> لن يتبع قواعد حل عنوان URL المعتادة عند استخدام <code>prefixUrl</code>، مما يغير معنى الشرطة المائلة في البداية.</li>
</ul>
<h5>retry</h5>
<p>النوع: <code>object | number</code><br />
القيم الافتراضية:</p>
<ul>
<li><code>limit</code>: <code>2</code></li>
<li><code>methods</code>: <code>get</code> <code>put</code> <code>head</code> <code>delete</code> <code>options</code> <code>trace</code></li>
<li><code>statusCodes</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/408"><code>408</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/413"><code>413</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429"><code>429</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500"><code>500</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502"><code>502</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/503"><code>503</code></a> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/504"><code>504</code></a></li>
<li><code>afterStatusCodes</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/413"><code>413</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429"><code>429</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/503"><code>503</code></a></li>
<li><code>maxRetryAfter</code>: <code>undefined</code></li>
<li><code>backoffLimit</code>: <code>undefined</code></li>
<li><code>delay</code>: <code>attemptCount =&gt; 0.3 * (2 ** (attemptCount - 1)) * 1000</code></li>
</ul>
<p>كائن يُمثّل حقول <code>limit</code> و<code>methods</code> و<code>statusCodes</code> و<code>afterStatusCodes</code> و<code>maxRetryAfter</code> لعدد المحاولات القصوى، والأساليب المسموح بها، وأكواد الحالة المسموح بها، وأكواد الحالة المسموح لها باستخدام وقت <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a>، وأقصى وقت لـ <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a>.</p>
<p>إذا كانت قيمة <code>retry</code> رقمًا، سيتم استخدامها كـ <code>limit</code> وستبقى القيم الافتراضية الأخرى كما هي.</p>
<p>إذا قدّم الرد كود HTTP موجود في <code>afterStatusCodes</code>، ستنتظر Ky حتى يمر التاريخ أو المهلة أو الطابع الزمني المُعطى في ترويسة <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a> قبل إعادة محاولة الطلب. إذا كانت ترويسة <code>Retry-After</code> مفقودة، سيتم استخدام الترويسة غير القياسية <a href="https://www.ietf.org/archive/id/draft-polli-ratelimit-headers-05.html#section-3.3"><code>RateLimit-Reset</code></a> كخيار بديل. إذا لم يكن كود الحالة المُقدم موجودًا في القائمة، سيتم تجاهل ترويسة <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a>.</p>
<p>إذا تم تعيين <code>maxRetryAfter</code> إلى <code>undefined</code>، سيتم استخدام <code>options.timeout</code>. إذا كانت قيمة ترويسة <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a> أكبر من <code>maxRetryAfter</code>، سيتم استخدام <code>maxRetryAfter</code>.</p>
<p>خيار <code>backoffLimit</code> هو الحد الأعلى للتأخير لكل محاولة إعادة في المللي ثانية.
لتقييد التأخير، عيّن <code>backoffLimit</code> إلى 1000، كمثال.
افتراضيًا، يتم حساب التأخير باستخدام <code>0.3 * (2 ** (attemptCount - 1)) * 1000</code>. يزداد التأخير بشكل أُسي.</p>
<p>يمكن استخدام خيار <code>delay</code> لتغيير كيفية حساب التأخير بين المحاولات. تستقبل الدالة معاملًا واحدًا، وهو عدد المحاولة، بدءًا من <code>1</code>.</p>
<p>لا يتم تفعيل إعادة المحاولة بعد <a href="#timeout">انتهاء المهلة</a>.</p>
<pre><code class="language-js">import ky from 'ky';

const json = await ky('https://example.com', {
	retry: {
		limit: 10,
		methods: ['get'],
		statusCodes: [413],
		backoffLimit: 3000
	}
}).json();
</code></pre>
<h5>timeout</h5>
<p>النوع: <code>number | false</code><br />
القيمة الافتراضية: <code>10000</code></p>
<p>المهلة بالمللي ثانية للحصول على استجابة، بما في ذلك أي محاولات إعادة. لا يمكن أن تكون أكبر من 2147483647.
إذا تم تعيينها إلى <code>false</code>، لن يكون هناك مهلة.</p>
<h5>hooks</h5>
<p>النوع: <code>object&lt;string, Function[]&gt;</code><br />
القيمة الافتراضية: <code>{beforeRequest: [], beforeRetry: [], afterResponse: []}</code></p>
<p>تسمح الـ Hooks بالتعديلات أثناء دورة حياة الطلب. قد تكون دوال الـ Hook غير متزامنة ويتم تنفيذها بشكل تسلسلي.</p>
<h6>hooks.beforeRequest</h6>
<p>النوع: <code>Function[]</code><br />
القيمة الافتراضية: <code>[]</code></p>
<p>يتيح لك هذا الـ hook تعديل الطلب مباشرة قبل إرساله. لن تقوم Ky بأي تغييرات أخرى على الطلب بعد ذلك. تستقبل دالة الـ hook وسيطي <code>request</code> و<code>options</code> كوسائط. يمكنك، على سبيل المثال، تعديل <code>request.headers</code> هنا.</p>
<p>يمكن أن تُرجع الـ hook كائن <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>Request</code></a> لاستبدال الطلب المُرسل، أو تُرجع كائن <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> لتجنب إجراء طلب HTTP بالكامل. يمكن استخدام ذلك لمحاكاة طلب، أو التحقق من ذاكرة تخزين مؤقت داخلية، إلخ. من <strong>المهم</strong> عند إعادة طلب أو استجابة من هذا الـ hook أن أي hooks متبقية من <code>beforeRequest</code> سيتم تجاوزها، لذا قد ترغب في إرجاعها فقط من الـ hook الأخير.</p>
<pre><code class="language-js">import ky from 'ky';

const api = ky.extend({
	hooks: {
		beforeRequest: [
			request =&gt; {
				request.headers.set('X-Requested-With', 'ky');
			}
		]
	}
});

const response = await api.get('https://example.com/api/users');
</code></pre>
<h6>hooks.beforeRetry</h6>
<p>النوع: <code>Function[]</code><br />
القيمة الافتراضية: <code>[]</code></p>
<p>يتيح لك هذا الـ hook تعديل الطلب مباشرة قبل إعادة المحاولة. لن تقوم Ky بأي تغييرات أخرى على الطلب بعد ذلك. تستقبل دالة الـ hook كائنًا يحتوي على الطلب والخيارات المُوحّدة، وكائن خطأ، وعدد المحاولة. يمكنك، على سبيل المثال، تعديل <code>request.headers</code> هنا.</p>
<p>إذا تلقى الطلب استجابة، سيكون الخطأ من نوع <code>HTTPError</code> وسيكون كائن <code>Response</code> متاحًا في <code>error.response</code>. انتبه إلى أن بعض أنواع الأخطاء، مثل أخطاء الشبكة، تعني بطبيعتها أنه لم يتم استلام استجابة. في هذه الحالة، لن يكون الخطأ من نوع <code>HTTPError</code>.</p>
<p>يمكنك منع Ky من إعادة محاولة الطلب عن طريق رمي خطأ. لن تتعامل Ky معه بأي طريقة وسيتم تمرير الخطأ إلى جهة استدعاء الطلب. لن يتم استدعاء بقية الـ hooks من نوع <code>beforeRetry</code> في هذه الحالة. بدلاً من ذلك، يمكنك إرجاع الرمز <a href="#kystop"><code>ky.stop</code></a> لتحقيق نفس الغرض ولكن دون تمرير خطأ (لهذا بعض القيود، راجع وثائق <code>ky.stop</code> لمزيد من التفاصيل).</p>
<pre><code class="language-js">import ky from 'ky';

const response = await ky('https://example.com', {
	hooks: {
		beforeRetry: [
			async ({request, options, error, retryCount}) =&gt; {
				const token = await ky('https://example.com/refresh-token');
				request.headers.set('Authorization', `token ${token}`);
			}
		]
	}
});
</code></pre>
<h6>hooks.beforeError</h6>
<p>النوع: <code>Function[]</code><br />
القيمة الافتراضية: <code>[]</code></p>
<p>يتيح لك هذا الـ hook تعديل كائن <code>HTTPError</code> مباشرة قبل رميه. تستقبل دالة الـ hook كائن <code>HTTPError</code> كوسيط ويجب أن تُعيد نسخة من <code>HTTPError</code>.</p>
<pre><code class="language-js">import ky from 'ky';

await ky('https://example.com', {
	hooks: {
		beforeError: [
			error =&gt; {
				const {response} = error;
				if (response &amp;&amp; response.body) {
					error.name = 'GitHubError';
					error.message = `${response.body.message} (${response.status})`;
				}

				return error;
			}
		]
	}
});
</code></pre>
<h6>hooks.afterResponse</h6>
<p>النوع: <code>Function[]</code><br />
القيمة الافتراضية: <code>[]</code></p>
<p>يتيح لك هذا الـ hook قراءة الاستجابة واختيارياً تعديلها. تستقبل دالة الـ hook الطلب المُوحّد، الخيارات، ونسخة من الاستجابة كوسائط. سيتم استخدام قيمة الإرجاع من دالة الـ hook بواسطة Ky ككائن استجابة إذا كانت نسخة من <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a>.</p>
<pre><code class="language-js">import ky from 'ky';

const response = await ky('https://example.com', {
	hooks: {
		afterResponse: [
			(_request, _options, response) =&gt; {
				// يمكنك القيام بشيء مع الاستجابة، مثلاً تسجيلها.
				log(response);

				// أو إرجاع نسخة `Response` لاستبدال الاستجابة.
				return new Response('A different response', {status: 200});
			},

			// أو إعادة المحاولة باستخدام رمز جديد عند حدوث خطأ 403
			async (request, options, response) =&gt; {
				if (response.status === 403) {
					// الحصول على رمز جديد
					const token = await ky('https://example.com/token').text();

					// إعادة المحاولة باستخدام الرمز
					request.headers.set('Authorization', `token ${token}`);

					return ky(request);
				}
			}
		]
	}
});
</code></pre>
<h5>throwHttpErrors</h5>
<p>النوع: <code>boolean</code><br />
القيمة الافتراضية: <code>true</code></p>
<p>إلقاء خطأ <code>HTTPError</code> عند حصول استجابة بكود حالة غير 2xx بعد اتباع التحويلات. لإلقاء خطأ أيضاً عند التحويلات بدلاً من متابعتها، عيّن خيار <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters"><code>redirect</code></a> إلى <code>'manual'</code>.</p>
<p>قد يكون تعيين هذا إلى <code>false</code> مفيدًا إذا كنت تتحقق من توفر المورد وتتوقع استجابات أخطاء.</p>
<p>ملاحظة: إذا كانت <code>false</code>، تعتبر استجابات الخطأ ناجحة ولن يتم إعادة محاولة الطلب.</p>
<h5>onDownloadProgress</h5>
<p>النوع: <code>Function</code></p>
<p>معالج حدث تقدم التحميل.</p>
<p>تستقبل الدالة هذه الوسائط:</p>
<ul>
<li><code>progress</code> وهو كائن يحتوي على هذه الخصائص:</li>
<li>
<ul>
<li><code>percent</code> رقم بين 0 و 1 يمثل نسبة التقدم.</li>
</ul>
</li>
<li>
<ul>
<li><code>transferredBytes</code> هو عدد البايتات المنقولة حتى الآن.</li>
</ul>
</li>
<li>
<ul>
<li><code>totalBytes</code> هو إجمالي عدد البايتات المطلوب نقلها. هذا تقديري وقد يكون 0 إذا تعذر تحديد الحجم الكلي.</li>
</ul>
</li>
<li><code>chunk</code> هو نسخة من <code>Uint8Array</code> تحتوي على البيانات المرسلة. ملاحظة: تكون فارغة في أول استدعاء.</li>
</ul>
<pre><code class="language-js">import ky from 'ky';

const response = await ky('https://example.com', {
	onDownloadProgress: (progress, chunk) =&gt; {
		// مثال على الإخراج:
		// `0% - 0 of 1271 bytes`
		// `100% - 1271 of 1271 bytes`
		console.log(`${progress.percent * 100}% - ${progress.transferredBytes} of ${progress.totalBytes} bytes`);
	}
});
</code></pre>
<h5>onUploadProgress</h5>
<p>النوع: <code>Function</code></p>
<p>معالج حدث تقدم التحميل.</p>
<p>تستقبل الدالة الوسيطات التالية:</p>
<ul>
<li><code>progress</code> هو كائن يحتوي على الخصائص التالية:</li>
<li>
<ul>
<li><code>percent</code> هو رقم بين 0 و 1 يمثل نسبة التقدم.</li>
</ul>
</li>
<li>
<ul>
<li><code>transferredBytes</code> هو عدد البايتات التي تم نقلها حتى الآن.</li>
</ul>
</li>
<li>
<ul>
<li><code>totalBytes</code> هو إجمالي عدد البايتات التي سيتم نقلها. هذا تقدير وقد يكون 0 إذا تعذر تحديد الحجم الكلي.</li>
</ul>
</li>
<li><code>chunk</code> هو مثيل من <code>Uint8Array</code> يحتوي على البيانات التي تم إرسالها. ملاحظة: يكون فارغًا في الاستدعاء الأخير.</li>
</ul>
<pre><code class="language-js">import ky from 'ky';

const response = await ky.post('https://example.com/upload', {
	body: largeFile,
	onUploadProgress: (progress, chunk) =&gt; {
		// مثال على المخرجات:
		// `0% - 0 of 1271 bytes`
		// `100% - 1271 of 1271 bytes`
		console.log(`${progress.percent * 100}% - ${progress.transferredBytes} of ${progress.totalBytes} bytes`);
	}
});
</code></pre>
<h5>parseJson</h5>
<p>النوع: <code>Function</code><br />
القيمة الافتراضية: <code>JSON.parse()</code></p>
<p>دالة تحليل JSON مخصصة من قبل المستخدم.</p>
<p>حالات الاستخدام:</p>
<ol>
<li>تحليل JSON عبر حزمة <a href="https://github.com/hapijs/bourne"><code>bourne</code></a> للحماية من تلوث النماذج الأولية (prototype pollution).</li>
<li>تحليل JSON مع خيار <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse"><code>reviver</code> في <code>JSON.parse()</code></a>.</li>
</ol>
<pre><code class="language-js">import ky from 'ky';
import bourne from '@hapijs/bourne';

const json = await ky('https://example.com', {
	parseJson: text =&gt; bourne(text)
}).json();
</code></pre>
<h5>stringifyJson</h5>
<p>النوع: <code>Function</code><br />
القيمة الافتراضية: <code>JSON.stringify()</code></p>
<p>دالة تحويل JSON إلى سلسلة نصية مخصصة من قبل المستخدم.</p>
<p>حالات الاستخدام:</p>
<ol>
<li>تحويل JSON إلى نص مع دالة <code>replacer</code> مخصصة.</li>
</ol>
<pre><code class="language-js">import ky from 'ky';
import {DateTime} from 'luxon';

const json = await ky('https://example.com', {
	stringifyJson: data =&gt; JSON.stringify(data, (key, value) =&gt; {
		if (key.endsWith('_at')) {
			return DateTime.fromISO(value).toSeconds();
		}

		return value;
	})
}).json();
</code></pre>
<h5>fetch</h5>
<p>النوع: <code>Function</code><br />
القيمة الافتراضية: <code>fetch</code></p>
<p>دالة <code>fetch</code> مخصصة من قبل المستخدم.
يجب أن تكون متوافقة بالكامل مع معيار <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">واجهة برمجة التطبيقات Fetch</a>.</p>
<p>حالات الاستخدام:</p>
<ol>
<li>استخدام تطبيقات <code>fetch</code> مخصصة مثل <a href="https://www.npmjs.com/package/isomorphic-unfetch"><code>isomorphic-unfetch</code></a>.</li>
<li>استخدام دالة تغليف <code>fetch</code> التي توفرها بعض الأطر التي تستخدم العرض من جهة الخادم (SSR).</li>
</ol>
<pre><code class="language-js">import ky from 'ky';
import fetch from 'isomorphic-unfetch';

const json = await ky('https://example.com', {fetch}).json();
</code></pre>
<h3>ky.extend(defaultOptions)</h3>
<p>إنشاء مثيل جديد من <code>ky</code> مع بعض القيم الافتراضية التي يتم تجاوزها بقيمك الخاصة.</p>
<p>على عكس <code>ky.create()</code>, فإن <code>ky.extend()</code> يرث القيم الافتراضية من الأصل.</p>
<p>يمكنك تمرير الرؤوس ككائن <code>Headers</code> أو ككائن عادي.</p>
<p>يمكنك إزالة رأس باستخدام <code>.extend()</code> عن طريق تمرير الرأس بقيمة <code>undefined</code>.
تمرير <code>undefined</code> كسلسلة يزيل الرأس فقط إذا كان قادمًا من كائن <code>Headers</code>.</p>
<p>وبالمثل، يمكنك إزالة إدخالات <code>hooks</code> الموجودة عن طريق توسيع hook بقيمة <code>undefined</code> صريحة.</p>
<pre><code class="language-js">import ky from 'ky';

const url = 'https://sindresorhus.com';

const original = ky.create({
	headers: {
		rainbow: 'rainbow',
		unicorn: 'unicorn'
	},
	hooks: {
		beforeRequest: [ () =&gt; console.log('before 1') ],
		afterResponse: [ () =&gt; console.log('after 1') ],
	},
});

const extended = original.extend({
	headers: {
		rainbow: undefined
	},
	hooks: {
		beforeRequest: undefined,
		afterResponse: [ () =&gt; console.log('after 2') ],
	}
});

const response = await extended(url).json();
//=&gt; after 1
//=&gt; after 2

console.log('rainbow' in response);
//=&gt; false

console.log('unicorn' in response);
//=&gt; true
</code></pre>
<p>يمكنك أيضًا الرجوع إلى القيم الافتراضية للأصل عن طريق توفير دالة إلى <code>.extend()</code>.</p>
<pre><code class="language-js">import ky from 'ky';

const api = ky.create({prefixUrl: 'https://example.com/api'});

const usersApi = api.extend((options) =&gt; ({prefixUrl: `${options.prefixUrl}/users`}));

const response = await usersApi.get('123');
//=&gt; 'https://example.com/api/users/123'

const response = await api.get('version');
//=&gt; 'https://example.com/api/version'
</code></pre>
<h3>ky.create(defaultOptions)</h3>
<p>إنشاء مثيل جديد من Ky مع قيم افتراضية جديدة بالكامل.</p>
<pre><code class="language-js">import ky from 'ky';

// على https://my-site.com

const api = ky.create({prefixUrl: 'https://example.com/api'});

const response = await api.get('users/123');
//=&gt; 'https://example.com/api/users/123'

const response = await api.get('/status', {prefixUrl: ''});
//=&gt; 'https://my-site.com/status'
</code></pre>
<h4>defaultOptions</h4>
<p>النوع: <code>object</code></p>
<h3>ky.stop</h3>
<p>رمز <code>Symbol</code> يمكن إرجاعه بواسطة hook <code>beforeRetry</code> لإيقاف إعادة المحاولة. سيؤدي ذلك أيضًا إلى إنهاء hooks <code>beforeRetry</code> المتبقية.</p>
<p>ملاحظة: إرجاع هذا الرمز يجعل Ky يتوقف ويعيد استجابة بقيمة <code>undefined</code>. تأكد من التحقق من وجود استجابة قبل الوصول إلى أي خاصية فيها أو استخدم <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining">اختيارية السلسلة</a>. كما أنه غير متوافق مع دوال الجسم مثل <code>.json()</code> أو <code>.text()</code>، لأنه لا توجد استجابة لتحليلها. بشكل عام، ننصح برمي خطأ بدلاً من إرجاع هذا الرمز، لأن ذلك سيجعل Ky يتوقف ثم يرمي خطأ، مما يتجنب هذه القيود.</p>
<p>حالة استخدام صالحة لـ <code>ky.stop</code> هي منع إعادة المحاولة عند إجراء طلبات من أجل تأثيرات جانبية، حيث أن البيانات المرجعة غير مهمة. على سبيل المثال، تسجيل نشاط العميل على الخادم.</p>
<pre><code class="language-js">import ky from 'ky';

const options = {
	hooks: {
		beforeRetry: [
			async ({request, options, error, retryCount}) =&gt; {
				const shouldStopRetry = await ky('https://example.com/api');
				if (shouldStopRetry) {
					return ky.stop;
				}
			}
		]
	}
};
</code></pre>
<pre><code class="language-markdown">// لاحظ أن response ستكون `undefined` في حالة إرجاع `ky.stop`.
const response = await ky.post('https://example.com', options);

// استخدام `.text()` أو طرق أخرى للجسم غير مدعوم.
const text = await ky('https://example.com', options).text();
</code></pre>
<h3>HTTPError</h3>
<p>مكشوف لاستخدامه في فحص <code>instanceof</code>. يحتوي الخطأ على خاصية <code>response</code> مع <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">كائن Response</a>، وخاصية <code>request</code> مع <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request">كائن Request</a>، وخاصية <code>options</code> مع الخيارات المعيارية (إما الممررة إلى <code>ky</code> عند إنشاء نسخة باستخدام <code>ky.create()</code> أو مباشرة عند تنفيذ الطلب).</p>
<p>كن على علم أن بعض أنواع الأخطاء، مثل أخطاء الشبكة، تعني بطبيعتها أنه لم يتم استلام رد. في هذه الحالة، لن يكون الخطأ من نوع HTTPError ولن يحتوي على خاصية <code>response</code>.</p>
<p>إذا كنت بحاجة لقراءة الرد الفعلي عند حدوث <code>HTTPError</code>، استدعي طريقة التحليل المناسبة على كائن الرد. على سبيل المثال:</p>
<pre><code class="language-js">try {
	await ky('https://example.com').json();
} catch (error) {
	if (error.name === 'HTTPError') {
		const errorJson = await error.response.json();
	}
}
</code></pre>
<p>⌨️ <strong>TypeScript:</strong> يقبل <a href="https://www.typescriptlang.org/docs/handbook/2/generics.html">معامل نوع اختياري</a>، والذي يكون افتراضياً <a href="https://www.typescriptlang.org/docs/handbook/2/functions.html#unknown"><code>unknown</code></a>، ويتم تمريره إلى نوع الإرجاع لـ <code>error.response.json()</code>.</p>
<h3>TimeoutError</h3>
<p>الخطأ الذي يتم إطلاقه عند انتهاء مهلة الطلب. يحتوي على خاصية <code>request</code> مع <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request">كائن Request</a>.</p>
<h2>نصائح</h2>
<h3>إرسال بيانات النماذج</h3>
<p>إرسال بيانات النماذج في Ky مطابق تماماً لـ <code>fetch</code>. فقط مرر <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData">كائن FormData</a> إلى خيار <code>body</code>. سيتم تعيين ترويسة <code>Content-Type</code> تلقائياً إلى <code>multipart/form-data</code>.</p>
<pre><code class="language-js">import ky from 'ky';

// `multipart/form-data`
const formData = new FormData();
formData.append('food', 'fries');
formData.append('drink', 'icetea');

const response = await ky.post(url, {body: formData});
</code></pre>
<p>إذا كنت ترغب في إرسال البيانات بصيغة <code>application/x-www-form-urlencoded</code>، ستحتاج إلى ترميز البيانات باستخدام <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams">URLSearchParams</a>.</p>
<pre><code class="language-js">import ky from 'ky';

// `application/x-www-form-urlencoded`
const searchParams = new URLSearchParams();
searchParams.set('food', 'fries');
searchParams.set('drink', 'icetea');

const response = await ky.post(url, {body: searchParams});
</code></pre>
<h3>تعيين <code>Content-Type</code> مخصص</h3>
<p>يقوم Ky تلقائياً بتعيين ترويسة <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> مناسبة لكل طلب بناءً على البيانات في جسم الطلب. ومع ذلك، تتطلب بعض واجهات برمجة التطبيقات أنواع محتوى مخصصة وغير قياسية، مثل <code>application/x-amz-json-1.1</code>. باستخدام خيار <code>headers</code> يمكنك تجاوز نوع المحتوى يدوياً.</p>
<pre><code class="language-js">import ky from 'ky';

const json = await ky.post('https://example.com', {
	headers: {
		'content-type': 'application/json'
	},
	json: {
		foo: true
	},
}).json();

console.log(json);
//=&gt; {data: '🦄'}
</code></pre>
<h3>الإلغاء</h3>
<p>يدعم Fetch (وبالتالي Ky) إلغاء الطلبات مدمجاً من خلال <a href="https://developer.mozilla.org/en-US/docs/Web/API/AbortController">واجهة AbortController</a>. <a href="https://developers.google.com/web/updates/2017/09/abortable-fetch">اقرأ المزيد.</a></p>
<p>مثال:</p>
<pre><code class="language-js">import ky from 'ky';

const controller = new AbortController();
const {signal} = controller;

setTimeout(() =&gt; {
	controller.abort();
}, 5000);

try {
	console.log(await ky(url, {signal}).text());
} catch (error) {
	if (error.name === 'AbortError') {
		console.log('تم إلغاء الجلب');
	} else {
		console.error('خطأ في الجلب:', error);
	}
}
</code></pre>
<h2>الأسئلة الشائعة</h2>
<h4>كيف أستخدم هذا في Node.js؟</h4>
<p>يدعم Node.js 18 وما بعده <code>fetch</code> بشكل أصلي، لذلك يمكنك استخدام هذه الحزمة مباشرة.</p>
<h4>كيف أستخدم هذا مع تطبيق ويب (React, Vue.js, إلخ) يستخدم التصيير من جهة الخادم (SSR)؟</h4>
<p>نفس الطريقة المذكورة أعلاه.</p>
<h4>كيف أختبر مكتبة متصفح تستخدم هذا؟</h4>
<p>إما استخدم أداة اختبار يمكنها العمل في المتصفح، مثل Mocha، أو استخدم <a href="https://avajs.dev">AVA</a> مع <code>ky-universal</code>. <a href="https://github.com/sindresorhus/ky-universal#faq">اقرأ المزيد.</a></p>
<h4>كيف أستخدم هذا بدون أداة تجميع مثل Webpack؟</h4>
<p>تأكد من أن الكود الخاص بك يعمل كـ وحدة جافاسكريبت (ESM)، على سبيل المثال باستخدام وسم <code>&lt;script type=&quot;module&quot;&gt;</code> في مستند HTML. بعد ذلك يمكن استيراد Ky مباشرة من تلك الوحدة دون الحاجة لأداة تجميع أو أدوات أخرى.</p>
<pre><code class="language-html">&lt;script type=&quot;module&quot;&gt;
import ky from 'https://unpkg.com/ky/distribution/index.js';

const json = await ky('https://jsonplaceholder.typicode.com/todos/1').json();

console.log(json.title);
//=&gt; 'delectus aut autem'
&lt;/script&gt;
</code></pre>
<h4>كيف يختلف هذا عن <a href="https://github.com/sindresorhus/got"><code>got</code></a></h4>
<p>راجع إجابتي <a href="https://twitter.com/sindresorhus/status/1037406558945042432">هنا</a>. تتم صيانة Got بواسطة نفس الأشخاص الذين يطورون Ky.</p>
<h4>كيف يختلف هذا عن <a href="https://github.com/axios/axios"><code>axios</code></a>؟</h4>
<p>راجع إجابتي <a href="https://twitter.com/sindresorhus/status/1037763588826398720">هنا</a>.</p>
<h4>كيف يختلف هذا عن <a href="https://github.com/mikeal/r2"><code>r2</code></a>؟</h4>
<p>راجع إجابتي في <a href="https://github.com/sindresorhus/ky/issues/10">#10</a>.</p>
<h4>ماذا يعني <code>ky</code>؟</h4>
<p>إنه مجرد اسم حزمة npm قصير وعشوائي تمكنت من الحصول عليه. ومع ذلك، له معنى في اللغة اليابانية:</p>
<blockquote>
<p>شكل من أشكال الاختصار النصي، KY هو اختصار لـ 空気読めない (kuuki yomenai)، والذي يترجم حرفياً إلى &quot;لا يستطيع قراءة الجو&quot;. إنها عبارة تطلق على شخص لا يفهم المعنى الضمني.</p>
</blockquote>
<h2>دعم المتصفحات</h2>
<p>أحدث إصدار من Chrome وFirefox وSafari.</p>
<h2>دعم Node.js</h2>
<p>Node.js 18 وما بعده.</p>
<h2>ذات صلة</h2>
<ul>
<li><a href="https://github.com/sindresorhus/fetch-extras">fetch-extras</a> - أدوات مساعدة للعمل مع Fetch</li>
<li><a href="https://github.com/alice-health/ky-hooks-change-case">ky-hooks-change-case</a> - هوكات Ky لتعديل الحالات في الطلبات والردود على الكائنات</li>
</ul>
<h2>القائمون على الصيانة</h2>
<ul>
<li><a href="https://github.com/sindresorhus">Sindre Sorhus</a></li>
<li><a href="https://github.com/sholladay">Seth Holladay</a></li>
<li><a href="https://github.com/szmarczak">Szymon Marczak</a></li>
</ul>
<pre><code>

---


Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-06-11


---
</code></pre>

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Statcounter and other scripts can be added here -->
</body>
</html>