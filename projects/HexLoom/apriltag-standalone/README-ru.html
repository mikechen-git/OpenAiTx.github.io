<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>apriltag-standalone - HexLoom/apriltag-standalone ru</title>
    <meta name="title" content="apriltag-standalone - HexLoom/apriltag-standalone ru | AprilTag независимая библиотека обнаружения Это инструментальный пакет для распознавания AprilTag, основанный на библиотеке pupil-apriltags, предназначенный для...">
    <meta name="description" content="HexLoom/apriltag-standalone - GitHub repository ru documentation and information | AprilTag независимая библиотека обнаружения Это инструментальный пакет для распознавания AprilTag, основанный на библиотеке pupil-apriltags, предназначенный для...">
    <meta name="keywords" content="HexLoom, apriltag-standalone, GitHub, repository, ru documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/HexLoom/apriltag-standalone/README-ru.html">
    <meta property="og:title" content="apriltag-standalone - HexLoom/apriltag-standalone ru | AprilTag независимая библиотека обнаружения Это инструментальный пакет для распознавания AprilTag, основанный на библиотеке pupil-apriltags, предназначенный для...">
    <meta property="og:description" content="HexLoom/apriltag-standalone - GitHub repository ru documentation and information | AprilTag независимая библиотека обнаружения Это инструментальный пакет для распознавания AprilTag, основанный на библиотеке pupil-apriltags, предназначенный для...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div style="position: fixed; top: 2px; left: 2px; z-index: 2000; background: rgba(255,255,255,0.95); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 4px 14px; font-size: 15px; color: #222; font-family: 'Segoe UI', Arial, sans-serif; font-weight: 500; letter-spacing: 0.5px;">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: 600;">Open AI Tx</a>
    </div>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/HexLoom/apriltag-standalone" id="githubRepoLink" target="_blank">HexLoom/apriltag-standalone</a>
<h1 style="display: none;">AprilTag независимая библиотека обнаружения Это инструментальный пакет для распознавания AprilTag, основанный на библиотеке pupil-apriltags, предназначенный для...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>AprilTag независимая библиотека обнаружения</h1>
<p>Это инструментальный пакет для распознавания AprilTag, основанный на библиотеке pupil-apriltags, предназначенный для обнаружения и отслеживания AprilTag в изображениях с камеры.</p>
<!-- Keep these links. Translations will automatically update with the README. -->
<p><a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=de">Deutsch</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=en">English</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=es">Español</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=fr">français</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=ja">日本語</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=ko">한국어</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=pt">Português</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=ru">Русский</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=zh">中文</a></p>
<h2>Зависимости</h2>
<ul>
<li>Python 3.6+</li>
<li>OpenCV</li>
<li>NumPy</li>
<li>pupil-apriltags</li>
</ul>
<h2>Установка</h2>
<ol>
<li>Убедитесь, что у вас установлен Python</li>
<li>Установите необходимые зависимости:</li>
</ol>
<pre><code class="language-bash">pip install opencv-python numpy pupil-apriltags
</code></pre>
<h2>Применение</h2>
<h3>Базовое использование</h3>
<pre><code class="language-python">import cv2
from apriltag import Detector, DetectorOptions

# Создание детектора
options = DetectorOptions(
    families=&quot;tag36h11&quot;,  # Семейство тегов
    border=1,             # Размер рамки тега
    nthreads=4,           # Количество потоков
    quad_decimate=1.0,    # Коэффициент субдискретизации изображения
    quad_blur=0.0,        # Коэффициент гауссового размытия
    refine_edges=True     # Уточнять ли границы
)
detector = Detector(options)

# Загрузка изображения
img = cv2.imread(&quot;test_image.jpg&quot;)
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

# Обнаружение AprilTag
detections = detector.detect(gray)

# Вывод результатов обнаружения
for detection in detections:
    print(f&quot;Семейство тегов: {detection.tag_family}, ID: {detection.tag_id}&quot;)
    print(f&quot;Положение: {detection.center}&quot;)
    print(f&quot;Углы: {detection.corners}&quot;)
</code></pre>
<h3>Отрисовка результатов обнаружения</h3>
<pre><code class="language-python">import numpy as np
from apriltag import draw_detection_results

# Матрица внутренних параметров камеры и коэффициенты дисторсии
K = np.array([[800, 0, 320], [0, 800, 240], [0, 0, 1]], dtype=np.float32)
D = np.zeros((4, 1), dtype=np.float32)

# Отрисовка результатов обнаружения
result_img = draw_detection_results(img, detections, K, D, tag_size=0.1)

# Отображение результата
cv2.imshow(&quot;AprilTag Detection&quot;, result_img)
cv2.waitKey(0)
</code></pre>
<h3>Запуск тестового скрипта</h3>
<p>Предоставлен простой тестовый скрипт для проверки работоспособности обнаружения AprilTag:</p>
<pre><code class="language-bash">python test_apriltag.py
</code></pre>
<p>Этот скрипт откроет камеру по умолчанию и будет в реальном времени обнаруживать AprilTag. Для выхода нажмите клавишу &quot;q&quot;.</p>
<h2>Поддерживаемые семейства тегов</h2>
<p>Библиотека pupil-apriltags поддерживает следующие семейства тегов:</p>
<ul>
<li>tag36h11 (по умолчанию)</li>
<li>tag25h9</li>
<li>tag16h5</li>
<li>tagCircle21h7</li>
<li>tagCircle49h12</li>
<li>tagStandard41h12</li>
<li>tagStandard52h13</li>
<li>tagCustom48h12</li>
</ul>
<h2>Примечания</h2>
<ul>
<li>Для повышения производительности можно скорректировать параметры в DetectorOptions</li>
<li>Для устройств с ограниченными вычислительными ресурсами рекомендуется увеличить параметр quad_decimate для снижения вычислительной сложности</li>
<li>Убедитесь, что размер метки AprilTag соответствует параметру tag_size в коде</li>
<li>Для отрисовки 3D-оси необходимы корректные параметры камеры</li>
</ul>
<h2>Особенности</h2>
<ul>
<li>Поддержка обнаружения AprilTag с USB-камеры в реальном времени</li>
<li>Расчёт и отображение 3D-положения тега (позиция и ориентация)</li>
<li>Поддержка сохранения исходных и размеченных изображений</li>
<li>Гибкая настройка конфигурации и параметров камеры</li>
<li>В комплекте полный инструмент для калибровки камеры</li>
<li>Не требует ROS, полностью независимая Python-реализация на основе ROS-пакета</li>
</ul>
<h2>Шаги установки</h2>
<h3>1. Установка C-библиотеки AprilTag</h3>
<p>C-библиотека AprilTag обязательна для работы. Выполните следующие шаги для установки:</p>
<h4>Ubuntu/Debian:</h4>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install -y libapriltag-dev
</code></pre>
<h4>Windows:</h4>
<p>Пользователям Windows потребуется самостоятельно собрать или скачать готовые бинарные файлы и убедиться, что <code>apriltag.dll</code> находится в переменной среды PATH или в текущей директории.</p>
<h3>2. Установка Python-зависимостей</h3>
<pre><code class="language-bash">pip install -r requirements.txt  -i https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple
pip install pupil-apriltags -i https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple
</code></pre>
<h2>Инструкция по использованию</h2>
<h3>Быстрый старт (рекомендуется)</h3>
<p>Самый простой способ использования — запустить интегрированный инструмент, который предоставляет интерактивное меню для пошагового выполнения всех этапов:</p>
<pre><code class="language-bash">python apriltag_tool.py
</code></pre>
<p>Этот инструмент предлагает следующие пункты меню:</p>
<ol>
<li>Генерация шахматной калибровочной доски</li>
<li>Калибровка камеры</li>
<li>Обнаружение AprilTag</li>
<li>Просмотр справочной документации</li>
</ol>
<p>Выполняйте инструкции в меню для завершения всего процесса.</p>
<h3>Калибровка камеры</h3>
<p>Перед использованием обнаружения AprilTag рекомендуется откалибровать камеру для получения точных параметров:</p>
<pre><code class="language-bash"># Сначала сгенерируйте шахматную калибровочную доску
python create_chessboard.py --size 9x6 --square 100 --output chessboard.png --dpi 300

# Распечатайте шахматную доску и измерьте реальный размер клетки, затем выполните калибровку
python camera_calibration.py --size 9x6 --square 0.025 --output config/camera/HSK_200W53_1080P.yaml
</code></pre>
<p>Описание параметров:</p>
<p><strong>Утилита генерации шахматной доски (create_chessboard.py):</strong></p>
<ul>
<li><code>--size</code>: Количество внутренних углов шахматной доски, ширина x высота (по умолчанию: 9x6)</li>
<li><code>--square</code>: Размер клетки в пикселях (по умолчанию: 100)</li>
<li><code>--output</code>: Путь к выходному файлу (по умолчанию: chessboard.png)</li>
<li><code>--dpi</code>: DPI выходного изображения (по умолчанию: 300), влияет на размер при печати</li>
</ul>
<p><strong>Программа калибровки камеры (camera_calibration.py):</strong></p>
<ul>
<li><code>--size</code>: Количество внутренних углов шахматной доски, ширина x высота (по умолчанию: 9x6)</li>
<li><code>--square</code>: Размер клетки шахматной доски в метрах (по умолчанию: 0.025)</li>
<li><code>--output</code>: Путь к выходному файлу (по умолчанию: config/camera/HSK_200W53_1080P.yaml)</li>
<li><code>--camera</code>: ID устройства камеры (по умолчанию: 0)</li>
<li><code>--width</code>: Ширина захвата с камеры (по умолчанию: 1280)</li>
<li><code>--height</code>: Высота захвата с камеры (по умолчанию: 720)</li>
<li><code>--samples</code>: Количество необходимых образцов для калибровки (по умолчанию: 20)</li>
<li><code>--preview</code>: Просмотр результатов коррекции после калибровки</li>
</ul>
<p>Процесс калибровки:</p>
<ol>
<li>Сгенерируйте и распечатайте шахматную калибровочную доску</li>
<li>Измерьте реальный размер клетки (в метрах)</li>
<li>Запустите программу калибровки, разместите доску перед камерой, соберите образцы с разных ракурсов</li>
<li>Программа автоматически распознаёт шахматную доску и собирает образцы, можно вручную сохранить кадр нажатием клавиши 's'</li>
<li>После сбора необходимого количества образцов программа рассчитает параметры камеры и сохранит их в указанный файл</li>
</ol>
<h3>Обнаружение AprilTag</h3>
<p>После завершения калибровки можно запустить программу обнаружения AprilTag:</p>
<pre><code class="language-bash">python apriltag_detector.py
</code></pre>
<h3>Продвинутое использование</h3>
<pre><code class="language-bash">python apriltag_detector.py [путь к конфигурационному файлу] --camera ID_камеры --width ширина --height высота --camera_info файл_параметров_камеры
</code></pre>
<p>Описание параметров:</p>
<ul>
<li><code>путь к конфигурационному файлу</code>: путь к файлу конфигурации AprilTag (по умолчанию: <code>config/vision/tags_36h11_all.json</code>)</li>
<li><code>--camera</code>: ID устройства камеры (по умолчанию: 0)</li>
<li><code>--camera_info</code>: путь к файлу внутренних параметров камеры (по умолчанию: <code>config/camera/HSK_200W53_1080P.yaml</code>)</li>
<li><code>--width</code>: ширина захвата камеры (по умолчанию: 1280)</li>
<li><code>--height</code>: высота захвата камеры (по умолчанию: 720)</li>
</ul>
<h3>Управление с клавиатуры</h3>
<ul>
<li><code>q</code>: выход из программы</li>
</ul>
<h2>Описание конфигурационного файла</h2>
<p>Все параметры системы можно настроить в файле <code>config/vision/table_setup.json</code>:</p>
<pre><code class="language-json">{
    &quot;AprilTagConfig&quot;: {
        &quot;family&quot;: &quot;tag36h11&quot;,      // Семейство тегов
        &quot;size&quot;: 0.05,              // Физический размер тега (в метрах)
        &quot;threads&quot;: 2,              // Количество потоков обработки
        &quot;max_hamming&quot;: 0,          // Максимальное расстояние Хэмминга
        &quot;z_up&quot;: true,              // Ось Z направлена вверх
        &quot;decimate&quot;: 1.0,           // Коэффициент субдискретизации изображения
        &quot;blur&quot;: 0.8,               // Коэффициент размытия
        &quot;refine_edges&quot;: 1,         // Точная обработка краев
        &quot;debug&quot;: 0                 // Включение режима отладки
    },

    &quot;Camera&quot;: {
        &quot;device_id&quot;: 0,            // ID устройства камеры
        &quot;width&quot;: 1280,             // Разрешение по ширине
        &quot;height&quot;: 720,             // Разрешение по высоте
        &quot;camera_info_path&quot;: &quot;config/camera/HSK_200W53_1080P.yaml&quot;  // Файл параметров калибровки камеры
    },

    &quot;Archive&quot;: {
        &quot;enable&quot;: true,            // Включить архивирование данных
        &quot;preview&quot;: true,           // Показать окно предварительного просмотра
        &quot;save_raw&quot;: false,         // Сохранять исходные изображения
        &quot;save_pred&quot;: false,        // Сохранять предсказанные изображения
        &quot;path&quot;: &quot;./data/table_tracking&quot;  // Путь для сохранения данных
    },

    &quot;TableConfig&quot;: {
        &quot;reference_tags&quot;: [0, 1, 2, 3],      // Список ID опорных тегов
        &quot;moving_tags&quot;: [4, 5, 6],            // Список ID подвижных тегов
        &quot;require_initialization&quot;: true,       // Требуется ли инициализация
        &quot;tag_positions&quot;: {                    // Предустановленные позиции тегов (если есть)
            &quot;0&quot;: [0.0, 0.0, 0.0],
            &quot;1&quot;: [0.5, 0.0, 0.0],
            &quot;2&quot;: [0.5, 0.5, 0.0],
            &quot;3&quot;: [0.0, 0.5, 0.0]
        }
    }
}
</code></pre>
<p>Изменяя конфигурационный файл, вы можете:</p>
<ol>
<li>Настроить параметры детектора AprilTag</li>
<li>Задать параметры камеры (ID устройства, разрешение, файл параметров)</li>
<li>Настроить параметры архивирования данных</li>
<li>Задать ID опорных и подвижных тегов</li>
<li>Контролировать необходимость инициализации (установите <code>require_initialization</code> в <code>false</code>, чтобы пропустить инициализацию)</li>
<li>Указать предустановленные позиции тегов</li>
</ol>
<h3>Как использовать</h3>
<p>Очень просто, для запуска системы достаточно одной команды:</p>
<pre><code>python table_tracking.py
</code></pre>
<p>Если требуется использовать свой конфигурационный файл:</p>
<pre><code>python table_tracking.py --config путь_к_конфигу
</code></pre>
<p>После запуска системы можно в любой момент вручную инициировать процесс инициализации, нажав клавишу 'i'.</p>
<h2>Часто задаваемые вопросы</h2>
<ol>
<li><p><strong>Не найден модуль apriltag</strong></p>
<p>Убедитесь, что библиотека apriltag установлена и файл библиотеки доступен системе.</p>
</li>
<li><p><strong>Не удаётся открыть камеру</strong></p>
<p>Проверьте корректность ID устройства камеры и убедитесь, что камера не занята другим приложением.</p>
</li>
<li><p><strong>Некорректные результаты обнаружения</strong></p>
<p>Проверьте, что ваша камера откалибрована, а размер тега в конфигурационном файле задан правильно.</p>
</li>
</ol>
<h2>Описание структуры файлов</h2>
<pre><code>apriltag_standalone/
├── apriltag.py              # Основной код библиотеки обнаружения AprilTag
├── apriltag_detector.py     # Главная программа обнаружения AprilTag
├── apriltag_tool.py         # Меню запуска инструментов
├── camera_calibration.py    # Программа калибровки камеры
├── create_chessboard.py     # Генератор шахматных досок
├── configs.py               # Работа с конфигурационными файлами
├── config/                  # Каталог конфигураций
│   ├── camera/              # Конфигурации камеры
│   │   └── HSK_200W53_1080P.yaml  # Параметры камеры
│   └── vision/              # Конфигурации зрения
│       └── tags_36h11_all.json # Конфигурация AprilTag
├── README.md                # Документация
└── requirements.txt         # Зависимости Python
</code></pre>
<h2>Техническое описание</h2>
<p>Этот проект — независимая версия, перенесённая из ROS-пакета AprilTag-детекции, без зависимостей от ROS, с сохранением основной функциональности.
Используются следующие технологии:</p>
<ul>
<li>OpenCV: обработка изображений, калибровка камеры, оценка позы</li>
<li>AprilTag C-библиотека: обнаружение тегов</li>
<li>SciPy: преобразования вращения и кватернионы</li>
</ul>
<h2>Лицензия</h2>
<p>Данный проект распространяется под лицензией MIT</p>
<h2>Описание новых возможностей</h2>
<h3>Мульти-трек и обработка перекрытий</h3>
<p>Система теперь поддерживает следующие новые функции:</p>
<ol>
<li><p><strong>Фотографическая инициализация</strong>: После запуска система автоматически производит инициализацию с фиксацией взаимного положения тегов, включая:</p>
<ul>
<li>Положение фиксированных опорных тегов (ID 0–3)</li>
<li>Взаимное положение нескольких подвижных тегов (по умолчанию ID 4,5,6)</li>
</ul>
</li>
<li><p><strong>Обработка перекрытий</strong>: После инициализации, даже если некоторые теги перекрыты:</p>
<ul>
<li>Если опорные теги перекрыты, система может использовать другие видимые опорные теги для оценки положения перекрытых тегов</li>
<li>Если подвижные теги перекрыты, система может оценить положение перекрытых тегов по видимым подвижным тегам</li>
</ul>
</li>
<li><p><strong>Мульти-трекинг тегов</strong>: Поддерживается одновременное отслеживание нескольких подвижных тегов, по умолчанию ID 4,5,6</p>
<ul>
<li>Если относительное положение подвижных тегов фиксировано, то при видимости хотя бы одного тега возможно оценить положение остальных</li>
<li>ID подвижных тегов можно изменить в конфигурационном файле</li>
</ul>
</li>
</ol>
<h3>Описание конфигурационного файла</h3>
<p>Все параметры системы можно настроить в файле <code>config/vision/table_setup.json</code>:</p>
<pre><code class="language-json">{
    &quot;TableConfig&quot;: {
        &quot;reference_tags&quot;: [0, 1, 2, 3],      // Список ID опорных тегов
        &quot;moving_tags&quot;: [4, 5, 6],            // Список ID подвижных тегов
        &quot;require_initialization&quot;: true,       // Требуется ли инициализация
        &quot;tag_positions&quot;: {                    // Предустановленные позиции тегов (если есть)
            &quot;0&quot;: [0.0, 0.0, 0.0],
            &quot;1&quot;: [0.5, 0.0, 0.0],
            &quot;2&quot;: [0.5, 0.5, 0.0],
            &quot;3&quot;: [0.0, 0.5, 0.0]
        }
    }
}
</code></pre>
<p>Изменяя конфигурационный файл, вы можете:</p>
<ol>
<li>Указать свои ID опорных и подвижных тегов</li>
<li>Контролировать необходимость инициализации (установите <code>require_initialization</code> в <code>false</code>, чтобы пропустить инициализацию)</li>
<li>Указать предустановленные позиции тегов</li>
</ol>
<h3>Как использовать</h3>
<ol>
<li><p>Запуск системы с конфигурацией по умолчанию:</p>
<pre><code>python table_tracking.py
</code></pre>
</li>
<li><p>Запуск системы с собственным конфигом:</p>
<pre><code>python table_tracking.py --config путь_к_конфигу
</code></pre>
</li>
<li><p>Ручная инициализация: во время работы системы нажмите клавишу 'i'</p>
</li>
</ol>
<h3>Требования к запуску</h3>
<p>Убедитесь, что при инициализации все теги видимы — система зафиксирует их взаимное положение. После инициализации, даже если часть тегов перекрыта, система сможет корректно оценивать положение всех тегов.</p>
<pre><code>

---


Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-06-27


---
</code></pre>

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>