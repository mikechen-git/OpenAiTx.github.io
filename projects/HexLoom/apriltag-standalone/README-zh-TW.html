<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>apriltag-standalone - HexLoom/apriltag-standalone zh-TW</title>
    <meta name="title" content="apriltag-standalone - HexLoom/apriltag-standalone zh-TW | AprilTag獨立檢測庫 這是一個基於 pupil-apriltags 庫的 AprilTag 識別工具包，用於攝像頭中 AprilTag 的檢測和追蹤。 Deutsch | English | Español | français | 日本語 | 한국어 | Português | Русский | 中文 依賴庫...">
    <meta name="description" content="HexLoom/apriltag-standalone - GitHub repository zh-TW documentation and information | AprilTag獨立檢測庫 這是一個基於 pupil-apriltags 庫的 AprilTag 識別工具包，用於攝像頭中 AprilTag 的檢測和追蹤。 Deutsch | English | Español | français | 日本語 | 한국어 | Português | Русский | 中文 依賴庫...">
    <meta name="keywords" content="HexLoom, apriltag-standalone, GitHub, repository, zh-TW documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/HexLoom/apriltag-standalone/README-zh-TW.html">
    <meta property="og:title" content="apriltag-standalone - HexLoom/apriltag-standalone zh-TW | AprilTag獨立檢測庫 這是一個基於 pupil-apriltags 庫的 AprilTag 識別工具包，用於攝像頭中 AprilTag 的檢測和追蹤。 Deutsch | English | Español | français | 日本語 | 한국어 | Português | Русский | 中文 依賴庫...">
    <meta property="og:description" content="HexLoom/apriltag-standalone - GitHub repository zh-TW documentation and information | AprilTag獨立檢測庫 這是一個基於 pupil-apriltags 庫的 AprilTag 識別工具包，用於攝像頭中 AprilTag 的檢測和追蹤。 Deutsch | English | Español | français | 日本語 | 한국어 | Português | Русский | 中文 依賴庫...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div style="position: fixed; top: 2px; left: 2px; z-index: 2000; background: rgba(255,255,255,0.95); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 4px 14px; font-size: 15px; color: #222; font-family: 'Segoe UI', Arial, sans-serif; font-weight: 500; letter-spacing: 0.5px;">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: 600;">Open AI Tx</a>
    </div>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/HexLoom/apriltag-standalone" id="githubRepoLink" target="_blank">HexLoom/apriltag-standalone</a>
<h1 style="display: none;">AprilTag獨立檢測庫 這是一個基於 pupil-apriltags 庫的 AprilTag 識別工具包，用於攝像頭中 AprilTag 的檢測和追蹤。 Deutsch | English | Español | français | 日本語 | 한국어 | Português | Русский | 中文 依賴庫...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>AprilTag獨立檢測庫</h1>
<p>這是一個基於 pupil-apriltags 庫的 AprilTag 識別工具包，用於攝像頭中 AprilTag 的檢測和追蹤。</p>
<!-- Keep these links. Translations will automatically update with the README. -->
<p><a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=de">Deutsch</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=en">English</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=es">Español</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=fr">français</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=ja">日本語</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=ko">한국어</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=pt">Português</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=ru">Русский</a> |
<a href="https://www.readme-i18n.com/HexLoom/apriltag-standalone?lang=zh">中文</a></p>
<h2>依賴庫</h2>
<ul>
<li>Python 3.6+</li>
<li>OpenCV</li>
<li>NumPy</li>
<li>pupil-apriltags</li>
</ul>
<h2>安裝</h2>
<ol>
<li>確保已安裝 Python 環境</li>
<li>安裝必要的依賴：</li>
</ol>
<pre><code class="language-bash">pip install opencv-python numpy pupil-apriltags
</code></pre>
<h2>使用方法</h2>
<h3>基本用法</h3>
<pre><code class="language-python">import cv2
from apriltag import Detector, DetectorOptions

# 建立檢測器
options = DetectorOptions(
    families=&quot;tag36h11&quot;,  # 標籤家族
    border=1,             # 標籤邊框大小
    nthreads=4,           # 執行緒數量
    quad_decimate=1.0,    # 影像下採樣係數
    quad_blur=0.0,        # 高斯模糊係數
    refine_edges=True     # 是否精細化邊緣
)
detector = Detector(options)

# 讀取影像
img = cv2.imread(&quot;test_image.jpg&quot;)
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

# 檢測 AprilTag
detections = detector.detect(gray)

# 顯示檢測結果
for detection in detections:
    print(f&quot;標籤家族: {detection.tag_family}, ID: {detection.tag_id}&quot;)
    print(f&quot;位置: {detection.center}&quot;)
    print(f&quot;角點: {detection.corners}&quot;)
</code></pre>
<h3>繪製檢測結果</h3>
<pre><code class="language-python">import numpy as np
from apriltag import draw_detection_results

# 相機內參矩陣與畸變係數
K = np.array([[800, 0, 320], [0, 800, 240], [0, 0, 1]], dtype=np.float32)
D = np.zeros((4, 1), dtype=np.float32)

# 繪製檢測結果
result_img = draw_detection_results(img, detections, K, D, tag_size=0.1)

# 顯示結果
cv2.imshow(&quot;AprilTag檢測&quot;, result_img)
cv2.waitKey(0)
</code></pre>
<h3>執行測試腳本</h3>
<p>提供了一個簡單的測試腳本，可用於驗證 AprilTag 檢測功能：</p>
<pre><code class="language-bash">python test_apriltag.py
</code></pre>
<p>這將開啟電腦預設攝像頭並即時檢測 AprilTag。按 &quot;q&quot; 鍵退出。</p>
<h2>支援的標籤家族</h2>
<p>pupil-apriltags 庫支援下列標籤家族：</p>
<ul>
<li>tag36h11 (預設)</li>
<li>tag25h9</li>
<li>tag16h5</li>
<li>tagCircle21h7</li>
<li>tagCircle49h12</li>
<li>tagStandard41h12</li>
<li>tagStandard52h13</li>
<li>tagCustom48h12</li>
</ul>
<h2>注意事項</h2>
<ul>
<li>為獲得更佳效能，可調整 DetectorOptions 中的參數</li>
<li>對於運算資源有限的設備，可考慮提高 quad_decimate 參數以降低計算複雜度</li>
<li>請確保所使用的 AprilTag 標記尺寸與程式中的 tag_size 參數一致</li>
<li>繪製 3D 座標軸需準確的相機參數</li>
</ul>
<h2>功能特點</h2>
<ul>
<li>支援 USB 攝像頭即時 AprilTag 檢測</li>
<li>計算並顯示標籤的 3D 姿態（位置與方向）</li>
<li>支援儲存原始與標記後影像</li>
<li>可自訂配置與相機參數</li>
<li>包含完整的相機校正工具</li>
<li>不依賴 ROS，為原 ROS 套件的純 Python 獨立版本</li>
</ul>
<h2>安裝步驟</h2>
<h3>1. 安裝 AprilTag C 庫</h3>
<p>AprilTag 的 C 庫為必需元件。請依下列步驟安裝：</p>
<h4>Ubuntu/Debian:</h4>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install -y libapriltag-dev
</code></pre>
<h4>Windows:</h4>
<p>Windows 使用者需自行編譯或下載預編譯二進位檔，並確保 <code>apriltag.dll</code> 位於系統 PATH 中或當前目錄。</p>
<h3>2. 安裝 Python 依賴</h3>
<pre><code class="language-bash">pip install -r requirements.txt  -i https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple
pip install pupil-apriltags -i https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple
</code></pre>
<h2>使用說明</h2>
<h3>快速開始 (推薦)</h3>
<p>最簡單的使用方式為執行整合工具，該工具提供互動式選單來引導您完成所有步驟：</p>
<pre><code class="language-bash">python apriltag_tool.py
</code></pre>
<p>此工具會提供選單選項：</p>
<ol>
<li>產生棋盤格校正板</li>
<li>相機校正</li>
<li>AprilTag 檢測</li>
<li>檢視說明文件</li>
</ol>
<p>只需依照選單提示操作即可完成整個流程。</p>
<h3>相機校正</h3>
<p>於執行 AprilTag 檢測前，建議先進行相機校正，以獲得準確的相機參數：</p>
<pre><code class="language-bash"># 首先產生棋盤格校正板
python create_chessboard.py --size 9x6 --square 100 --output chessboard.png --dpi 300

# 列印棋盤格並測量實際方格大小，然後進行校正
python camera_calibration.py --size 9x6 --square 0.025 --output config/camera/HSK_200W53_1080P.yaml
</code></pre>
<p>參數說明:</p>
<p><strong>棋盤格產生工具 (create_chessboard.py):</strong></p>
<ul>
<li><code>--size</code>: 棋盤格內角點數量，寬x高（預設: 9x6）</li>
<li><code>--square</code>: 方格大小，像素（預設: 100）</li>
<li><code>--output</code>: 輸出檔案路徑（預設: chessboard.png）</li>
<li><code>--dpi</code>: 輸出影像 DPI（預設: 300），影響列印尺寸</li>
</ul>
<p><strong>相機校正程式 (camera_calibration.py):</strong></p>
<ul>
<li><code>--size</code>: 棋盤格內角點數量，寬x高（預設: 9x6）</li>
<li><code>--square</code>: 棋盤格方塊大小，單位公尺（預設: 0.025）</li>
<li><code>--output</code>: 輸出檔案路徑（預設: config/camera/HSK_200W53_1080P.yaml）</li>
<li><code>--camera</code>: 攝像頭裝置 ID（預設: 0）</li>
<li><code>--width</code>: 攝像頭擷取寬度（預設: 1280）</li>
<li><code>--height</code>: 攝像頭擷取高度（預設: 720）</li>
<li><code>--samples</code>: 校正所需樣本數（預設: 20）</li>
<li><code>--preview</code>: 校正完成後預覽校正效果</li>
</ul>
<p>校正流程：</p>
<ol>
<li>產生並列印棋盤格校正板</li>
<li>測量實際方格大小（以公尺為單位）</li>
<li>執行校正程式，將棋盤格放於相機前，從不同角度擷取樣本</li>
<li>程式會自動檢測棋盤格並收集樣本，也可按 's' 鍵手動儲存當前影格</li>
<li>收集足夠樣本後，程式自動計算相機參數並儲存至指定檔案</li>
</ol>
<h3>AprilTag 檢測</h3>
<p>校正完成後，可執行 AprilTag 檢測程式：</p>
<pre><code class="language-bash">python apriltag_detector.py
</code></pre>
<h3>高級用法</h3>
<pre><code class="language-bash">python apriltag_detector.py [配置文件路徑] --camera 相機ID --width 寬度 --height 高度 --camera_info 相機參數文件
</code></pre>
<p>參數說明:</p>
<ul>
<li><code>配置文件路徑</code>: AprilTag 配置文件路徑 (預設: <code>config/vision/tags_36h11_all.json</code>)</li>
<li><code>--camera</code>: 攝像頭設備ID (預設: 0)</li>
<li><code>--camera_info</code>: 相機內參文件路徑 (預設: <code>config/camera/HSK_200W53_1080P.yaml</code>)</li>
<li><code>--width</code>: 攝像頭捕獲寬度 (預設: 1280)</li>
<li><code>--height</code>: 攝像頭捕獲高度 (預設: 720)</li>
</ul>
<h3>按鍵控制</h3>
<ul>
<li><code>q</code>: 退出程式</li>
</ul>
<h2>配置文件說明</h2>
<p>系統的所有配置都可以在 <code>config/vision/table_setup.json</code> 文件中進行設定：</p>
<pre><code class="language-json">{
    &quot;AprilTagConfig&quot;: {
        &quot;family&quot;: &quot;tag36h11&quot;,      // 標籤家族
        &quot;size&quot;: 0.05,              // 標籤物理尺寸（單位：米）
        &quot;threads&quot;: 2,              // 處理執行緒數
        &quot;max_hamming&quot;: 0,          // 最大漢明距離
        &quot;z_up&quot;: true,              // Z軸朝上
        &quot;decimate&quot;: 1.0,           // 影像下採樣係數
        &quot;blur&quot;: 0.8,               // 模糊係數
        &quot;refine_edges&quot;: 1,         // 是否精細化邊緣
        &quot;debug&quot;: 0                 // 是否開啟除錯
    },

    &quot;Camera&quot;: {
        &quot;device_id&quot;: 0,            // 相機設備ID
        &quot;width&quot;: 1280,             // 相機寬度解析度
        &quot;height&quot;: 720,             // 相機高度解析度
        &quot;camera_info_path&quot;: &quot;config/camera/HSK_200W53_1080P.yaml&quot;  // 相機標定參數文件
    },

    &quot;Archive&quot;: {
        &quot;enable&quot;: true,            // 是否啟用資料歸檔
        &quot;preview&quot;: true,           // 是否顯示預覽視窗
        &quot;save_raw&quot;: false,         // 是否儲存原始影像
        &quot;save_pred&quot;: false,        // 是否儲存預測影像
        &quot;path&quot;: &quot;./data/table_tracking&quot;  // 資料儲存路徑
    },

    &quot;TableConfig&quot;: {
        &quot;reference_tags&quot;: [0, 1, 2, 3],      // 參考標籤ID列表
        &quot;moving_tags&quot;: [4, 5, 6],            // 移動標籤ID列表
        &quot;require_initialization&quot;: true,       // 是否需要初始化
        &quot;tag_positions&quot;: {                    // 預設標籤位置（如有）
            &quot;0&quot;: [0.0, 0.0, 0.0],
            &quot;1&quot;: [0.5, 0.0, 0.0],
            &quot;2&quot;: [0.5, 0.5, 0.0],
            &quot;3&quot;: [0.0, 0.5, 0.0]
        }
    }
}
</code></pre>
<p>透過修改配置文件，可以：</p>
<ol>
<li>配置 AprilTag 偵測器參數</li>
<li>設定相機參數（設備ID、解析度、參數文件）</li>
<li>配置資料歸檔選項</li>
<li>自訂參考標籤與移動標籤的ID</li>
<li>控制是否需要初始化（將 <code>require_initialization</code> 設為 <code>false</code> 可跳過初始化步驟）</li>
<li>預設標籤的位置信息</li>
</ol>
<h3>使用方法</h3>
<p>非常簡單，只需要一行指令即可啟動系統：</p>
<pre><code>python table_tracking.py
</code></pre>
<p>如需使用自訂配置文件：</p>
<pre><code>python table_tracking.py --config 自訂配置文件路徑
</code></pre>
<p>系統運行後，可隨時按 'i' 鍵手動觸發初始化流程。</p>
<h2>常見問題</h2>
<ol>
<li><p><strong>找不到 apriltag 函式庫</strong></p>
<p>請確認已正確安裝 apriltag 函式庫，且系統可找到該庫檔案。</p>
</li>
<li><p><strong>無法開啟相機</strong></p>
<p>請檢查相機設備ID是否正確，且相機未被其他程式佔用。</p>
</li>
<li><p><strong>偵測結果不準確</strong></p>
<p>請確認您的相機已正確標定，且配置文件中的標籤尺寸正確。</p>
</li>
</ol>
<h2>文件結構說明</h2>
<pre><code>apriltag_standalone/
├── apriltag.py              # AprilTag 偵測庫核心程式
├── apriltag_detector.py     # AprilTag 偵測主程式
├── apriltag_tool.py         # 集成工具啟動選單
├── camera_calibration.py    # 相機標定程式
├── create_chessboard.py     # 棋盤格生成工具
├── configs.py               # 配置文件處理
├── config/                  # 配置目錄
│   ├── camera/              # 相機配置
│   │   └── HSK_200W53_1080P.yaml  # 相機參數
│   └── vision/              # 視覺配置
│       └── tags_36h11_all.json # AprilTag 配置
├── README.md                # 說明文件
└── requirements.txt         # Python 相依套件
</code></pre>
<h2>技術說明</h2>
<p>本專案為從 ROS AprilTag 偵測包移植的獨立版本，去除了 ROS 依賴，保留核心功能。
主要使用以下技術：</p>
<ul>
<li>OpenCV：影像處理、相機標定與姿態估算</li>
<li>AprilTag C 函式庫：標籤偵測</li>
<li>SciPy：旋轉矩陣與四元數轉換</li>
</ul>
<h2>授權</h2>
<p>本專案採用 MIT 授權</p>
<h2>新功能說明</h2>
<h3>多標籤追蹤與遮蔽處理</h3>
<p>本系統現在支援以下新功能：</p>
<ol>
<li><p><strong>拍照初始化</strong>：系統啟動後會自動進行一次拍照初始化，記錄標籤之間的位置關係，包括：</p>
<ul>
<li>固定參考標籤（ID 0-3）的位置</li>
<li>多個移動標籤（預設 ID 4,5,6）之間的相對位置關係</li>
</ul>
</li>
<li><p><strong>遮蔽處理</strong>：初始化後，即使部分標籤被遮蔽：</p>
<ul>
<li>若參考標籤被遮蔽，系統可利用其他可見參考標籤推估被遮蔽標籤的位置</li>
<li>若移動標籤被遮蔽，系統可透過其他可見移動標籤推估被遮蔽移動標籤的位置</li>
</ul>
</li>
<li><p><strong>多標籤追蹤</strong>：支援同時追蹤多個移動標籤，預設支援 ID 4,5,6</p>
<ul>
<li>若移動標籤之間的相對位置為固定，只要有一個可見，即可推估其他標籤位置</li>
<li>可於配置文件中自訂移動標籤ID</li>
</ul>
</li>
</ol>
<h3>配置文件說明</h3>
<p>系統的所有配置都可以在 <code>config/vision/table_setup.json</code> 文件中進行設定：</p>
<pre><code class="language-json">{
    &quot;TableConfig&quot;: {
        &quot;reference_tags&quot;: [0, 1, 2, 3],      // 參考標籤ID列表
        &quot;moving_tags&quot;: [4, 5, 6],            // 移動標籤ID列表
        &quot;require_initialization&quot;: true,       // 是否需要初始化
        &quot;tag_positions&quot;: {                    // 預設標籤位置（如有）
            &quot;0&quot;: [0.0, 0.0, 0.0],
            &quot;1&quot;: [0.5, 0.0, 0.0],
            &quot;2&quot;: [0.5, 0.5, 0.0],
            &quot;3&quot;: [0.0, 0.5, 0.0]
        }
    }
}
</code></pre>
<p>透過修改配置文件，可以：</p>
<ol>
<li>自訂參考標籤與移動標籤的ID</li>
<li>控制是否需要初始化（將 <code>require_initialization</code> 設為 <code>false</code> 可跳過初始化步驟）</li>
<li>預設標籤的位置信息</li>
</ol>
<h3>使用方法</h3>
<ol>
<li><p>使用預設配置啟動系統：</p>
<pre><code>python table_tracking.py
</code></pre>
</li>
<li><p>使用自訂配置文件啟動系統：</p>
<pre><code>python table_tracking.py --config 自訂配置文件路徑
</code></pre>
</li>
<li><p>手動初始化：系統運作時按 'i' 鍵</p>
</li>
</ol>
<h3>執行要求</h3>
<p>請確保所有標籤於初始化時可見，系統會記錄標籤間的相對位置。初始化後，即使部分標籤被遮蔽，系統仍可正確推估所有標籤的位置。</p>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-06-27</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>