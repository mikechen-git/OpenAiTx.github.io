<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>storm - asdine/storm</title>
    <meta name="title" content="storm - asdine/storm">
    <meta name="description" content="asdine/storm - GitHub repository th documentation and informationStorm Storm เป็นชุดเครื่องมือที่เรียบง่ายและทรงพลังสำหรับ BoltDB โดยพื้นฐานแล้ว Storm มีระบบจัดทำดัชนี (indexes), วิธีการที่หลากหลายในการจัดเก็บและดึงข้อมูล, ระ...">
    <meta name="keywords" content="asdine, storm, GitHub, repository, th documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/asdine/storm/README-th.html">
    <meta property="og:title" content="storm - asdine/storm">
    <meta property="og:description" content="asdine/storm - GitHub repository th documentation and information">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/asdine/storm" id="githubRepoLink" target="_blank">asdine/storm</a>
<h1 style="display: none;">Storm Storm เป็นชุดเครื่องมือที่เรียบง่ายและทรงพลังสำหรับ BoltDB โดยพื้นฐานแล้ว Storm มีระบบจัดทำดัชนี (indexes), วิธีการที่หลากหลายในการจัดเก็บและดึงข้อมูล, ระ...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>Storm</h1>
<p><a href="https://travis-ci.org/asdine/storm"><img src="https://travis-ci.org/asdine/storm.svg" alt="Build Status" /></a>
<a href="https://godoc.org/github.com/asdine/storm"><img src="https://godoc.org/github.com/asdine/storm?status.svg" alt="GoDoc" /></a></p>
<p>Storm เป็นชุดเครื่องมือที่เรียบง่ายและทรงพลังสำหรับ <a href="https://github.com/coreos/bbolt">BoltDB</a> โดยพื้นฐานแล้ว Storm มีระบบจัดทำดัชนี (indexes), วิธีการที่หลากหลายในการจัดเก็บและดึงข้อมูล, ระบบค้นหาขั้นสูง และอื่นๆ อีกมากมาย</p>
<p>นอกจากตัวอย่างด้านล่างนี้แล้ว โปรดดู <a href="https://godoc.org/github.com/asdine/storm#pkg-examples">ตัวอย่างเพิ่มเติมใน GoDoc</a></p>
<p><em>สำหรับระบบค้นหาขั้นสูงและการรองรับ <a href="https://github.com/dgraph-io/badger">Badger</a> โปรดดูที่ <a href="https://github.com/asdine/genji">Genji</a></em></p>
<h2>สารบัญ</h2>
<ul>
<li><a href="#getting-started">เริ่มต้นใช้งาน</a></li>
<li><a href="#import-storm">นำเข้า Storm</a></li>
<li><a href="#open-a-database">เปิดฐานข้อมูล</a></li>
<li><a href="#simple-crud-system">ระบบ CRUD อย่างง่าย</a>
<ul>
<li><a href="#declare-your-structures">ประกาศโครงสร้างของคุณ</a></li>
<li><a href="#save-your-object">บันทึกอ็อบเจกต์ของคุณ</a>
<ul>
<li><a href="#auto-increment">เพิ่มค่าอัตโนมัติ</a></li>
</ul>
</li>
<li><a href="#simple-queries">การค้นหาแบบง่าย</a>
<ul>
<li><a href="#fetch-one-object">ดึงอ็อบเจกต์เดียว</a></li>
<li><a href="#fetch-multiple-objects">ดึงอ็อบเจกต์หลายรายการ</a></li>
<li><a href="#fetch-all-objects">ดึงอ็อบเจกต์ทั้งหมด</a></li>
<li><a href="#fetch-all-objects-sorted-by-index">ดึงอ็อบเจกต์ทั้งหมดเรียงตามดัชนี</a></li>
<li><a href="#fetch-a-range-of-objects">ดึงอ็อบเจกต์ในช่วง</a></li>
<li><a href="#fetch-objects-by-prefix">ดึงอ็อบเจกต์ตาม prefix</a></li>
<li><a href="#skip-limit-and-reverse">ข้าม, จำกัด และย้อนกลับ</a></li>
<li><a href="#delete-an-object">ลบอ็อบเจกต์</a></li>
<li><a href="#update-an-object">อัปเดตอ็อบเจกต์</a></li>
<li><a href="#initialize-buckets-and-indexes-before-saving-an-object">เตรียม bucket และดัชนีก่อนบันทึกอ็อบเจกต์</a></li>
<li><a href="#drop-a-bucket">ลบ bucket</a></li>
<li><a href="#re-index-a-bucket">สร้างดัชนี bucket ใหม่</a></li>
</ul>
</li>
<li><a href="#advanced-queries">การค้นหาขั้นสูง</a></li>
<li><a href="#transactions">ธุรกรรม</a></li>
<li><a href="#options">ตัวเลือก</a>
<ul>
<li><a href="#boltoptions">BoltOptions</a></li>
<li><a href="#marshalunmarshaler">MarshalUnmarshaler</a>
<ul>
<li><a href="#provided-codecs">Codec ที่มีให้</a></li>
</ul>
</li>
<li><a href="#use-existing-bolt-connection">ใช้การเชื่อมต่อ Bolt ที่มีอยู่</a></li>
<li><a href="#batch-mode">โหมด Batch</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#nodes-and-nested-buckets">Node และ bucket ซ้อน</a>
<ul>
<li><a href="#node-options">ตัวเลือก Node</a></li>
</ul>
</li>
<li><a href="#simple-keyvalue-store">Key/Value store แบบง่าย</a></li>
<li><a href="#boltdb">BoltDB</a></li>
<li><a href="#license">สัญญาอนุญาต</a></li>
<li><a href="#credits">เครดิต</a></li>
</ul>
<h2>เริ่มต้นใช้งาน</h2>
<pre><code class="language-bash">GO111MODULE=on go get -u github.com/asdine/storm/v3
</code></pre>
<h2>นำเข้า Storm</h2>
<pre><code class="language-go">import &quot;github.com/asdine/storm/v3&quot;
</code></pre>
<h2>เปิดฐานข้อมูล</h2>
<p>วิธีเปิดฐานข้อมูลอย่างรวดเร็ว</p>
<pre><code class="language-go">db, err := storm.Open(&quot;my.db&quot;)

defer db.Close()
</code></pre>
<p><code>Open</code> สามารถรับตัวเลือกหลายค่าเพื่อปรับแต่งการทำงาน ดูที่ <a href="#options">ตัวเลือก</a> ด้านล่าง</p>
<h2>ระบบ CRUD อย่างง่าย</h2>
<h3>ประกาศโครงสร้างของคุณ</h3>
<pre><code class="language-go">type User struct {
  ID int // primary key
  Group string `storm:&quot;index&quot;` // ฟิลด์นี้จะถูกจัดทำดัชนี
  Email string `storm:&quot;unique&quot;` // ฟิลด์นี้จะถูกจัดทำดัชนีแบบไม่ซ้ำ
  Name string // ฟิลด์นี้จะไม่ถูกจัดทำดัชนี
  Age int `storm:&quot;index&quot;`
}
</code></pre>
<p>Primary key สามารถเป็นชนิดใดก็ได้ตราบใดที่ไม่ใช่ค่า zero Storm จะค้นหา tag <code>id</code> หากไม่พบ Storm จะค้นหาชื่อฟิลด์ว่า <code>ID</code></p>
<pre><code class="language-go">type User struct {
  ThePrimaryKey string `storm:&quot;id&quot;`// primary key
  Group string `storm:&quot;index&quot;` // ฟิลด์นี้จะถูกจัดทำดัชนี
  Email string `storm:&quot;unique&quot;` // ฟิลด์นี้จะถูกจัดทำดัชนีแบบไม่ซ้ำ
  Name string // ฟิลด์นี้จะไม่ถูกจัดทำดัชนี
}
</code></pre>
<p>Storm รองรับ tag ในโครงสร้างซ้อนด้วย tag <code>inline</code></p>
<pre><code class="language-go">type Base struct {
  Ident bson.ObjectId `storm:&quot;id&quot;`
}

type User struct {
  Base      `storm:&quot;inline&quot;`
  Group     string `storm:&quot;index&quot;`
  Email     string `storm:&quot;unique&quot;`
  Name      string
  CreatedAt time.Time `storm:&quot;index&quot;`
}
</code></pre>
<h3>บันทึกอ็อบเจกต์ของคุณ</h3>
<pre><code class="language-go">user := User{
  ID: 10,
  Group: &quot;staff&quot;,
  Email: &quot;john@provider.com&quot;,
  Name: &quot;John&quot;,
  Age: 21,
  CreatedAt: time.Now(),
}

err := db.Save(&amp;user)
// err == nil

user.ID++
err = db.Save(&amp;user)
// err == storm.ErrAlreadyExists
</code></pre>
<p>แค่นั้นเอง</p>
<p><code>Save</code> จะสร้างหรืออัปเดตดัชนีและ bucket ที่จำเป็นทั้งหมด, ตรวจสอบข้อจำกัดแบบไม่ซ้ำ และบันทึกอ็อบเจกต์ลง store</p>
<h4>เพิ่มค่าอัตโนมัติ</h4>
<p>Storm สามารถเพิ่มค่าตัวเลขแบบอัตโนมัติ ทำให้คุณไม่ต้องกังวลเรื่องนี้ขณะบันทึกอ็อบเจกต์ ค่าใหม่จะถูกแทรกในฟิลด์ของคุณโดยอัตโนมัติ</p>
<pre><code class="language-go">
type Product struct {
  Pk                  int `storm:&quot;id,increment&quot;` // primary key พร้อมเพิ่มค่าอัตโนมัติ
  Name                string
  IntegerField        uint64 `storm:&quot;increment&quot;`
  IndexedIntegerField uint32 `storm:&quot;index,increment&quot;`
  UniqueIntegerField  int16  `storm:&quot;unique,increment=100&quot;` // สามารถตั้งค่าตั้งต้นได้
}

p := Product{Name: &quot;Vaccum Cleaner&quot;}

fmt.Println(p.Pk)
fmt.Println(p.IntegerField)
fmt.Println(p.IndexedIntegerField)
fmt.Println(p.UniqueIntegerField)
// 0
// 0
// 0
// 0

_ = db.Save(&amp;p)

fmt.Println(p.Pk)
fmt.Println(p.IntegerField)
fmt.Println(p.IndexedIntegerField)
fmt.Println(p.UniqueIntegerField)
// 1
// 1
// 1
// 100

</code></pre>
<h3>การค้นหาแบบง่าย</h3>
<p>สามารถดึงอ็อบเจกต์ใดก็ได้ ไม่ว่าจะจัดทำดัชนีหรือไม่ Storm จะใช้ดัชนีเมื่อมีให้ใช้ มิฉะนั้นจะใช้ <a href="#advanced-queries">ระบบค้นหาขั้นสูง</a></p>
<h4>ดึงอ็อบเจกต์เดียว</h4>
<pre><code class="language-go">var user User
err := db.One(&quot;Email&quot;, &quot;john@provider.com&quot;, &amp;user)
// err == nil

err = db.One(&quot;Name&quot;, &quot;John&quot;, &amp;user)
// err == nil

err = db.One(&quot;Name&quot;, &quot;Jack&quot;, &amp;user)
// err == storm.ErrNotFound
</code></pre>
<h4>ดึงอ็อบเจกต์หลายรายการ</h4>
<pre><code class="language-go">var users []User
err := db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users)
</code></pre>
<h4>ดึงข้อมูลอ็อบเจกต์ทั้งหมด</h4>
<pre><code class="language-go">var users []User
err := db.All(&amp;users)
</code></pre>
<h4>ดึงข้อมูลอ็อบเจกต์ทั้งหมดโดยเรียงตามดัชนี</h4>
<pre><code class="language-go">var users []User
err := db.AllByIndex(&quot;CreatedAt&quot;, &amp;users)
</code></pre>
<h4>ดึงข้อมูลอ็อบเจกต์ในช่วงที่กำหนด</h4>
<pre><code class="language-go">var users []User
err := db.Range(&quot;Age&quot;, 10, 21, &amp;users)
</code></pre>
<h4>ดึงข้อมูลอ็อบเจกต์โดยใช้ prefix</h4>
<pre><code class="language-go">var users []User
err := db.Prefix(&quot;Name&quot;, &quot;Jo&quot;, &amp;users)
</code></pre>
<h4>ข้าม, จำกัดจำนวน และย้อนกลับลำดับ</h4>
<pre><code class="language-go">var users []User
err := db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users, storm.Skip(10))
err = db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users, storm.Limit(10))
err = db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users, storm.Reverse())
err = db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users, storm.Limit(10), storm.Skip(10), storm.Reverse())

err = db.All(&amp;users, storm.Limit(10), storm.Skip(10), storm.Reverse())
err = db.AllByIndex(&quot;CreatedAt&quot;, &amp;users, storm.Limit(10), storm.Skip(10), storm.Reverse())
err = db.Range(&quot;Age&quot;, 10, 21, &amp;users, storm.Limit(10), storm.Skip(10), storm.Reverse())
</code></pre>
<h4>ลบอ็อบเจกต์</h4>
<pre><code class="language-go">err := db.DeleteStruct(&amp;user)
</code></pre>
<h4>อัปเดตอ็อบเจกต์</h4>
<pre><code class="language-go">// อัปเดตหลายฟิลด์
// ใช้ได้เฉพาะกับฟิลด์ที่ไม่ใช่ค่า zero-value (เช่น Name ต้องไม่เป็น &quot;&quot;, Age ต้องไม่เป็น 0)
err := db.Update(&amp;User{ID: 10, Name: &quot;Jack&quot;, Age: 45})

// อัปเดตฟิลด์เดียว
// ใช้กับค่า zero-value ได้ด้วย (0, false, &quot;&quot;, ...)
err := db.UpdateField(&amp;User{ID: 10}, &quot;Age&quot;, 0)
</code></pre>
<h4>สร้าง bucket และ index ล่วงหน้าก่อนบันทึกอ็อบเจกต์</h4>
<pre><code class="language-go">err := db.Init(&amp;User{})
</code></pre>
<p>มีประโยชน์เมื่อต้องการเริ่มต้นแอปพลิเคชัน</p>
<h4>ลบ bucket</h4>
<p>โดยใช้ struct</p>
<pre><code class="language-go">err := db.Drop(&amp;User)
</code></pre>
<p>โดยใช้ชื่อ bucket</p>
<pre><code class="language-go">err := db.Drop(&quot;User&quot;)
</code></pre>
<h4>สร้าง index ใหม่ให้กับ bucket</h4>
<pre><code class="language-go">err := db.ReIndex(&amp;User{})
</code></pre>
<p>มีประโยชน์เมื่อมีการเปลี่ยนแปลงโครงสร้าง</p>
<h3>การค้นหาขั้นสูง</h3>
<p>สำหรับการค้นหาที่ซับซ้อนขึ้น สามารถใช้เมธอด <code>Select</code>
<code>Select</code> สามารถรับ <a href="https://godoc.org/github.com/asdine/storm/q#Matcher"><code>Matcher</code></a> จากแพ็คเกจ <a href="https://godoc.org/github.com/asdine/storm/q"><code>q</code></a> ได้หลายตัว</p>
<p>ตัวอย่าง Matcher ที่ใช้บ่อย:</p>
<pre><code class="language-go">// เท่ากับ
q.Eq(&quot;Name&quot;, John)

// มากกว่า
q.Gt(&quot;Age&quot;, 7)

// น้อยกว่าหรือเท่ากับ
q.Lte(&quot;Age&quot;, 77)

// Regex กับชื่อที่ขึ้นต้นด้วย D
q.Re(&quot;Name&quot;, &quot;^D&quot;)

// อยู่ใน slice ที่กำหนด
q.In(&quot;Group&quot;, []string{&quot;Staff&quot;, &quot;Admin&quot;})

// เปรียบเทียบฟิลด์
q.EqF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
q.LtF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
q.GtF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
q.LteF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
q.GteF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
</code></pre>
<p>Matcher สามารถผสมกับ <code>And</code>, <code>Or</code> และ <code>Not</code> ได้:</p>
<pre><code class="language-go">
// ตรงทุกเงื่อนไข
q.And(
  q.Gt(&quot;Age&quot;, 7),
  q.Re(&quot;Name&quot;, &quot;^D&quot;)
)

// ตรงอย่างน้อยหนึ่งเงื่อนไข
q.Or(
  q.Re(&quot;Name&quot;, &quot;^A&quot;),
  q.Not(
    q.Re(&quot;Name&quot;, &quot;^B&quot;)
  ),
  q.Re(&quot;Name&quot;, &quot;^C&quot;),
  q.In(&quot;Group&quot;, []string{&quot;Staff&quot;, &quot;Admin&quot;}),
  q.And(
    q.StrictEq(&quot;Password&quot;, []byte(password)),
    q.Eq(&quot;Registered&quot;, true)
  )
)
</code></pre>
<p>สามารถดูรายการ Matcher ทั้งหมดได้ใน <a href="https://godoc.org/github.com/asdine/storm/q#Matcher">documentation</a></p>
<p><code>Select</code> รับ matcher ได้หลายตัวและจะรวมเป็น <code>q.And()</code> อัตโนมัติ ไม่จำเป็นต้องระบุเอง ผลลัพธ์คือ <a href="https://godoc.org/github.com/asdine/storm#Query"><code>Query</code></a></p>
<pre><code class="language-go">query := db.Select(q.Gte(&quot;Age&quot;, 7), q.Lte(&quot;Age&quot;, 77))
</code></pre>
<p>ชนิด <code>Query</code> มีเมธอดสำหรับกรองและเรียงลำดับเรคคอร์ด</p>
<pre><code class="language-go">// จำกัดจำนวน
query = query.Limit(10)

// ข้าม
query = query.Skip(20)

// สามารถเรียกต่อเนื่องกันได้
query = query.Limit(10).Skip(20).OrderBy(&quot;Age&quot;).Reverse()
</code></pre>
<p>และยังสามารถระบุวิธีดึงข้อมูลได้ด้วย</p>
<pre><code class="language-go">var users []User
err = query.Find(&amp;users)

var user User
err = query.First(&amp;user)
</code></pre>
<p>ตัวอย่างการใช้ <code>Select</code>:</p>
<pre><code class="language-go">// ค้นหาผู้ใช้ที่มี ID อยู่ระหว่าง 10 ถึง 100
err = db.Select(q.Gte(&quot;ID&quot;, 10), q.Lte(&quot;ID&quot;, 100)).Find(&amp;users)

// ใช้ matcher ซ้อนกัน
err = db.Select(q.Or(
  q.Gt(&quot;ID&quot;, 50),
  q.Lt(&quot;Age&quot;, 21),
  q.And(
    q.Eq(&quot;Group&quot;, &quot;admin&quot;),
    q.Gte(&quot;Age&quot;, 21),
  ),
)).Find(&amp;users)

query := db.Select(q.Gte(&quot;ID&quot;, 10), q.Lte(&quot;ID&quot;, 100)).Limit(10).Skip(5).Reverse().OrderBy(&quot;Age&quot;, &quot;Name&quot;)

// ค้นหาหลายเรคคอร์ด
err = query.Find(&amp;users)
// หรือ
err = db.Select(q.Gte(&quot;ID&quot;, 10), q.Lte(&quot;ID&quot;, 100)).Limit(10).Skip(5).Reverse().OrderBy(&quot;Age&quot;, &quot;Name&quot;).Find(&amp;users)
</code></pre>
<pre><code class="language-go">// ค้นหาข้อมูลแรก
err = query.First(&amp;user)
// หรือ
err = db.Select(q.Gte(&quot;ID&quot;, 10), q.Lte(&quot;ID&quot;, 100)).Limit(10).Skip(5).Reverse().OrderBy(&quot;Age&quot;, &quot;Name&quot;).First(&amp;user)

// ลบข้อมูลทั้งหมดที่ตรงกับเงื่อนไข
err = query.Delete(new(User))

// ดึงข้อมูลทีละรายการ (เหมาะสำหรับ bucket ที่มีข้อมูลจำนวนมาก)
query = db.Select(q.Gte(&quot;ID&quot;, 10),q.Lte(&quot;ID&quot;, 100)).OrderBy(&quot;Age&quot;, &quot;Name&quot;)

err = query.Each(new(User), func(record interface{}) error) {
  u := record.(*User)
  ...
  return nil
}
</code></pre>
<p>ดู <a href="https://godoc.org/github.com/asdine/storm#Query">เอกสารประกอบ</a> สำหรับรายการเมธอดทั้งหมด</p>
<h3>ธุรกรรม (Transactions)</h3>
<pre><code class="language-go">tx, err := db.Begin(true)
if err != nil {
  return err
}
defer tx.Rollback()

accountA.Amount -= 100
accountB.Amount += 100

err = tx.Save(accountA)
if err != nil {
  return err
}

err = tx.Save(accountB)
if err != nil {
  return err
}

return tx.Commit()
</code></pre>
<h3>ตัวเลือก (Options)</h3>
<p>ตัวเลือกของ Storm คือฟังก์ชันที่สามารถส่งไปตอนสร้างอินสแตนซ์ Storm คุณสามารถส่งตัวเลือกได้มากเท่าที่ต้องการ</p>
<h4>BoltOptions</h4>
<p>โดยปกติ Storm จะเปิดฐานข้อมูลด้วยโหมด <code>0600</code> และกำหนด timeout ไว้ที่ 1 วินาที<br />
คุณสามารถเปลี่ยนพฤติกรรมนี้ได้ด้วย <code>BoltOptions</code></p>
<pre><code class="language-go">db, err := storm.Open(&quot;my.db&quot;, storm.BoltOptions(0600, &amp;bolt.Options{Timeout: 1 * time.Second}))
</code></pre>
<h4>MarshalUnmarshaler</h4>
<p>เพื่อเก็บข้อมูลใน BoltDB, Storm จะ marshal ข้อมูลเป็น JSON โดยดีฟอลต์ หากต้องการเปลี่ยนพฤติกรรมนี้ สามารถส่ง codec ที่ implement <a href="https://godoc.org/github.com/asdine/storm/codec#MarshalUnmarshaler"><code>codec.MarshalUnmarshaler</code></a> ผ่าน <a href="https://godoc.org/github.com/asdine/storm#Codec"><code>storm.Codec</code></a> option:</p>
<pre><code class="language-go">db := storm.Open(&quot;my.db&quot;, storm.Codec(myCodec))
</code></pre>
<h5>Codec ที่มีให้ใช้</h5>
<p>คุณสามารถ implement <code>MarshalUnmarshaler</code> ของตัวเองได้อย่างง่ายดาย แต่ Storm มีรองรับในตัวสำหรับ <a href="https://godoc.org/github.com/asdine/storm/codec/json">JSON</a> (ดีฟอลต์), <a href="https://godoc.org/github.com/asdine/storm/codec/gob">GOB</a>,  <a href="https://godoc.org/github.com/asdine/storm/codec/sereal">Sereal</a>, <a href="https://godoc.org/github.com/asdine/storm/codec/protobuf">Protocol Buffers</a> และ <a href="https://godoc.org/github.com/asdine/storm/codec/msgpack">MessagePack</a></p>
<p>สิ่งเหล่านี้สามารถใช้งานได้โดย import package ที่เกี่ยวข้องและใช้ codec นั้นในการตั้งค่า Storm ตัวอย่างด้านล่างนี้แสดงทุกแบบ (โดยไม่จัดการ error):</p>
<pre><code class="language-go">import (
  &quot;github.com/asdine/storm/v3&quot;
  &quot;github.com/asdine/storm/v3/codec/gob&quot;
  &quot;github.com/asdine/storm/v3/codec/json&quot;
  &quot;github.com/asdine/storm/v3/codec/sereal&quot;
  &quot;github.com/asdine/storm/v3/codec/protobuf&quot;
  &quot;github.com/asdine/storm/v3/codec/msgpack&quot;
)

var gobDb, _ = storm.Open(&quot;gob.db&quot;, storm.Codec(gob.Codec))
var jsonDb, _ = storm.Open(&quot;json.db&quot;, storm.Codec(json.Codec))
var serealDb, _ = storm.Open(&quot;sereal.db&quot;, storm.Codec(sereal.Codec))
var protobufDb, _ = storm.Open(&quot;protobuf.db&quot;, storm.Codec(protobuf.Codec))
var msgpackDb, _ = storm.Open(&quot;msgpack.db&quot;, storm.Codec(msgpack.Codec))
</code></pre>
<p><strong>ทิป</strong>: การเพิ่มแท็ก Storm ให้กับไฟล์ Protobuf ที่ generate อาจจะยุ่งยาก วิธีที่ดีคือใช้ <a href="https://github.com/favadi/protoc-go-inject-tag">เครื่องมือนี้</a> เพื่อ inject แท็กในขั้นตอน compile</p>
<h4>ใช้การเชื่อมต่อ Bolt ที่มีอยู่แล้ว</h4>
<p>คุณสามารถใช้การเชื่อมต่อที่มีอยู่แล้วและส่งให้ Storm ได้</p>
<pre><code class="language-go">bDB, _ := bolt.Open(filepath.Join(dir, &quot;bolt.db&quot;), 0600, &amp;bolt.Options{Timeout: 10 * time.Second})
db := storm.Open(&quot;my.db&quot;, storm.UseDB(bDB))
</code></pre>
<h4>โหมด Batch</h4>
<p>สามารถเปิดโหมด batch เพื่อเร่งความเร็วการเขียนข้อมูลพร้อมกันหลายๆ รายการ (ดู <a href="https://github.com/coreos/bbolt#batch-read-write-transactions">Batch read-write transactions</a>)</p>
<pre><code class="language-go">db := storm.Open(&quot;my.db&quot;, storm.Batch())
</code></pre>
<h2>Nodes และ nested buckets</h2>
<p>Storm ใช้ประโยชน์จากฟีเจอร์ nested buckets ของ BoltDB โดยใช้ <code>storm.Node</code><br />
<code>storm.Node</code> คืออ็อบเจ็กต์ที่ใช้โดย <code>storm.DB</code> สำหรับจัดการ bucket<br />
เพื่อสร้าง nested bucket และใช้ API เดียวกับ <code>storm.DB</code> สามารถใช้เมธอด <code>DB.From</code></p>
<pre><code class="language-go">repo := db.From(&quot;repo&quot;)

err := repo.Save(&amp;Issue{
  Title: &quot;I want more features&quot;,
  Author: user.ID,
})

err = repo.Save(newRelease(&quot;0.10&quot;))

var issues []Issue
err = repo.Find(&quot;Author&quot;, user.ID, &amp;issues)

var release Release
err = repo.One(&quot;Tag&quot;, &quot;0.10&quot;, &amp;release)
</code></pre>
<p>คุณยังสามารถ chain node เพื่อสร้างลำดับชั้นได้</p>
<pre><code class="language-go">chars := db.From(&quot;characters&quot;)
heroes := chars.From(&quot;heroes&quot;)
enemies := chars.From(&quot;enemies&quot;)

items := db.From(&quot;items&quot;)
potions := items.From(&quot;consumables&quot;).From(&quot;medicine&quot;).From(&quot;potions&quot;)
</code></pre>
<p>คุณยังสามารถส่งลำดับชั้นทั้งหมดเป็น argument ให้ <code>From</code> ได้เช่นกัน:</p>
<pre><code class="language-go">privateNotes := db.From(&quot;notes&quot;, &quot;private&quot;)
workNotes :=  db.From(&quot;notes&quot;, &quot;work&quot;)
</code></pre>
<h3>ตัวเลือก Node</h3>
<p>Node ก็สามารถตั้งค่าตัวเลือกต่างๆ ได้เช่นกัน การเปิด option บน Node จะสร้างสำเนาใหม่เสมอ ดังนั้น Node จึง thread-safe</p>
<pre><code class="language-go">n := db.From(&quot;my-node&quot;)
</code></pre>
<p>ให้ bolt.Tx transaction กับ Node</p>
<pre><code class="language-go">n = n.WithTransaction(tx)
</code></pre>
<p>เปิด batch mode</p>
<pre><code class="language-go">n = n.WithBatch(true)
</code></pre>
<p>ใช้ Codec</p>
<pre><code class="language-go">n = n.WithCodec(gob.Codec)
</code></pre>
<h2>Simple Key/Value store</h2>
<p>Storm สามารถใช้เป็น key/value store ที่เรียบง่ายและมีความเสถียร สามารถเก็บอะไรก็ได้<br />
key และ value สามารถเป็นชนิดใดก็ได้ตราบใดที่ key ไม่ใช่ค่า zero value</p>
<p>การบันทึกข้อมูล :</p>
<pre><code class="language-go">db.Set(&quot;logs&quot;, time.Now(), &quot;I'm eating my breakfast man&quot;)
db.Set(&quot;sessions&quot;, bson.NewObjectId(), &amp;someUser)
db.Set(&quot;weird storage&quot;, &quot;754-3010&quot;, map[string]interface{}{
  &quot;hair&quot;: &quot;blonde&quot;,
  &quot;likes&quot;: []string{&quot;cheese&quot;, &quot;star wars&quot;},
})
</code></pre>
<p>การดึงข้อมูล :</p>
<pre><code class="language-go">user := User{}
db.Get(&quot;sessions&quot;, someObjectId, &amp;user)

var details map[string]interface{}
db.Get(&quot;weird storage&quot;, &quot;754-3010&quot;, &amp;details)
</code></pre>
<pre><code>db.Get(&quot;sessions&quot;, someObjectId, &amp;details)
</code></pre>
<p>การลบข้อมูล :</p>
<pre><code class="language-go">db.Delete(&quot;sessions&quot;, someObjectId)
db.Delete(&quot;weird storage&quot;, &quot;754-3010&quot;)
</code></pre>
<p>คุณสามารถค้นหาวิธีการที่มีประโยชน์อื่น ๆ ได้ใน <a href="https://godoc.org/github.com/asdine/storm#KeyValueStore">เอกสารประกอบ</a></p>
<h2>BoltDB</h2>
<p>BoltDB ยังคงสามารถเข้าถึงได้ง่ายและสามารถใช้งานได้ตามปกติ</p>
<pre><code class="language-go">db.Bolt.View(func(tx *bolt.Tx) error {
  bucket := tx.Bucket([]byte(&quot;my bucket&quot;))
  val := bucket.Get([]byte(&quot;any id&quot;))
  fmt.Println(string(val))
  return nil
})
</code></pre>
<p>ธุรกรรมสามารถส่งต่อไปยัง Storm ได้เช่นกัน</p>
<pre><code class="language-go">db.Bolt.Update(func(tx *bolt.Tx) error {
  ...
  dbx := db.WithTransaction(tx)
  err = dbx.Save(&amp;user)
  ...
  return nil
})
</code></pre>
<h2>ใบอนุญาต</h2>
<p>MIT</p>
<h2>เครดิต</h2>
<ul>
<li><a href="https://github.com/asdine">Asdine El Hrychy</a></li>
<li><a href="https://github.com/bep">Bjørn Erik Pedersen</a></li>
</ul>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-06-11</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Statcounter and other scripts can be added here -->
</body>
</html>