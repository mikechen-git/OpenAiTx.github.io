<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>storm - asdine/storm vi</title>
    <meta name="title" content="storm - asdine/storm vi | Storm Storm là một bộ công cụ đơn giản và mạnh mẽ dành cho BoltDB. Về cơ bản, Storm cung cấp các chỉ mục, nhiều phương thức đa dạng để lưu trữ và truy xuất dữ l...">
    <meta name="description" content="asdine/storm - GitHub repository vi documentation and information | Storm Storm là một bộ công cụ đơn giản và mạnh mẽ dành cho BoltDB. Về cơ bản, Storm cung cấp các chỉ mục, nhiều phương thức đa dạng để lưu trữ và truy xuất dữ l...">
    <meta name="keywords" content="asdine, storm, GitHub, repository, vi documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/asdine/storm/README-vi.html">
    <meta property="og:title" content="storm - asdine/storm vi | Storm Storm là một bộ công cụ đơn giản và mạnh mẽ dành cho BoltDB. Về cơ bản, Storm cung cấp các chỉ mục, nhiều phương thức đa dạng để lưu trữ và truy xuất dữ l...">
    <meta property="og:description" content="asdine/storm - GitHub repository vi documentation and information | Storm Storm là một bộ công cụ đơn giản và mạnh mẽ dành cho BoltDB. Về cơ bản, Storm cung cấp các chỉ mục, nhiều phương thức đa dạng để lưu trữ và truy xuất dữ l...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div style="position: fixed; top: 2px; left: 2px; z-index: 2000; background: rgba(255,255,255,0.95); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 4px 14px; font-size: 15px; color: #222; font-family: 'Segoe UI', Arial, sans-serif; font-weight: 500; letter-spacing: 0.5px;">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: 600;">Open AI Tx</a>
    </div>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/asdine/storm" id="githubRepoLink" target="_blank">asdine/storm</a>
<h1 style="display: none;">Storm Storm là một bộ công cụ đơn giản và mạnh mẽ dành cho BoltDB. Về cơ bản, Storm cung cấp các chỉ mục, nhiều phương thức đa dạng để lưu trữ và truy xuất dữ l...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>Storm</h1>
<p><a href="https://travis-ci.org/asdine/storm"><img src="https://travis-ci.org/asdine/storm.svg" alt="Build Status" /></a>
<a href="https://godoc.org/github.com/asdine/storm"><img src="https://godoc.org/github.com/asdine/storm?status.svg" alt="GoDoc" /></a></p>
<p>Storm là một bộ công cụ đơn giản và mạnh mẽ dành cho <a href="https://github.com/coreos/bbolt">BoltDB</a>. Về cơ bản, Storm cung cấp các chỉ mục, nhiều phương thức đa dạng để lưu trữ và truy xuất dữ liệu, một hệ thống truy vấn nâng cao và nhiều hơn nữa.</p>
<p>Ngoài các ví dụ bên dưới, hãy xem thêm <a href="https://godoc.org/github.com/asdine/storm#pkg-examples">các ví dụ trong GoDoc</a>.</p>
<p><em>Để truy vấn mở rộng và hỗ trợ cho <a href="https://github.com/dgraph-io/badger">Badger</a>, hãy xem thêm <a href="https://github.com/asdine/genji">Genji</a></em></p>
<h2>Mục lục</h2>
<ul>
<li><a href="#getting-started">Bắt đầu</a></li>
<li><a href="#import-storm">Nhập Storm</a></li>
<li><a href="#open-a-database">Mở một cơ sở dữ liệu</a></li>
<li><a href="#simple-crud-system">Hệ thống CRUD đơn giản</a>
<ul>
<li><a href="#declare-your-structures">Khai báo cấu trúc của bạn</a></li>
<li><a href="#save-your-object">Lưu đối tượng của bạn</a>
<ul>
<li><a href="#auto-increment">Tự động tăng</a></li>
</ul>
</li>
<li><a href="#simple-queries">Truy vấn đơn giản</a>
<ul>
<li><a href="#fetch-one-object">Truy xuất một đối tượng</a></li>
<li><a href="#fetch-multiple-objects">Truy xuất nhiều đối tượng</a></li>
<li><a href="#fetch-all-objects">Truy xuất tất cả đối tượng</a></li>
<li><a href="#fetch-all-objects-sorted-by-index">Truy xuất tất cả đối tượng được sắp xếp theo chỉ mục</a></li>
<li><a href="#fetch-a-range-of-objects">Truy xuất một dải đối tượng</a></li>
<li><a href="#fetch-objects-by-prefix">Truy xuất đối tượng theo tiền tố</a></li>
<li><a href="#skip-limit-and-reverse">Bỏ qua, Giới hạn và Đảo ngược</a></li>
<li><a href="#delete-an-object">Xóa một đối tượng</a></li>
<li><a href="#update-an-object">Cập nhật một đối tượng</a></li>
<li><a href="#initialize-buckets-and-indexes-before-saving-an-object">Khởi tạo bucket và chỉ mục trước khi lưu đối tượng</a></li>
<li><a href="#drop-a-bucket">Xóa một bucket</a></li>
<li><a href="#re-index-a-bucket">Tạo lại chỉ mục cho một bucket</a></li>
</ul>
</li>
<li><a href="#advanced-queries">Truy vấn nâng cao</a></li>
<li><a href="#transactions">Giao dịch</a></li>
<li><a href="#options">Tùy chọn</a>
<ul>
<li><a href="#boltoptions">BoltOptions</a></li>
<li><a href="#marshalunmarshaler">MarshalUnmarshaler</a>
<ul>
<li><a href="#provided-codecs">Codec được cung cấp</a></li>
</ul>
</li>
<li><a href="#use-existing-bolt-connection">Sử dụng kết nối Bolt hiện có</a></li>
<li><a href="#batch-mode">Chế độ Batch</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#nodes-and-nested-buckets">Node và bucket lồng nhau</a>
<ul>
<li><a href="#node-options">Tùy chọn Node</a></li>
</ul>
</li>
<li><a href="#simple-keyvalue-store">Khoá-giá trị đơn giản</a></li>
<li><a href="#boltdb">BoltDB</a></li>
<li><a href="#license">Giấy phép</a></li>
<li><a href="#credits">Công nhận</a></li>
</ul>
<h2>Bắt đầu</h2>
<pre><code class="language-bash">GO111MODULE=on go get -u github.com/asdine/storm/v3
</code></pre>
<h2>Nhập Storm</h2>
<pre><code class="language-go">import &quot;github.com/asdine/storm/v3&quot;
</code></pre>
<h2>Mở một cơ sở dữ liệu</h2>
<p>Cách nhanh để mở một cơ sở dữ liệu</p>
<pre><code class="language-go">db, err := storm.Open(&quot;my.db&quot;)

defer db.Close()
</code></pre>
<p><code>Open</code> có thể nhận nhiều tuỳ chọn để tuỳ chỉnh cách hoạt động. Xem thêm ở phần <a href="#options">Tùy chọn</a> bên dưới</p>
<h2>Hệ thống CRUD đơn giản</h2>
<h3>Khai báo cấu trúc của bạn</h3>
<pre><code class="language-go">type User struct {
  ID int // khoá chính
  Group string `storm:&quot;index&quot;` // trường này sẽ được tạo chỉ mục
  Email string `storm:&quot;unique&quot;` // trường này sẽ được tạo chỉ mục với ràng buộc duy nhất
  Name string // trường này sẽ không được tạo chỉ mục
  Age int `storm:&quot;index&quot;`
}
</code></pre>
<p>Khoá chính có thể là bất kỳ kiểu dữ liệu nào miễn là không phải giá trị zero. Storm sẽ tìm kiếm tag <code>id</code>, nếu không có thì sẽ tìm trường có tên là <code>ID</code>.</p>
<pre><code class="language-go">type User struct {
  ThePrimaryKey string `storm:&quot;id&quot;`// khoá chính
  Group string `storm:&quot;index&quot;` // trường này sẽ được tạo chỉ mục
  Email string `storm:&quot;unique&quot;` // trường này sẽ được tạo chỉ mục với ràng buộc duy nhất
  Name string // trường này sẽ không được tạo chỉ mục
}
</code></pre>
<p>Storm xử lý tag trong các cấu trúc lồng nhau với tag <code>inline</code></p>
<pre><code class="language-go">type Base struct {
  Ident bson.ObjectId `storm:&quot;id&quot;`
}

type User struct {
  Base      `storm:&quot;inline&quot;`
  Group     string `storm:&quot;index&quot;`
  Email     string `storm:&quot;unique&quot;`
  Name      string
  CreatedAt time.Time `storm:&quot;index&quot;`
}
</code></pre>
<h3>Lưu đối tượng của bạn</h3>
<pre><code class="language-go">user := User{
  ID: 10,
  Group: &quot;staff&quot;,
  Email: &quot;john@provider.com&quot;,
  Name: &quot;John&quot;,
  Age: 21,
  CreatedAt: time.Now(),
}

err := db.Save(&amp;user)
// err == nil

user.ID++
err = db.Save(&amp;user)
// err == storm.ErrAlreadyExists
</code></pre>
<p>Chỉ như vậy thôi.</p>
<p><code>Save</code> sẽ tạo hoặc cập nhật tất cả chỉ mục và bucket cần thiết, kiểm tra ràng buộc duy nhất và lưu đối tượng vào kho lưu trữ.</p>
<h4>Tự động tăng</h4>
<p>Storm có thể tự động tăng giá trị số nguyên nên bạn không cần lo lắng về việc này khi lưu đối tượng. Ngoài ra, giá trị mới cũng sẽ được tự động chèn vào trường của bạn.</p>
<pre><code class="language-go">
type Product struct {
  Pk                  int `storm:&quot;id,increment&quot;` // khoá chính với tự động tăng
  Name                string
  IntegerField        uint64 `storm:&quot;increment&quot;`
  IndexedIntegerField uint32 `storm:&quot;index,increment&quot;`
  UniqueIntegerField  int16  `storm:&quot;unique,increment=100&quot;` // có thể đặt giá trị bắt đầu
}

p := Product{Name: &quot;Vaccum Cleaner&quot;}

fmt.Println(p.Pk)
fmt.Println(p.IntegerField)
fmt.Println(p.IndexedIntegerField)
fmt.Println(p.UniqueIntegerField)
// 0
// 0
// 0
// 0

_ = db.Save(&amp;p)

fmt.Println(p.Pk)
fmt.Println(p.IntegerField)
fmt.Println(p.IndexedIntegerField)
fmt.Println(p.UniqueIntegerField)
// 1
// 1
// 1
// 100

</code></pre>
<h3>Truy vấn đơn giản</h3>
<p>Bất kỳ đối tượng nào cũng có thể được truy xuất, có chỉ mục hoặc không. Storm sẽ sử dụng chỉ mục khi có, nếu không sẽ sử dụng <a href="#advanced-queries">hệ thống truy vấn</a>.</p>
<h4>Truy xuất một đối tượng</h4>
<pre><code class="language-go">var user User
err := db.One(&quot;Email&quot;, &quot;john@provider.com&quot;, &amp;user)
// err == nil

err = db.One(&quot;Name&quot;, &quot;John&quot;, &amp;user)
// err == nil

err = db.One(&quot;Name&quot;, &quot;Jack&quot;, &amp;user)
// err == storm.ErrNotFound
</code></pre>
<h4>Truy xuất nhiều đối tượng</h4>
<pre><code class="language-go">var users []User
err := db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users)
</code></pre>
<h4>Lấy tất cả đối tượng</h4>
<pre><code class="language-go">var users []User
err := db.All(&amp;users)
</code></pre>
<h4>Lấy tất cả đối tượng và sắp xếp theo chỉ mục</h4>
<pre><code class="language-go">var users []User
err := db.AllByIndex(&quot;CreatedAt&quot;, &amp;users)
</code></pre>
<h4>Lấy một dải đối tượng</h4>
<pre><code class="language-go">var users []User
err := db.Range(&quot;Age&quot;, 10, 21, &amp;users)
</code></pre>
<h4>Lấy đối tượng theo tiền tố</h4>
<pre><code class="language-go">var users []User
err := db.Prefix(&quot;Name&quot;, &quot;Jo&quot;, &amp;users)
</code></pre>
<h4>Bỏ qua, Giới hạn và Đảo ngược</h4>
<pre><code class="language-go">var users []User
err := db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users, storm.Skip(10))
err = db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users, storm.Limit(10))
err = db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users, storm.Reverse())
err = db.Find(&quot;Group&quot;, &quot;staff&quot;, &amp;users, storm.Limit(10), storm.Skip(10), storm.Reverse())

err = db.All(&amp;users, storm.Limit(10), storm.Skip(10), storm.Reverse())
err = db.AllByIndex(&quot;CreatedAt&quot;, &amp;users, storm.Limit(10), storm.Skip(10), storm.Reverse())
err = db.Range(&quot;Age&quot;, 10, 21, &amp;users, storm.Limit(10), storm.Skip(10), storm.Reverse())
</code></pre>
<h4>Xóa một đối tượng</h4>
<pre><code class="language-go">err := db.DeleteStruct(&amp;user)
</code></pre>
<h4>Cập nhật một đối tượng</h4>
<pre><code class="language-go">// Cập nhật nhiều trường
// Chỉ hoạt động với trường có giá trị khác zero (ví dụ: Name không được là &quot;&quot;, Age không được là 0)
err := db.Update(&amp;User{ID: 10, Name: &quot;Jack&quot;, Age: 45})

// Cập nhật một trường đơn lẻ
// Cũng hoạt động với các giá trị zero (0, false, &quot;&quot;, ...)
err := db.UpdateField(&amp;User{ID: 10}, &quot;Age&quot;, 0)
</code></pre>
<h4>Khởi tạo buckets và indexes trước khi lưu đối tượng</h4>
<pre><code class="language-go">err := db.Init(&amp;User{})
</code></pre>
<p>Hữu ích khi bắt đầu ứng dụng của bạn</p>
<h4>Xóa một bucket</h4>
<p>Dùng struct</p>
<pre><code class="language-go">err := db.Drop(&amp;User)
</code></pre>
<p>Dùng tên bucket</p>
<pre><code class="language-go">err := db.Drop(&quot;User&quot;)
</code></pre>
<h4>Lập chỉ mục lại một bucket</h4>
<pre><code class="language-go">err := db.ReIndex(&amp;User{})
</code></pre>
<p>Hữu ích khi cấu trúc đã thay đổi</p>
<h3>Truy vấn nâng cao</h3>
<p>Đối với các truy vấn phức tạp hơn, bạn có thể sử dụng phương thức <code>Select</code>.
<code>Select</code> nhận vào bất kỳ số lượng <a href="https://godoc.org/github.com/asdine/storm/q#Matcher"><code>Matcher</code></a> nào từ gói <a href="https://godoc.org/github.com/asdine/storm/q"><code>q</code></a>.</p>
<p>Dưới đây là một số Matcher phổ biến:</p>
<pre><code class="language-go">// So sánh bằng
q.Eq(&quot;Name&quot;, John)

// Lớn hơn một cách nghiêm ngặt
q.Gt(&quot;Age&quot;, 7)

// Nhỏ hơn hoặc bằng
q.Lte(&quot;Age&quot;, 77)

// Regex với tên bắt đầu bằng chữ D
q.Re(&quot;Name&quot;, &quot;^D&quot;)

// Trong danh sách giá trị cho trước
q.In(&quot;Group&quot;, []string{&quot;Staff&quot;, &quot;Admin&quot;})

// So sánh các trường
q.EqF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
q.LtF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
q.GtF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
q.LteF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
q.GteF(&quot;FieldName&quot;, &quot;SecondFieldName&quot;)
</code></pre>
<p>Matcher cũng có thể kết hợp với <code>And</code>, <code>Or</code> và <code>Not</code>:</p>
<pre><code class="language-go">
// Khớp nếu tất cả đều khớp
q.And(
  q.Gt(&quot;Age&quot;, 7),
  q.Re(&quot;Name&quot;, &quot;^D&quot;)
)

// Khớp nếu một trong các điều kiện khớp
q.Or(
  q.Re(&quot;Name&quot;, &quot;^A&quot;),
  q.Not(
    q.Re(&quot;Name&quot;, &quot;^B&quot;)
  ),
  q.Re(&quot;Name&quot;, &quot;^C&quot;),
  q.In(&quot;Group&quot;, []string{&quot;Staff&quot;, &quot;Admin&quot;}),
  q.And(
    q.StrictEq(&quot;Password&quot;, []byte(password)),
    q.Eq(&quot;Registered&quot;, true)
  )
)
</code></pre>
<p>Bạn có thể tìm danh sách đầy đủ trong <a href="https://godoc.org/github.com/asdine/storm/q#Matcher">tài liệu</a>.</p>
<p><code>Select</code> nhận bất kỳ số lượng matcher nào và tự động bọc chúng trong một <code>q.And()</code>, vì vậy không cần chỉ định rõ. Nó trả về kiểu <a href="https://godoc.org/github.com/asdine/storm#Query"><code>Query</code></a>.</p>
<pre><code class="language-go">query := db.Select(q.Gte(&quot;Age&quot;, 7), q.Lte(&quot;Age&quot;, 77))
</code></pre>
<p>Kiểu <code>Query</code> chứa các phương thức để lọc và sắp xếp bản ghi.</p>
<pre><code class="language-go">// Giới hạn
query = query.Limit(10)

// Bỏ qua
query = query.Skip(20)

// Các lời gọi cũng có thể kết hợp chuỗi
query = query.Limit(10).Skip(20).OrderBy(&quot;Age&quot;).Reverse()
</code></pre>
<p>Ngoài ra còn để chỉ định cách lấy dữ liệu.</p>
<pre><code class="language-go">var users []User
err = query.Find(&amp;users)

var user User
err = query.First(&amp;user)
</code></pre>
<p>Ví dụ với <code>Select</code>:</p>
<pre><code class="language-go">// Tìm tất cả người dùng có ID từ 10 đến 100
err = db.Select(q.Gte(&quot;ID&quot;, 10), q.Lte(&quot;ID&quot;, 100)).Find(&amp;users)

// Matcher lồng nhau
err = db.Select(q.Or(
  q.Gt(&quot;ID&quot;, 50),
  q.Lt(&quot;Age&quot;, 21),
  q.And(
    q.Eq(&quot;Group&quot;, &quot;admin&quot;),
    q.Gte(&quot;Age&quot;, 21),
  ),
)).Find(&amp;users)

query := db.Select(q.Gte(&quot;ID&quot;, 10), q.Lte(&quot;ID&quot;, 100)).Limit(10).Skip(5).Reverse().OrderBy(&quot;Age&quot;, &quot;Name&quot;)

// Tìm nhiều bản ghi
err = query.Find(&amp;users)
// hoặc
err = db.Select(q.Gte(&quot;ID&quot;, 10), q.Lte(&quot;ID&quot;, 100)).Limit(10).Skip(5).Reverse().OrderBy(&quot;Age&quot;, &quot;Name&quot;).Find(&amp;users)
</code></pre>
<p>// Tìm bản ghi đầu tiên
err = query.First(&amp;user)
// hoặc
err = db.Select(q.Gte(&quot;ID&quot;, 10), q.Lte(&quot;ID&quot;, 100)).Limit(10).Skip(5).Reverse().OrderBy(&quot;Age&quot;, &quot;Name&quot;).First(&amp;user)</p>
<p>// Xóa tất cả các bản ghi phù hợp
err = query.Delete(new(User))</p>
<p>// Lấy từng bản ghi một (hữu ích khi bucket chứa nhiều bản ghi)
query = db.Select(q.Gte(&quot;ID&quot;, 10),q.Lte(&quot;ID&quot;, 100)).OrderBy(&quot;Age&quot;, &quot;Name&quot;)</p>
<p>err = query.Each(new(User), func(record interface{}) error) {
u := record.(*User)
...
return nil
}</p>
<pre><code>
Xem [tài liệu](https://godoc.org/github.com/asdine/storm#Query) để biết danh sách đầy đủ các phương thức.

### Giao dịch (Transactions)

```go
tx, err := db.Begin(true)
if err != nil {
  return err
}
defer tx.Rollback()

accountA.Amount -= 100
accountB.Amount += 100

err = tx.Save(accountA)
if err != nil {
  return err
}

err = tx.Save(accountB)
if err != nil {
  return err
}

return tx.Commit()
</code></pre>
<h3>Tùy chọn (Options)</h3>
<p>Các tùy chọn của Storm là các hàm có thể được truyền vào khi khởi tạo instance Storm của bạn. Bạn có thể truyền vào bất kỳ số lượng tùy chọn nào.</p>
<h4>BoltOptions</h4>
<p>Theo mặc định, Storm mở database với chế độ <code>0600</code> và timeout là một giây.
Bạn có thể thay đổi hành vi này bằng cách sử dụng <code>BoltOptions</code></p>
<pre><code class="language-go">db, err := storm.Open(&quot;my.db&quot;, storm.BoltOptions(0600, &amp;bolt.Options{Timeout: 1 * time.Second}))
</code></pre>
<h4>MarshalUnmarshaler</h4>
<p>Để lưu trữ dữ liệu trong BoltDB, Storm mặc định sẽ marshal nó thành JSON. Nếu bạn muốn thay đổi hành vi này, bạn có thể truyền vào một codec thực hiện <a href="https://godoc.org/github.com/asdine/storm/codec#MarshalUnmarshaler"><code>codec.MarshalUnmarshaler</code></a> thông qua tùy chọn <a href="https://godoc.org/github.com/asdine/storm#Codec"><code>storm.Codec</code></a>:</p>
<pre><code class="language-go">db := storm.Open(&quot;my.db&quot;, storm.Codec(myCodec))
</code></pre>
<h5>Các Codec được cung cấp sẵn</h5>
<p>Bạn có thể dễ dàng tự triển khai <code>MarshalUnmarshaler</code>, nhưng Storm đi kèm hỗ trợ sẵn cho <a href="https://godoc.org/github.com/asdine/storm/codec/json">JSON</a> (mặc định), <a href="https://godoc.org/github.com/asdine/storm/codec/gob">GOB</a>,  <a href="https://godoc.org/github.com/asdine/storm/codec/sereal">Sereal</a>, <a href="https://godoc.org/github.com/asdine/storm/codec/protobuf">Protocol Buffers</a> và <a href="https://godoc.org/github.com/asdine/storm/codec/msgpack">MessagePack</a>.</p>
<p>Bạn có thể sử dụng bằng cách import package tương ứng và dùng codec đó để cấu hình Storm. Ví dụ dưới đây cho thấy tất cả các biến thể (không xử lý lỗi):</p>
<pre><code class="language-go">import (
  &quot;github.com/asdine/storm/v3&quot;
  &quot;github.com/asdine/storm/v3/codec/gob&quot;
  &quot;github.com/asdine/storm/v3/codec/json&quot;
  &quot;github.com/asdine/storm/v3/codec/sereal&quot;
  &quot;github.com/asdine/storm/v3/codec/protobuf&quot;
  &quot;github.com/asdine/storm/v3/codec/msgpack&quot;
)

var gobDb, _ = storm.Open(&quot;gob.db&quot;, storm.Codec(gob.Codec))
var jsonDb, _ = storm.Open(&quot;json.db&quot;, storm.Codec(json.Codec))
var serealDb, _ = storm.Open(&quot;sereal.db&quot;, storm.Codec(sereal.Codec))
var protobufDb, _ = storm.Open(&quot;protobuf.db&quot;, storm.Codec(protobuf.Codec))
var msgpackDb, _ = storm.Open(&quot;msgpack.db&quot;, storm.Codec(msgpack.Codec))
</code></pre>
<p><strong>Mẹo</strong>: Thêm tag Storm vào file Protobuf sinh tự động có thể khó khăn. Một giải pháp tốt là sử dụng <a href="https://github.com/favadi/protoc-go-inject-tag">công cụ này</a> để chèn tag trong quá trình biên dịch.</p>
<h4>Sử dụng kết nối Bolt có sẵn</h4>
<p>Bạn có thể sử dụng một kết nối đã có và truyền nó vào Storm</p>
<pre><code class="language-go">bDB, _ := bolt.Open(filepath.Join(dir, &quot;bolt.db&quot;), 0600, &amp;bolt.Options{Timeout: 10 * time.Second})
db := storm.Open(&quot;my.db&quot;, storm.UseDB(bDB))
</code></pre>
<h4>Chế độ batch</h4>
<p>Chế độ batch có thể được bật để tăng tốc ghi đồng thời (xem <a href="https://github.com/coreos/bbolt#batch-read-write-transactions">Batch read-write transactions</a>)</p>
<pre><code class="language-go">db := storm.Open(&quot;my.db&quot;, storm.Batch())
</code></pre>
<h2>Node và bucket lồng nhau</h2>
<p>Storm tận dụng tính năng bucket lồng nhau của BoltDB bằng cách sử dụng <code>storm.Node</code>.
Một <code>storm.Node</code> là đối tượng nền được <code>storm.DB</code> sử dụng để thao tác với một bucket.
Để tạo một bucket lồng nhau và sử dụng cùng API như <code>storm.DB</code>, bạn có thể dùng phương thức <code>DB.From</code>.</p>
<pre><code class="language-go">repo := db.From(&quot;repo&quot;)

err := repo.Save(&amp;Issue{
  Title: &quot;I want more features&quot;,
  Author: user.ID,
})

err = repo.Save(newRelease(&quot;0.10&quot;))

var issues []Issue
err = repo.Find(&quot;Author&quot;, user.ID, &amp;issues)

var release Release
err = repo.One(&quot;Tag&quot;, &quot;0.10&quot;, &amp;release)
</code></pre>
<p>Bạn cũng có thể nối chuỗi các node để tạo thành một cấu trúc phân cấp</p>
<pre><code class="language-go">chars := db.From(&quot;characters&quot;)
heroes := chars.From(&quot;heroes&quot;)
enemies := chars.From(&quot;enemies&quot;)

items := db.From(&quot;items&quot;)
potions := items.From(&quot;consumables&quot;).From(&quot;medicine&quot;).From(&quot;potions&quot;)
</code></pre>
<p>Bạn thậm chí có thể truyền toàn bộ cấu trúc phân cấp làm đối số cho <code>From</code>:</p>
<pre><code class="language-go">privateNotes := db.From(&quot;notes&quot;, &quot;private&quot;)
workNotes :=  db.From(&quot;notes&quot;, &quot;work&quot;)
</code></pre>
<h3>Tùy chọn cho Node</h3>
<p>Một Node cũng có thể được cấu hình. Kích hoạt một tùy chọn trên Node sẽ tạo ra một bản sao, do đó Node luôn an toàn cho đa luồng.</p>
<pre><code class="language-go">n := db.From(&quot;my-node&quot;)
</code></pre>
<p>Truyền một giao dịch bolt.Tx cho Node</p>
<pre><code class="language-go">n = n.WithTransaction(tx)
</code></pre>
<p>Bật chế độ batch</p>
<pre><code class="language-go">n = n.WithBatch(true)
</code></pre>
<p>Sử dụng một Codec</p>
<pre><code class="language-go">n = n.WithCodec(gob.Codec)
</code></pre>
<h2>Lưu trữ Key/Value đơn giản</h2>
<p>Storm có thể được sử dụng như một kho key/value đơn giản, mạnh mẽ, có thể lưu trữ bất cứ thứ gì.
Key và value có thể thuộc bất kỳ kiểu nào miễn là key không phải là giá trị zero.</p>
<p>Lưu dữ liệu :</p>
<pre><code class="language-go">db.Set(&quot;logs&quot;, time.Now(), &quot;I'm eating my breakfast man&quot;)
db.Set(&quot;sessions&quot;, bson.NewObjectId(), &amp;someUser)
db.Set(&quot;weird storage&quot;, &quot;754-3010&quot;, map[string]interface{}{
  &quot;hair&quot;: &quot;blonde&quot;,
  &quot;likes&quot;: []string{&quot;cheese&quot;, &quot;star wars&quot;},
})
</code></pre>
<p>Lấy dữ liệu :</p>
<pre><code class="language-go">user := User{}
db.Get(&quot;sessions&quot;, someObjectId, &amp;user)

var details map[string]interface{}
db.Get(&quot;weird storage&quot;, &quot;754-3010&quot;, &amp;details)
</code></pre>
<p>db.Get(&quot;sessions&quot;, someObjectId, &amp;details)</p>
<pre><code>
Xóa dữ liệu :

```go
db.Delete(&quot;sessions&quot;, someObjectId)
db.Delete(&quot;weird storage&quot;, &quot;754-3010&quot;)
</code></pre>
<p>Bạn có thể tìm thấy các phương thức hữu ích khác trong <a href="https://godoc.org/github.com/asdine/storm#KeyValueStore">tài liệu hướng dẫn</a>.</p>
<h2>BoltDB</h2>
<p>BoltDB vẫn có thể truy cập dễ dàng và có thể sử dụng như thông thường</p>
<pre><code class="language-go">db.Bolt.View(func(tx *bolt.Tx) error {
  bucket := tx.Bucket([]byte(&quot;my bucket&quot;))
  val := bucket.Get([]byte(&quot;any id&quot;))
  fmt.Println(string(val))
  return nil
})
</code></pre>
<p>Một giao dịch cũng có thể được truyền vào cho Storm</p>
<pre><code class="language-go">db.Bolt.Update(func(tx *bolt.Tx) error {
  ...
  dbx := db.WithTransaction(tx)
  err = dbx.Save(&amp;user)
  ...
  return nil
})
</code></pre>
<h2>Giấy phép</h2>
<p>MIT</p>
<h2>Công nhận</h2>
<ul>
<li><a href="https://github.com/asdine">Asdine El Hrychy</a></li>
<li><a href="https://github.com/bep">Bjørn Erik Pedersen</a></li>
</ul>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-06-11</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>