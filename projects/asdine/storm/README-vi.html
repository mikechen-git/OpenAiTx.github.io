<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storm - asdine/storm</title>

    <!-- Primary Meta Tags -->
    <meta name="title" content="Storm - asdine/storm">
    <meta name="description" content="asdine/storm - GitHub repository documentation and information">
    <meta name="keywords" content="asdine, storm, GitHub, repository, documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/asdine/storm/README-vi.html">
    <meta property="og:title" content="Storm - asdine/storm">
    <meta property="og:description" content="asdine/storm - GitHub repository documentation and information">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">

    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">

    <!-- Marked.js for Markdown rendering -->
    <script type="text/javascript" async="" src="https://www.statcounter.com/counter/recorder.js"></script><script src="/js/marked.min.js?v=20250613"></script>
    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        /* Layout */
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .main-container {
            margin: 0 auto;
            width: 100%;
            max-width: 980px;
            padding: 0 20px;
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 0 15px;
            }
        }

        /* Image size restrictions */
        .markdown-body img {
            max-width: 100%;
            height: auto;
        }

        /* Existing styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f6f8fa;
            border-bottom: 1px solid #e1e4e8;
            position: relative;
        }

        .back-button {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #0366d6;
            text-decoration: none;
            display: flex;
            align-items: center;
            font-size: 14px;
            padding: 5px 10px;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            background-color: #fff;
        }

        .back-button:hover {
            background-color: #f6f8fa;
            border-color: #0366d6;
        }

        .back-button::before {
            content: "←";
            margin-right: 5px;
            font-size: 16px;
        }

        .header .links {
            margin-top: 10px;
            font-size: 16px;
        }

        .header .links a {
            color: #0366d6;
            text-decoration: none;
            margin-left: 5px;
        }

        .header .links a:hover {
            text-decoration: underline;
        }
        
        /* Language badges styles */
        .language-badges {
            margin-top: 15px;
            text-align: center;
        }
        .language-badges a {
            display: inline-block;
            margin: 2px;
            text-decoration: none;
        }
        .language-badges img {
            height: 20px;
            border-radius: 3px;
        }
        .language-badges a:hover img {
            opacity: 0.8;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/asdine/storm" id="githubRepoLink" target="_blank">asdine/storm</a>
        </div>
        <div class="language-badges" id="languageBadges"><a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=en"><img src="https://img.shields.io/badge/EN-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=zh-CN"><img src="https://img.shields.io/badge/简中-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=zh-TW"><img src="https://img.shields.io/badge/繁中-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=ja"><img src="https://img.shields.io/badge/日本語-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=ko"><img src="https://img.shields.io/badge/한국어-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=th"><img src="https://img.shields.io/badge/ไทย-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=fr"><img src="https://img.shields.io/badge/Français-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=de"><img src="https://img.shields.io/badge/Deutsch-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=es"><img src="https://img.shields.io/badge/Español-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=it"><img src="https://img.shields.io/badge/Italiano-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=ru"><img src="https://img.shields.io/badge/Русский-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=pt"><img src="https://img.shields.io/badge/Português-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=nl"><img src="https://img.shields.io/badge/Nederlands-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=pl"><img src="https://img.shields.io/badge/Polski-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=ar"><img src="https://img.shields.io/badge/العربية-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=tr"><img src="https://img.shields.io/badge/Türkçe-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=vi"><img src="https://img.shields.io/badge/Tiếng Việt-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=hi"><img src="https://img.shields.io/badge/हिंदी-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=fa"><img src="https://img.shields.io/badge/فارسی-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=asdine&amp;project=storm&amp;lang=id"><img src="https://img.shields.io/badge/Bahasa Indonesia-white" alt="version"></a></div>
    </div>

    <div class="main-container">
        <div class="markdown-body" id="content"><h1>Storm</h1>
<p><a href="https://travis-ci.org/asdine/storm"><img src="https://travis-ci.org/asdine/storm.svg" alt="Build Status"></a><br><a href="https://godoc.org/github.com/asdine/storm"><img src="https://godoc.org/github.com/asdine/storm?status.svg" alt="GoDoc"></a></p>
<p>Storm là một bộ công cụ đơn giản và mạnh mẽ dành cho <a href="https://github.com/coreos/bbolt">BoltDB</a>. Về cơ bản, Storm cung cấp các chỉ mục, nhiều phương thức đa dạng để lưu trữ và truy xuất dữ liệu, một hệ thống truy vấn nâng cao và nhiều hơn nữa.</p>
<p>Ngoài các ví dụ bên dưới, hãy xem thêm <a href="https://godoc.org/github.com/asdine/storm#pkg-examples">các ví dụ trong GoDoc</a>.</p>
<p><em>Để truy vấn mở rộng và hỗ trợ cho <a href="https://github.com/dgraph-io/badger">Badger</a>, hãy xem thêm <a href="https://github.com/asdine/genji">Genji</a></em></p>
<h2>Mục lục</h2>
<ul>
<li><a href="#getting-started">Bắt đầu</a></li>
<li><a href="#import-storm">Nhập Storm</a></li>
<li><a href="#open-a-database">Mở một cơ sở dữ liệu</a></li>
<li><a href="#simple-crud-system">Hệ thống CRUD đơn giản</a><ul>
<li><a href="#declare-your-structures">Khai báo cấu trúc của bạn</a></li>
<li><a href="#save-your-object">Lưu đối tượng của bạn</a><ul>
<li><a href="#auto-increment">Tự động tăng</a></li>
</ul>
</li>
<li><a href="#simple-queries">Truy vấn đơn giản</a><ul>
<li><a href="#fetch-one-object">Truy xuất một đối tượng</a></li>
<li><a href="#fetch-multiple-objects">Truy xuất nhiều đối tượng</a></li>
<li><a href="#fetch-all-objects">Truy xuất tất cả đối tượng</a></li>
<li><a href="#fetch-all-objects-sorted-by-index">Truy xuất tất cả đối tượng được sắp xếp theo chỉ mục</a></li>
<li><a href="#fetch-a-range-of-objects">Truy xuất một dải đối tượng</a></li>
<li><a href="#fetch-objects-by-prefix">Truy xuất đối tượng theo tiền tố</a></li>
<li><a href="#skip-limit-and-reverse">Bỏ qua, Giới hạn và Đảo ngược</a></li>
<li><a href="#delete-an-object">Xóa một đối tượng</a></li>
<li><a href="#update-an-object">Cập nhật một đối tượng</a></li>
<li><a href="#initialize-buckets-and-indexes-before-saving-an-object">Khởi tạo bucket và chỉ mục trước khi lưu đối tượng</a></li>
<li><a href="#drop-a-bucket">Xóa một bucket</a></li>
<li><a href="#re-index-a-bucket">Tạo lại chỉ mục cho một bucket</a></li>
</ul>
</li>
<li><a href="#advanced-queries">Truy vấn nâng cao</a></li>
<li><a href="#transactions">Giao dịch</a></li>
<li><a href="#options">Tùy chọn</a><ul>
<li><a href="#boltoptions">BoltOptions</a></li>
<li><a href="#marshalunmarshaler">MarshalUnmarshaler</a><ul>
<li><a href="#provided-codecs">Codec được cung cấp</a></li>
</ul>
</li>
<li><a href="#use-existing-bolt-connection">Sử dụng kết nối Bolt hiện có</a></li>
<li><a href="#batch-mode">Chế độ Batch</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#nodes-and-nested-buckets">Node và bucket lồng nhau</a><ul>
<li><a href="#node-options">Tùy chọn Node</a></li>
</ul>
</li>
<li><a href="#simple-keyvalue-store">Khoá-giá trị đơn giản</a></li>
<li><a href="#boltdb">BoltDB</a></li>
<li><a href="#license">Giấy phép</a></li>
<li><a href="#credits">Công nhận</a></li>
</ul>
<h2>Bắt đầu</h2>
<pre><code class="language-bash hljs">GO111MODULE=on go get -u github.com/asdine/storm/v3
</code></pre>
<h2>Nhập Storm</h2>
<pre><code class="language-go hljs"><span class="hljs-keyword">import</span> <span class="hljs-string">"github.com/asdine/storm/v3"</span>
</code></pre>
<h2>Mở một cơ sở dữ liệu</h2>
<p>Cách nhanh để mở một cơ sở dữ liệu</p>
<pre><code class="language-go hljs">db, err := storm.Open(<span class="hljs-string">"my.db"</span>)

<span class="hljs-keyword">defer</span> db.Close()
</code></pre>
<p><code>Open</code> có thể nhận nhiều tuỳ chọn để tuỳ chỉnh cách hoạt động. Xem thêm ở phần <a href="#options">Tùy chọn</a> bên dưới</p>
<h2>Hệ thống CRUD đơn giản</h2>
<h3>Khai báo cấu trúc của bạn</h3>
<pre><code class="language-go hljs"><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
  ID <span class="hljs-type">int</span> <span class="hljs-comment">// khoá chính</span>
  Group <span class="hljs-type">string</span> <span class="hljs-string">`storm:"index"`</span> <span class="hljs-comment">// trường này sẽ được tạo chỉ mục</span>
  Email <span class="hljs-type">string</span> <span class="hljs-string">`storm:"unique"`</span> <span class="hljs-comment">// trường này sẽ được tạo chỉ mục với ràng buộc duy nhất</span>
  Name <span class="hljs-type">string</span> <span class="hljs-comment">// trường này sẽ không được tạo chỉ mục</span>
  Age <span class="hljs-type">int</span> <span class="hljs-string">`storm:"index"`</span>
}
</code></pre>
<p>Khoá chính có thể là bất kỳ kiểu dữ liệu nào miễn là không phải giá trị zero. Storm sẽ tìm kiếm tag <code>id</code>, nếu không có thì sẽ tìm trường có tên là <code>ID</code>.</p>
<pre><code class="language-go hljs"><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
  ThePrimaryKey <span class="hljs-type">string</span> <span class="hljs-string">`storm:"id"`</span><span class="hljs-comment">// khoá chính</span>
  Group <span class="hljs-type">string</span> <span class="hljs-string">`storm:"index"`</span> <span class="hljs-comment">// trường này sẽ được tạo chỉ mục</span>
  Email <span class="hljs-type">string</span> <span class="hljs-string">`storm:"unique"`</span> <span class="hljs-comment">// trường này sẽ được tạo chỉ mục với ràng buộc duy nhất</span>
  Name <span class="hljs-type">string</span> <span class="hljs-comment">// trường này sẽ không được tạo chỉ mục</span>
}
</code></pre>
<p>Storm xử lý tag trong các cấu trúc lồng nhau với tag <code>inline</code></p>
<pre><code class="language-go hljs"><span class="hljs-keyword">type</span> Base <span class="hljs-keyword">struct</span> {
  Ident bson.ObjectId <span class="hljs-string">`storm:"id"`</span>
}

<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
  Base      <span class="hljs-string">`storm:"inline"`</span>
  Group     <span class="hljs-type">string</span> <span class="hljs-string">`storm:"index"`</span>
  Email     <span class="hljs-type">string</span> <span class="hljs-string">`storm:"unique"`</span>
  Name      <span class="hljs-type">string</span>
  CreatedAt time.Time <span class="hljs-string">`storm:"index"`</span>
}
</code></pre>
<h3>Lưu đối tượng của bạn</h3>
<pre><code class="language-go hljs">user := User{
  ID: <span class="hljs-number">10</span>,
  Group: <span class="hljs-string">"staff"</span>,
  Email: <span class="hljs-string">"john@provider.com"</span>,
  Name: <span class="hljs-string">"John"</span>,
  Age: <span class="hljs-number">21</span>,
  CreatedAt: time.Now(),
}

err := db.Save(&amp;user)
<span class="hljs-comment">// err == nil</span>

user.ID++
err = db.Save(&amp;user)
<span class="hljs-comment">// err == storm.ErrAlreadyExists</span>
</code></pre>
<p>Chỉ như vậy thôi.</p>
<p><code>Save</code> sẽ tạo hoặc cập nhật tất cả chỉ mục và bucket cần thiết, kiểm tra ràng buộc duy nhất và lưu đối tượng vào kho lưu trữ.</p>
<h4>Tự động tăng</h4>
<p>Storm có thể tự động tăng giá trị số nguyên nên bạn không cần lo lắng về việc này khi lưu đối tượng. Ngoài ra, giá trị mới cũng sẽ được tự động chèn vào trường của bạn.</p>
<pre><code class="language-go hljs">
<span class="hljs-keyword">type</span> Product <span class="hljs-keyword">struct</span> {
  Pk                  <span class="hljs-type">int</span> <span class="hljs-string">`storm:"id,increment"`</span> <span class="hljs-comment">// khoá chính với tự động tăng</span>
  Name                <span class="hljs-type">string</span>
  IntegerField        <span class="hljs-type">uint64</span> <span class="hljs-string">`storm:"increment"`</span>
  IndexedIntegerField <span class="hljs-type">uint32</span> <span class="hljs-string">`storm:"index,increment"`</span>
  UniqueIntegerField  <span class="hljs-type">int16</span>  <span class="hljs-string">`storm:"unique,increment=100"`</span> <span class="hljs-comment">// có thể đặt giá trị bắt đầu</span>
}

p := Product{Name: <span class="hljs-string">"Vaccum Cleaner"</span>}

fmt.Println(p.Pk)
fmt.Println(p.IntegerField)
fmt.Println(p.IndexedIntegerField)
fmt.Println(p.UniqueIntegerField)
<span class="hljs-comment">// 0</span>
<span class="hljs-comment">// 0</span>
<span class="hljs-comment">// 0</span>
<span class="hljs-comment">// 0</span>

_ = db.Save(&amp;p)

fmt.Println(p.Pk)
fmt.Println(p.IntegerField)
fmt.Println(p.IndexedIntegerField)
fmt.Println(p.UniqueIntegerField)
<span class="hljs-comment">// 1</span>
<span class="hljs-comment">// 1</span>
<span class="hljs-comment">// 1</span>
<span class="hljs-comment">// 100</span>
</code></pre>
<h3>Truy vấn đơn giản</h3>
<p>Bất kỳ đối tượng nào cũng có thể được truy xuất, có chỉ mục hoặc không. Storm sẽ sử dụng chỉ mục khi có, nếu không sẽ sử dụng <a href="#advanced-queries">hệ thống truy vấn</a>.</p>
<h4>Truy xuất một đối tượng</h4>
<pre><code class="language-go hljs"><span class="hljs-keyword">var</span> user User
err := db.One(<span class="hljs-string">"Email"</span>, <span class="hljs-string">"john@provider.com"</span>, &amp;user)
<span class="hljs-comment">// err == nil</span>

err = db.One(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"John"</span>, &amp;user)
<span class="hljs-comment">// err == nil</span>

err = db.One(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"Jack"</span>, &amp;user)
<span class="hljs-comment">// err == storm.ErrNotFound</span>
</code></pre>
<h4>Truy xuất nhiều đối tượng</h4>
<pre><code class="language-go hljs"><span class="hljs-keyword">var</span> users []User
err := db.Find(<span class="hljs-string">"Group"</span>, <span class="hljs-string">"staff"</span>, &amp;users)
</code></pre>
<h4>Lấy tất cả đối tượng</h4>
<pre><code class="language-go hljs"><span class="hljs-keyword">var</span> users []User
err := db.All(&amp;users)
</code></pre>
<h4>Lấy tất cả đối tượng và sắp xếp theo chỉ mục</h4>
<pre><code class="language-go hljs"><span class="hljs-keyword">var</span> users []User
err := db.AllByIndex(<span class="hljs-string">"CreatedAt"</span>, &amp;users)
</code></pre>
<h4>Lấy một dải đối tượng</h4>
<pre><code class="language-go hljs"><span class="hljs-keyword">var</span> users []User
err := db.Range(<span class="hljs-string">"Age"</span>, <span class="hljs-number">10</span>, <span class="hljs-number">21</span>, &amp;users)
</code></pre>
<h4>Lấy đối tượng theo tiền tố</h4>
<pre><code class="language-go hljs"><span class="hljs-keyword">var</span> users []User
err := db.Prefix(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"Jo"</span>, &amp;users)
</code></pre>
<h4>Bỏ qua, Giới hạn và Đảo ngược</h4>
<pre><code class="language-go hljs"><span class="hljs-keyword">var</span> users []User
err := db.Find(<span class="hljs-string">"Group"</span>, <span class="hljs-string">"staff"</span>, &amp;users, storm.Skip(<span class="hljs-number">10</span>))
err = db.Find(<span class="hljs-string">"Group"</span>, <span class="hljs-string">"staff"</span>, &amp;users, storm.Limit(<span class="hljs-number">10</span>))
err = db.Find(<span class="hljs-string">"Group"</span>, <span class="hljs-string">"staff"</span>, &amp;users, storm.Reverse())
err = db.Find(<span class="hljs-string">"Group"</span>, <span class="hljs-string">"staff"</span>, &amp;users, storm.Limit(<span class="hljs-number">10</span>), storm.Skip(<span class="hljs-number">10</span>), storm.Reverse())

err = db.All(&amp;users, storm.Limit(<span class="hljs-number">10</span>), storm.Skip(<span class="hljs-number">10</span>), storm.Reverse())
err = db.AllByIndex(<span class="hljs-string">"CreatedAt"</span>, &amp;users, storm.Limit(<span class="hljs-number">10</span>), storm.Skip(<span class="hljs-number">10</span>), storm.Reverse())
err = db.Range(<span class="hljs-string">"Age"</span>, <span class="hljs-number">10</span>, <span class="hljs-number">21</span>, &amp;users, storm.Limit(<span class="hljs-number">10</span>), storm.Skip(<span class="hljs-number">10</span>), storm.Reverse())
</code></pre>
<h4>Xóa một đối tượng</h4>
<pre><code class="language-go hljs">err := db.DeleteStruct(&amp;user)
</code></pre>
<h4>Cập nhật một đối tượng</h4>
<pre><code class="language-go hljs"><span class="hljs-comment">// Cập nhật nhiều trường</span>
<span class="hljs-comment">// Chỉ hoạt động với trường có giá trị khác zero (ví dụ: Name không được là "", Age không được là 0)</span>
err := db.Update(&amp;User{ID: <span class="hljs-number">10</span>, Name: <span class="hljs-string">"Jack"</span>, Age: <span class="hljs-number">45</span>})

<span class="hljs-comment">// Cập nhật một trường đơn lẻ</span>
<span class="hljs-comment">// Cũng hoạt động với các giá trị zero (0, false, "", ...)</span>
err := db.UpdateField(&amp;User{ID: <span class="hljs-number">10</span>}, <span class="hljs-string">"Age"</span>, <span class="hljs-number">0</span>)
</code></pre>
<h4>Khởi tạo buckets và indexes trước khi lưu đối tượng</h4>
<pre><code class="language-go hljs">err := db.Init(&amp;User{})
</code></pre>
<p>Hữu ích khi bắt đầu ứng dụng của bạn</p>
<h4>Xóa một bucket</h4>
<p>Dùng struct</p>
<pre><code class="language-go hljs">err := db.Drop(&amp;User)
</code></pre>
<p>Dùng tên bucket</p>
<pre><code class="language-go hljs">err := db.Drop(<span class="hljs-string">"User"</span>)
</code></pre>
<h4>Lập chỉ mục lại một bucket</h4>
<pre><code class="language-go hljs">err := db.ReIndex(&amp;User{})
</code></pre>
<p>Hữu ích khi cấu trúc đã thay đổi</p>
<h3>Truy vấn nâng cao</h3>
<p>Đối với các truy vấn phức tạp hơn, bạn có thể sử dụng phương thức <code>Select</code>.<br><code>Select</code> nhận vào bất kỳ số lượng <a href="https://godoc.org/github.com/asdine/storm/q#Matcher"><code>Matcher</code></a> nào từ gói <a href="https://godoc.org/github.com/asdine/storm/q"><code>q</code></a>.</p>
<p>Dưới đây là một số Matcher phổ biến:</p>
<pre><code class="language-go hljs"><span class="hljs-comment">// So sánh bằng</span>
q.Eq(<span class="hljs-string">"Name"</span>, John)

<span class="hljs-comment">// Lớn hơn một cách nghiêm ngặt</span>
q.Gt(<span class="hljs-string">"Age"</span>, <span class="hljs-number">7</span>)

<span class="hljs-comment">// Nhỏ hơn hoặc bằng</span>
q.Lte(<span class="hljs-string">"Age"</span>, <span class="hljs-number">77</span>)

<span class="hljs-comment">// Regex với tên bắt đầu bằng chữ D</span>
q.Re(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"^D"</span>)

<span class="hljs-comment">// Trong danh sách giá trị cho trước</span>
q.In(<span class="hljs-string">"Group"</span>, []<span class="hljs-type">string</span>{<span class="hljs-string">"Staff"</span>, <span class="hljs-string">"Admin"</span>})

<span class="hljs-comment">// So sánh các trường</span>
q.EqF(<span class="hljs-string">"FieldName"</span>, <span class="hljs-string">"SecondFieldName"</span>)
q.LtF(<span class="hljs-string">"FieldName"</span>, <span class="hljs-string">"SecondFieldName"</span>)
q.GtF(<span class="hljs-string">"FieldName"</span>, <span class="hljs-string">"SecondFieldName"</span>)
q.LteF(<span class="hljs-string">"FieldName"</span>, <span class="hljs-string">"SecondFieldName"</span>)
q.GteF(<span class="hljs-string">"FieldName"</span>, <span class="hljs-string">"SecondFieldName"</span>)
</code></pre>
<p>Matcher cũng có thể kết hợp với <code>And</code>, <code>Or</code> và <code>Not</code>:</p>
<pre><code class="language-go hljs">
<span class="hljs-comment">// Khớp nếu tất cả đều khớp</span>
q.And(
  q.Gt(<span class="hljs-string">"Age"</span>, <span class="hljs-number">7</span>),
  q.Re(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"^D"</span>)
)

<span class="hljs-comment">// Khớp nếu một trong các điều kiện khớp</span>
q.Or(
  q.Re(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"^A"</span>),
  q.Not(
    q.Re(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"^B"</span>)
  ),
  q.Re(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"^C"</span>),
  q.In(<span class="hljs-string">"Group"</span>, []<span class="hljs-type">string</span>{<span class="hljs-string">"Staff"</span>, <span class="hljs-string">"Admin"</span>}),
  q.And(
    q.StrictEq(<span class="hljs-string">"Password"</span>, []<span class="hljs-type">byte</span>(password)),
    q.Eq(<span class="hljs-string">"Registered"</span>, <span class="hljs-literal">true</span>)
  )
)
</code></pre>
<p>Bạn có thể tìm danh sách đầy đủ trong <a href="https://godoc.org/github.com/asdine/storm/q#Matcher">tài liệu</a>.</p>
<p><code>Select</code> nhận bất kỳ số lượng matcher nào và tự động bọc chúng trong một <code>q.And()</code>, vì vậy không cần chỉ định rõ. Nó trả về kiểu <a href="https://godoc.org/github.com/asdine/storm#Query"><code>Query</code></a>.</p>
<pre><code class="language-go hljs">query := db.Select(q.Gte(<span class="hljs-string">"Age"</span>, <span class="hljs-number">7</span>), q.Lte(<span class="hljs-string">"Age"</span>, <span class="hljs-number">77</span>))
</code></pre>
<p>Kiểu <code>Query</code> chứa các phương thức để lọc và sắp xếp bản ghi.</p>
<pre><code class="language-go hljs"><span class="hljs-comment">// Giới hạn</span>
query = query.Limit(<span class="hljs-number">10</span>)

<span class="hljs-comment">// Bỏ qua</span>
query = query.Skip(<span class="hljs-number">20</span>)

<span class="hljs-comment">// Các lời gọi cũng có thể kết hợp chuỗi</span>
query = query.Limit(<span class="hljs-number">10</span>).Skip(<span class="hljs-number">20</span>).OrderBy(<span class="hljs-string">"Age"</span>).Reverse()
</code></pre>
<p>Ngoài ra còn để chỉ định cách lấy dữ liệu.</p>
<pre><code class="language-go hljs"><span class="hljs-keyword">var</span> users []User
err = query.Find(&amp;users)

<span class="hljs-keyword">var</span> user User
err = query.First(&amp;user)
</code></pre>
<p>Ví dụ với <code>Select</code>:</p>
<pre><code class="language-go hljs"><span class="hljs-comment">// Tìm tất cả người dùng có ID từ 10 đến 100</span>
err = db.Select(q.Gte(<span class="hljs-string">"ID"</span>, <span class="hljs-number">10</span>), q.Lte(<span class="hljs-string">"ID"</span>, <span class="hljs-number">100</span>)).Find(&amp;users)

<span class="hljs-comment">// Matcher lồng nhau</span>
err = db.Select(q.Or(
  q.Gt(<span class="hljs-string">"ID"</span>, <span class="hljs-number">50</span>),
  q.Lt(<span class="hljs-string">"Age"</span>, <span class="hljs-number">21</span>),
  q.And(
    q.Eq(<span class="hljs-string">"Group"</span>, <span class="hljs-string">"admin"</span>),
    q.Gte(<span class="hljs-string">"Age"</span>, <span class="hljs-number">21</span>),
  ),
)).Find(&amp;users)

query := db.Select(q.Gte(<span class="hljs-string">"ID"</span>, <span class="hljs-number">10</span>), q.Lte(<span class="hljs-string">"ID"</span>, <span class="hljs-number">100</span>)).Limit(<span class="hljs-number">10</span>).Skip(<span class="hljs-number">5</span>).Reverse().OrderBy(<span class="hljs-string">"Age"</span>, <span class="hljs-string">"Name"</span>)

<span class="hljs-comment">// Tìm nhiều bản ghi</span>
err = query.Find(&amp;users)
<span class="hljs-comment">// hoặc</span>
err = db.Select(q.Gte(<span class="hljs-string">"ID"</span>, <span class="hljs-number">10</span>), q.Lte(<span class="hljs-string">"ID"</span>, <span class="hljs-number">100</span>)).Limit(<span class="hljs-number">10</span>).Skip(<span class="hljs-number">5</span>).Reverse().OrderBy(<span class="hljs-string">"Age"</span>, <span class="hljs-string">"Name"</span>).Find(&amp;users)
</code></pre>
<p>// Tìm bản ghi đầu tiên<br>err = query.First(&amp;user)<br>// hoặc<br>err = db.Select(q.Gte("ID", 10), q.Lte("ID", 100)).Limit(10).Skip(5).Reverse().OrderBy("Age", "Name").First(&amp;user)</p>
<p>// Xóa tất cả các bản ghi phù hợp<br>err = query.Delete(new(User))</p>
<p>// Lấy từng bản ghi một (hữu ích khi bucket chứa nhiều bản ghi)<br>query = db.Select(q.Gte("ID", 10),q.Lte("ID", 100)).OrderBy("Age", "Name")</p>
<p>err = query.Each(new(User), func(record interface{}) error) {<br>  u := record.(*User)<br>  ...<br>  return nil<br>}</p>
<pre><code class="hljs language-kotlin">
Xem [tài liệu](https:<span class="hljs-comment">//godoc.org/github.com/asdine/storm#Query) để biết danh sách đầy đủ các phương thức.</span>

### Giao dịch (Transactions)

```go
tx, err := db.Begin(<span class="hljs-literal">true</span>)
<span class="hljs-keyword">if</span> err != nil {
  <span class="hljs-keyword">return</span> err
}
defer tx.Rollback()

accountA.Amount -= <span class="hljs-number">100</span>
accountB.Amount += <span class="hljs-number">100</span>

err = tx.Save(accountA)
<span class="hljs-keyword">if</span> err != nil {
  <span class="hljs-keyword">return</span> err
}

err = tx.Save(accountB)
<span class="hljs-keyword">if</span> err != nil {
  <span class="hljs-keyword">return</span> err
}

<span class="hljs-keyword">return</span> tx.Commit()
</code></pre>
<h3>Tùy chọn (Options)</h3>
<p>Các tùy chọn của Storm là các hàm có thể được truyền vào khi khởi tạo instance Storm của bạn. Bạn có thể truyền vào bất kỳ số lượng tùy chọn nào.</p>
<h4>BoltOptions</h4>
<p>Theo mặc định, Storm mở database với chế độ <code>0600</code> và timeout là một giây.<br>Bạn có thể thay đổi hành vi này bằng cách sử dụng <code>BoltOptions</code></p>
<pre><code class="language-go hljs">db, err := storm.Open(<span class="hljs-string">"my.db"</span>, storm.BoltOptions(<span class="hljs-number">0600</span>, &amp;bolt.Options{Timeout: <span class="hljs-number">1</span> * time.Second}))
</code></pre>
<h4>MarshalUnmarshaler</h4>
<p>Để lưu trữ dữ liệu trong BoltDB, Storm mặc định sẽ marshal nó thành JSON. Nếu bạn muốn thay đổi hành vi này, bạn có thể truyền vào một codec thực hiện <a href="https://godoc.org/github.com/asdine/storm/codec#MarshalUnmarshaler"><code>codec.MarshalUnmarshaler</code></a> thông qua tùy chọn <a href="https://godoc.org/github.com/asdine/storm#Codec"><code>storm.Codec</code></a>:</p>
<pre><code class="language-go hljs">db := storm.Open(<span class="hljs-string">"my.db"</span>, storm.Codec(myCodec))
</code></pre>
<h5>Các Codec được cung cấp sẵn</h5>
<p>Bạn có thể dễ dàng tự triển khai <code>MarshalUnmarshaler</code>, nhưng Storm đi kèm hỗ trợ sẵn cho <a href="https://godoc.org/github.com/asdine/storm/codec/json">JSON</a> (mặc định), <a href="https://godoc.org/github.com/asdine/storm/codec/gob">GOB</a>,  <a href="https://godoc.org/github.com/asdine/storm/codec/sereal">Sereal</a>, <a href="https://godoc.org/github.com/asdine/storm/codec/protobuf">Protocol Buffers</a> và <a href="https://godoc.org/github.com/asdine/storm/codec/msgpack">MessagePack</a>.</p>
<p>Bạn có thể sử dụng bằng cách import package tương ứng và dùng codec đó để cấu hình Storm. Ví dụ dưới đây cho thấy tất cả các biến thể (không xử lý lỗi):</p>
<pre><code class="language-go hljs"><span class="hljs-keyword">import</span> (
  <span class="hljs-string">"github.com/asdine/storm/v3"</span>
  <span class="hljs-string">"github.com/asdine/storm/v3/codec/gob"</span>
  <span class="hljs-string">"github.com/asdine/storm/v3/codec/json"</span>
  <span class="hljs-string">"github.com/asdine/storm/v3/codec/sereal"</span>
  <span class="hljs-string">"github.com/asdine/storm/v3/codec/protobuf"</span>
  <span class="hljs-string">"github.com/asdine/storm/v3/codec/msgpack"</span>
)

<span class="hljs-keyword">var</span> gobDb, _ = storm.Open(<span class="hljs-string">"gob.db"</span>, storm.Codec(gob.Codec))
<span class="hljs-keyword">var</span> jsonDb, _ = storm.Open(<span class="hljs-string">"json.db"</span>, storm.Codec(json.Codec))
<span class="hljs-keyword">var</span> serealDb, _ = storm.Open(<span class="hljs-string">"sereal.db"</span>, storm.Codec(sereal.Codec))
<span class="hljs-keyword">var</span> protobufDb, _ = storm.Open(<span class="hljs-string">"protobuf.db"</span>, storm.Codec(protobuf.Codec))
<span class="hljs-keyword">var</span> msgpackDb, _ = storm.Open(<span class="hljs-string">"msgpack.db"</span>, storm.Codec(msgpack.Codec))
</code></pre>
<p><strong>Mẹo</strong>: Thêm tag Storm vào file Protobuf sinh tự động có thể khó khăn. Một giải pháp tốt là sử dụng <a href="https://github.com/favadi/protoc-go-inject-tag">công cụ này</a> để chèn tag trong quá trình biên dịch.</p>
<h4>Sử dụng kết nối Bolt có sẵn</h4>
<p>Bạn có thể sử dụng một kết nối đã có và truyền nó vào Storm</p>
<pre><code class="language-go hljs">bDB, _ := bolt.Open(filepath.Join(dir, <span class="hljs-string">"bolt.db"</span>), <span class="hljs-number">0600</span>, &amp;bolt.Options{Timeout: <span class="hljs-number">10</span> * time.Second})
db := storm.Open(<span class="hljs-string">"my.db"</span>, storm.UseDB(bDB))
</code></pre>
<h4>Chế độ batch</h4>
<p>Chế độ batch có thể được bật để tăng tốc ghi đồng thời (xem <a href="https://github.com/coreos/bbolt#batch-read-write-transactions">Batch read-write transactions</a>)</p>
<pre><code class="language-go hljs">db := storm.Open(<span class="hljs-string">"my.db"</span>, storm.Batch())
</code></pre>
<h2>Node và bucket lồng nhau</h2>
<p>Storm tận dụng tính năng bucket lồng nhau của BoltDB bằng cách sử dụng <code>storm.Node</code>.<br>Một <code>storm.Node</code> là đối tượng nền được <code>storm.DB</code> sử dụng để thao tác với một bucket.<br>Để tạo một bucket lồng nhau và sử dụng cùng API như <code>storm.DB</code>, bạn có thể dùng phương thức <code>DB.From</code>.</p>
<pre><code class="language-go hljs">repo := db.From(<span class="hljs-string">"repo"</span>)

err := repo.Save(&amp;Issue{
  Title: <span class="hljs-string">"I want more features"</span>,
  Author: user.ID,
})

err = repo.Save(newRelease(<span class="hljs-string">"0.10"</span>))

<span class="hljs-keyword">var</span> issues []Issue
err = repo.Find(<span class="hljs-string">"Author"</span>, user.ID, &amp;issues)

<span class="hljs-keyword">var</span> release Release
err = repo.One(<span class="hljs-string">"Tag"</span>, <span class="hljs-string">"0.10"</span>, &amp;release)
</code></pre>
<p>Bạn cũng có thể nối chuỗi các node để tạo thành một cấu trúc phân cấp</p>
<pre><code class="language-go hljs">chars := db.From(<span class="hljs-string">"characters"</span>)
heroes := chars.From(<span class="hljs-string">"heroes"</span>)
enemies := chars.From(<span class="hljs-string">"enemies"</span>)

items := db.From(<span class="hljs-string">"items"</span>)
potions := items.From(<span class="hljs-string">"consumables"</span>).From(<span class="hljs-string">"medicine"</span>).From(<span class="hljs-string">"potions"</span>)
</code></pre>
<p>Bạn thậm chí có thể truyền toàn bộ cấu trúc phân cấp làm đối số cho <code>From</code>:</p>
<pre><code class="language-go hljs">privateNotes := db.From(<span class="hljs-string">"notes"</span>, <span class="hljs-string">"private"</span>)
workNotes :=  db.From(<span class="hljs-string">"notes"</span>, <span class="hljs-string">"work"</span>)
</code></pre>
<h3>Tùy chọn cho Node</h3>
<p>Một Node cũng có thể được cấu hình. Kích hoạt một tùy chọn trên Node sẽ tạo ra một bản sao, do đó Node luôn an toàn cho đa luồng.</p>
<pre><code class="language-go hljs">n := db.From(<span class="hljs-string">"my-node"</span>)
</code></pre>
<p>Truyền một giao dịch bolt.Tx cho Node</p>
<pre><code class="language-go hljs">n = n.WithTransaction(tx)
</code></pre>
<p>Bật chế độ batch</p>
<pre><code class="language-go hljs">n = n.WithBatch(<span class="hljs-literal">true</span>)
</code></pre>
<p>Sử dụng một Codec</p>
<pre><code class="language-go hljs">n = n.WithCodec(gob.Codec)
</code></pre>
<h2>Lưu trữ Key/Value đơn giản</h2>
<p>Storm có thể được sử dụng như một kho key/value đơn giản, mạnh mẽ, có thể lưu trữ bất cứ thứ gì.<br>Key và value có thể thuộc bất kỳ kiểu nào miễn là key không phải là giá trị zero.</p>
<p>Lưu dữ liệu :</p>
<pre><code class="language-go hljs">db.Set(<span class="hljs-string">"logs"</span>, time.Now(), <span class="hljs-string">"I'm eating my breakfast man"</span>)
db.Set(<span class="hljs-string">"sessions"</span>, bson.NewObjectId(), &amp;someUser)
db.Set(<span class="hljs-string">"weird storage"</span>, <span class="hljs-string">"754-3010"</span>, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
  <span class="hljs-string">"hair"</span>: <span class="hljs-string">"blonde"</span>,
  <span class="hljs-string">"likes"</span>: []<span class="hljs-type">string</span>{<span class="hljs-string">"cheese"</span>, <span class="hljs-string">"star wars"</span>},
})
</code></pre>
<p>Lấy dữ liệu :</p>
<pre><code class="language-go hljs">user := User{}
db.Get(<span class="hljs-string">"sessions"</span>, someObjectId, &amp;user)

<span class="hljs-keyword">var</span> details <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}
db.Get(<span class="hljs-string">"weird storage"</span>, <span class="hljs-string">"754-3010"</span>, &amp;details)
</code></pre>
<p>db.Get("sessions", someObjectId, &amp;details)</p>
<pre><code class="hljs language-css">
Xó<span class="hljs-selector-tag">a</span> dữ <span class="hljs-selector-tag">li</span>ệu :

```go
db.<span class="hljs-built_in">Delete</span>(<span class="hljs-string">"sessions"</span>, someObjectId)
db.<span class="hljs-built_in">Delete</span>(<span class="hljs-string">"weird storage"</span>, <span class="hljs-string">"754-3010"</span>)
</code></pre>
<p>Bạn có thể tìm thấy các phương thức hữu ích khác trong <a href="https://godoc.org/github.com/asdine/storm#KeyValueStore">tài liệu hướng dẫn</a>.</p>
<h2>BoltDB</h2>
<p>BoltDB vẫn có thể truy cập dễ dàng và có thể sử dụng như thông thường</p>
<pre><code class="language-go hljs">db.Bolt.View(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(tx *bolt.Tx)</span></span> <span class="hljs-type">error</span> {
  bucket := tx.Bucket([]<span class="hljs-type">byte</span>(<span class="hljs-string">"my bucket"</span>))
  val := bucket.Get([]<span class="hljs-type">byte</span>(<span class="hljs-string">"any id"</span>))
  fmt.Println(<span class="hljs-type">string</span>(val))
  <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
})
</code></pre>
<p>Một giao dịch cũng có thể được truyền vào cho Storm</p>
<pre><code class="language-go hljs">db.Bolt.Update(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(tx *bolt.Tx)</span></span> <span class="hljs-type">error</span> {
  ...
  dbx := db.WithTransaction(tx)
  err = dbx.Save(&amp;user)
  ...
  <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
})
</code></pre>
<h2>Giấy phép</h2>
<p>MIT</p>
<h2>Công nhận</h2>
<ul>
<li><a href="https://github.com/asdine">Asdine El Hrychy</a></li>
<li><a href="https://github.com/bep">Bjørn Erik Pedersen</a></li>
</ul>
<hr>
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-06-11</p>
<hr>
</div>
    </div>

    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async=""></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
    


</body></html>