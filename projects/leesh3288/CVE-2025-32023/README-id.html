<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE-2025-32023 - leesh3288/CVE-2025-32023 id</title>
    <meta name="title" content="CVE-2025-32023 - leesh3288/CVE-2025-32023 id | CVE-2025-32023 PoC &amp; Eksploitasi untuk CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduksi / Patch Diuji pada redis:7.4.2-al...">
    <meta name="description" content="leesh3288/CVE-2025-32023 - GitHub repository id documentation and information | CVE-2025-32023 PoC &amp; Eksploitasi untuk CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduksi / Patch Diuji pada redis:7.4.2-al...">
    <meta name="keywords" content="leesh3288, CVE-2025-32023, GitHub, repository, id documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/leesh3288/CVE-2025-32023/README-id.html">
    <meta property="og:title" content="CVE-2025-32023 - leesh3288/CVE-2025-32023 id | CVE-2025-32023 PoC &amp; Eksploitasi untuk CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduksi / Patch Diuji pada redis:7.4.2-al...">
    <meta property="og:description" content="leesh3288/CVE-2025-32023 - GitHub repository id documentation and information | CVE-2025-32023 PoC &amp; Eksploitasi untuk CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduksi / Patch Diuji pada redis:7.4.2-al...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div style="position: fixed; top: 2px; left: 2px; z-index: 2000; background: rgba(255,255,255,0.95); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 4px 14px; font-size: 15px; color: #222; font-family: 'Segoe UI', Arial, sans-serif; font-weight: 500; letter-spacing: 0.5px;">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: 600;">Open AI Tx</a>
    </div>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/leesh3288/CVE-2025-32023" id="githubRepoLink" target="_blank">leesh3288/CVE-2025-32023</a>
<h1 style="display: none;">CVE-2025-32023 PoC &amp; Eksploitasi untuk CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduksi / Patch Diuji pada redis:7.4.2-al...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>CVE-2025-32023</h1>
<p>PoC &amp; Eksploitasi untuk CVE-2025-32023 (<a href="https://github.com/redis/redis/security/advisories/GHSA-rp2m-q4j6-gr43">GHSA-rp2m-q4j6-gr43</a>) / PlaidCTF 2025 &quot;Zerodeo&quot;</p>
<h3>Reproduksi / Patch</h3>
<p>Diuji pada <code>redis:7.4.2-alpine3.21@sha256:02419de7eddf55aa5bcf49efb74e88fa8d931b4d77c07eff8a6b2144472b6952</code></p>
<p>Mempengaruhi Redis versi &gt;= 2.8. Sudah ditambal di 8.0.3, 7.4.5, 7.2.10, 6.2.19, lihat <a href="https://github.com/redis/redis/commit/50188747cbfe43528d2719399a2a3c9599169445">redis/redis@5018874</a>.</p>
<h3>Bug</h3>
<p>HyperLogLog di Redis hanyalah string lain dengan encoding khusus. Iterasi pada encoding HLL sparse membutuhkan penjumlahan panjang run dari setiap representasi sparse, yang dapat menyebabkan overflow pada total panjang yang dihitung di <code>int i</code> menjadi nilai negatif ketika dijalankan pada HLL yang rusak. Ini memungkinkan penyerang untuk menimpa offset negatif pada struktur HLL, yang dapat menyebabkan penulisan di luar batas pada stack/heap tergantung dari mana struktur HLL tersebut berasal (misal, <code>hllMerge()</code> menggunakan alokasi stack, <code>hllSparseToDense()</code> menggunakan alokasi heap).</p>
<p>Lihat cuplikan patch di bawah ini:</p>
<pre><code class="language-diff"> int hllMerge(uint8_t *max, robj *hll) {
     struct hllhdr *hdr = hll-&gt;ptr;
     int i;

     if (hdr-&gt;encoding == HLL_DENSE) {
         hllMergeDense(max, hdr-&gt;registers);
      } else {
         uint8_t *p = hll-&gt;ptr, *end = p + sdslen(hll-&gt;ptr);
         long runlen, regval;
+        int valid = 1;
 
         p += HLL_HDR_SIZE;
         i = 0;
         while(p &lt; end) {
             if (HLL_SPARSE_IS_ZERO(p)) {
                 runlen = HLL_SPARSE_ZERO_LEN(p);
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 i += runlen;
                 p++;
             } else if (HLL_SPARSE_IS_XZERO(p)) {
                 runlen = HLL_SPARSE_XZERO_LEN(p);
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 i += runlen;
                 p += 2;
             } else {
                 runlen = HLL_SPARSE_VAL_LEN(p);
                 regval = HLL_SPARSE_VAL_VALUE(p);
-                if ((runlen + i) &gt; HLL_REGISTERS) break; /* Overflow. */
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 while(runlen--) {
                     if (regval &gt; max[i]) max[i] = regval;
                     i++;
                }
                 p++;
             }
         }
-        if (i != HLL_REGISTERS) return C_ERR;
+        if (!valid || i != HLL_REGISTERS) return C_ERR;
     }
     return C_OK;
 }
</code></pre>
<h3>Eksploitasi</h3>
<p>Eksploitasi adalah pwnables Redis standar:</p>
<ol>
<li>Merusak objek sds pada jemalloc heap untuk membuat panjangnya menjadi besar</li>
<li>Melakukan spray objek embstr untuk dirusak menjadi objek modul palsu</li>
<li>Membuang heap menggunakan objek sds yang telah rusak untuk menemukan objek embstr target &amp; membocorkan alamat</li>
<li>Membuat objek modul palsu pada objek embstr target</li>
<li>Menghapus objek modul palsu, memicu destruktor &amp; mendapatkan RCE</li>
</ol>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-07-09</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>