<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE-2025-32023 - leesh3288/CVE-2025-32023 es</title>
    <meta name="title" content="CVE-2025-32023 - leesh3288/CVE-2025-32023 es | CVE-2025-32023 PoC y Exploit para CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Repro / Parche Probado en redis:7.4.2-alpine3.21@sha2...">
    <meta name="description" content="leesh3288/CVE-2025-32023 - GitHub repository es documentation and information | CVE-2025-32023 PoC y Exploit para CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Repro / Parche Probado en redis:7.4.2-alpine3.21@sha2...">
    <meta name="keywords" content="leesh3288, CVE-2025-32023, GitHub, repository, es documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/leesh3288/CVE-2025-32023/README-es.html">
    <meta property="og:title" content="CVE-2025-32023 - leesh3288/CVE-2025-32023 es | CVE-2025-32023 PoC y Exploit para CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Repro / Parche Probado en redis:7.4.2-alpine3.21@sha2...">
    <meta property="og:description" content="leesh3288/CVE-2025-32023 - GitHub repository es documentation and information | CVE-2025-32023 PoC y Exploit para CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Repro / Parche Probado en redis:7.4.2-alpine3.21@sha2...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div style="position: fixed; top: 2px; left: 2px; z-index: 2000; background: rgba(255,255,255,0.95); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 4px 14px; font-size: 15px; color: #222; font-family: 'Segoe UI', Arial, sans-serif; font-weight: 500; letter-spacing: 0.5px;">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: 600;">Open AI Tx</a>
    </div>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/leesh3288/CVE-2025-32023" id="githubRepoLink" target="_blank">leesh3288/CVE-2025-32023</a>
<h1 style="display: none;">CVE-2025-32023 PoC y Exploit para CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Repro / Parche Probado en redis:7.4.2-alpine3.21@sha2...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>CVE-2025-32023</h1>
<p>PoC y Exploit para CVE-2025-32023 (<a href="https://github.com/redis/redis/security/advisories/GHSA-rp2m-q4j6-gr43">GHSA-rp2m-q4j6-gr43</a>) / PlaidCTF 2025 &quot;Zerodeo&quot;</p>
<h3>Repro / Parche</h3>
<p>Probado en <code>redis:7.4.2-alpine3.21@sha256:02419de7eddf55aa5bcf49efb74e88fa8d931b4d77c07eff8a6b2144472b6952</code></p>
<p>Afecta a las versiones de Redis &gt;= 2.8. Corregido en 8.0.3, 7.4.5, 7.2.10, 6.2.19, ver <a href="https://github.com/redis/redis/commit/50188747cbfe43528d2719399a2a3c9599169445">redis/redis@5018874</a>.</p>
<h3>Bug</h3>
<p>HyperLogLog en Redis es simplemente otra cadena de texto con sus propios codificadores personalizados. Iterar sobre una codificación HLL dispersa requiere sumar las longitudes de ejecución de cada representación dispersa, lo que puede desbordar el recuento total de longitud en <code>int i</code> a un valor negativo cuando se opera sobre un HLL malformado. Esto permite a un atacante sobrescribir en desplazamientos negativos en la estructura HLL, lo que conduce a escritura fuera de límites en la pila o el heap dependiendo de dónde provenga la estructura HLL (por ejemplo, <code>hllMerge()</code> toma una asignada en la pila, <code>hllSparseToDense()</code> toma una asignada en el heap).</p>
<p>Vea el fragmento del parche a continuación:</p>
<pre><code class="language-diff"> int hllMerge(uint8_t *max, robj *hll) {
     struct hllhdr *hdr = hll-&gt;ptr;
     int i;

     if (hdr-&gt;encoding == HLL_DENSE) {
         hllMergeDense(max, hdr-&gt;registers);
      } else {
         uint8_t *p = hll-&gt;ptr, *end = p + sdslen(hll-&gt;ptr);
         long runlen, regval;
+        int valid = 1;
 
         p += HLL_HDR_SIZE;
         i = 0;
         while(p &lt; end) {
             if (HLL_SPARSE_IS_ZERO(p)) {
                 runlen = HLL_SPARSE_ZERO_LEN(p);
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 i += runlen;
                 p++;
             } else if (HLL_SPARSE_IS_XZERO(p)) {
                 runlen = HLL_SPARSE_XZERO_LEN(p);
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 i += runlen;
                 p += 2;
             } else {
                 runlen = HLL_SPARSE_VAL_LEN(p);
                 regval = HLL_SPARSE_VAL_VALUE(p);
-                if ((runlen + i) &gt; HLL_REGISTERS) break; /* Overflow. */
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 while(runlen--) {
                     if (regval &gt; max[i]) max[i] = regval;
                     i++;
                }
                 p++;
             }
         }
-        if (i != HLL_REGISTERS) return C_ERR;
+        if (!valid || i != HLL_REGISTERS) return C_ERR;
     }
     return C_OK;
 }
</code></pre>
<h3>Exploit</h3>
<p>El exploit sigue el estándar de pwnables de Redis:</p>
<ol>
<li>Corromper un objeto sds en el heap de jemalloc para aumentar artificialmente su longitud</li>
<li>Rociar objetos embstr para corromper uno y convertirlo en un objeto módulo falso</li>
<li>Volcar el heap usando el objeto sds corrompido para encontrar el objeto embstr objetivo y filtrar direcciones</li>
<li>Crear un objeto módulo falso en el objeto embstr objetivo</li>
<li>Eliminar el objeto módulo falso, activando el destructor y obteniendo RCE</li>
</ol>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-07-09</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>