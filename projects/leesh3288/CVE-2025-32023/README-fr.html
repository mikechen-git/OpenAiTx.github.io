<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE-2025-32023 - leesh3288/CVE-2025-32023 fr</title>
    <meta name="title" content="CVE-2025-32023 - leesh3288/CVE-2025-32023 fr | CVE-2025-32023 PoC &amp; Exploit pour CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduction / Correctif Testé sur redis:7.4.2-al...">
    <meta name="description" content="leesh3288/CVE-2025-32023 - GitHub repository fr documentation and information | CVE-2025-32023 PoC &amp; Exploit pour CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduction / Correctif Testé sur redis:7.4.2-al...">
    <meta name="keywords" content="leesh3288, CVE-2025-32023, GitHub, repository, fr documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/leesh3288/CVE-2025-32023/README-fr.html">
    <meta property="og:title" content="CVE-2025-32023 - leesh3288/CVE-2025-32023 fr | CVE-2025-32023 PoC &amp; Exploit pour CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduction / Correctif Testé sur redis:7.4.2-al...">
    <meta property="og:description" content="leesh3288/CVE-2025-32023 - GitHub repository fr documentation and information | CVE-2025-32023 PoC &amp; Exploit pour CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduction / Correctif Testé sur redis:7.4.2-al...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div style="position: fixed; top: 2px; left: 2px; z-index: 2000; background: rgba(255,255,255,0.95); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 4px 14px; font-size: 15px; color: #222; font-family: 'Segoe UI', Arial, sans-serif; font-weight: 500; letter-spacing: 0.5px;">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: 600;">Open AI Tx</a>
    </div>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/leesh3288/CVE-2025-32023" id="githubRepoLink" target="_blank">leesh3288/CVE-2025-32023</a>
<h1 style="display: none;">CVE-2025-32023 PoC &amp; Exploit pour CVE-2025-32023 (GHSA-rp2m-q4j6-gr43) / PlaidCTF 2025 &quot;Zerodeo&quot; Reproduction / Correctif Testé sur redis:7.4.2-al...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>CVE-2025-32023</h1>
<p>PoC &amp; Exploit pour CVE-2025-32023 (<a href="https://github.com/redis/redis/security/advisories/GHSA-rp2m-q4j6-gr43">GHSA-rp2m-q4j6-gr43</a>) / PlaidCTF 2025 &quot;Zerodeo&quot;</p>
<h3>Reproduction / Correctif</h3>
<p>Testé sur <code>redis:7.4.2-alpine3.21@sha256:02419de7eddf55aa5bcf49efb74e88fa8d931b4d77c07eff8a6b2144472b6952</code></p>
<p>Affecte les versions de Redis &gt;= 2.8. Corrigé sur 8.0.3, 7.4.5, 7.2.10, 6.2.19, voir <a href="https://github.com/redis/redis/commit/50188747cbfe43528d2719399a2a3c9599169445">redis/redis@5018874</a>.</p>
<h3>Bug</h3>
<p>HyperLogLog dans Redis est simplement une autre chaîne avec ses propres encodages personnalisés. Parcourir un encodage HLL sparse nécessite d’additionner les longueurs de chaque représentation sparse, ce qui peut faire déborder la longueur totale comptée dans <code>int i</code> vers une valeur négative lorsqu’on opère sur un HLL mal formé. Cela permet à un attaquant d’écrire à des offsets négatifs dans la structure HLL, ce qui conduit à une écriture hors limites sur la pile/le tas selon la provenance de la structure HLL (par exemple, <code>hllMerge()</code> utilise une structure allouée sur la pile, <code>hllSparseToDense()</code> utilise une structure allouée sur le tas).</p>
<p>Voir l’extrait du correctif ci-dessous :</p>
<pre><code class="language-diff"> int hllMerge(uint8_t *max, robj *hll) {
     struct hllhdr *hdr = hll-&gt;ptr;
     int i;

     if (hdr-&gt;encoding == HLL_DENSE) {
         hllMergeDense(max, hdr-&gt;registers);
      } else {
         uint8_t *p = hll-&gt;ptr, *end = p + sdslen(hll-&gt;ptr);
         long runlen, regval;
+        int valid = 1;
 
         p += HLL_HDR_SIZE;
         i = 0;
         while(p &lt; end) {
             if (HLL_SPARSE_IS_ZERO(p)) {
                 runlen = HLL_SPARSE_ZERO_LEN(p);
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Dépassement. */
+                    valid = 0;
+                    break;
+                }
                 i += runlen;
                 p++;
             } else if (HLL_SPARSE_IS_XZERO(p)) {
                 runlen = HLL_SPARSE_XZERO_LEN(p);
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Dépassement. */
+                    valid = 0;
+                    break;
+                }
                 i += runlen;
                 p += 2;
             } else {
                 runlen = HLL_SPARSE_VAL_LEN(p);
                 regval = HLL_SPARSE_VAL_VALUE(p);
-                if ((runlen + i) &gt; HLL_REGISTERS) break; /* Dépassement. */
+                if ((runlen + i) &gt; HLL_REGISTERS) { /* Dépassement. */
+                    valid = 0;
+                    break;
+                }
                 while(runlen--) {
                     if (regval &gt; max[i]) max[i] = regval;
                     i++;
                }
                 p++;
             }
         }
-        if (i != HLL_REGISTERS) return C_ERR;
+        if (!valid || i != HLL_REGISTERS) return C_ERR;
     }
     return C_OK;
 }
</code></pre>
<h3>Exploit</h3>
<p>L’exploitation suit les méthodes classiques des pwnables Redis :</p>
<ol>
<li>Corrompre un objet sds sur le tas jemalloc pour augmenter sa longueur</li>
<li>Pulvériser des objets embstr pour corrompre en un faux objet module</li>
<li>Déverser le tas à l’aide de l’objet sds corrompu pour trouver l’objet embstr cible et divulguer des adresses</li>
<li>Créer un faux objet module sur l’objet embstr cible</li>
<li>Supprimer le faux objet module, déclenchant le destructeur et obtenant une exécution de code à distance (RCE)</li>
</ol>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-07-09</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>