<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>go-deploy - cklwblove/go-deploy</title>
    <meta name="title" content="go-deploy - cklwblove/go-deploy">
    <meta name="description" content="cklwblove/go-deploy - GitHub repository fa documentation and informationGo-Deploy 部署工具 یک ابزار استقرار خودکار مبتنی بر زبان Go که از طریق پروتکل SFTP امکان بارگذاری محصولات ساخته‌شده محلی به سرور راه دور را فراهم می‌کند. ویژگی‌های ...">
    <meta name="keywords" content="cklwblove, go-deploy, GitHub, repository, fa documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/cklwblove/go-deploy/README-fa.html">
    <meta property="og:title" content="go-deploy - cklwblove/go-deploy">
    <meta property="og:description" content="cklwblove/go-deploy - GitHub repository fa documentation and information">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/cklwblove/go-deploy" id="githubRepoLink" target="_blank">cklwblove/go-deploy</a>
<h1 style="display: none;">Go-Deploy 部署工具 یک ابزار استقرار خودکار مبتنی بر زبان Go که از طریق پروتکل SFTP امکان بارگذاری محصولات ساخته‌شده محلی به سرور راه دور را فراهم می‌کند. ویژگی‌های ...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>Go-Deploy 部署工具</h1>
<p>یک ابزار استقرار خودکار مبتنی بر زبان Go که از طریق پروتکل SFTP امکان بارگذاری محصولات ساخته‌شده محلی به سرور راه دور را فراهم می‌کند.</p>
<h2>ویژگی‌های اصلی</h2>
<ul>
<li>✅ <strong>انتقال ایمن</strong>: استفاده از پروتکل SFTP، انتقال رمزگذاری‌شده مبتنی بر SSH</li>
<li>✅ <strong>همگام‌سازی دایرکتوری</strong>: بارگذاری بازگشتی کل ساختار دایرکتوری، حفظ لایه‌بندی فایل‌ها</li>
<li>✅ <strong>ایجاد هوشمند</strong>: ایجاد خودکار ساختار دایرکتوری در سرور راه دور</li>
<li>✅ <strong>سازگاری مسیر</strong>: محاسبه خودکار مسیر محلی بر اساس محل فایل اجرایی، بدون نگرانی از مسیر اجرای برنامه</li>
<li>✅ <strong>پشتیبانی از فایل پیکربندی</strong>: پشتیبانی از فایل پیکربندی JSON، مدیریت آسان تنظیمات محیط‌های مختلف</li>
<li>✅ <strong>حذف فایل</strong>: پشتیبانی از الگوی wildcard برای حذف فایل‌های غیرضروری از بارگذاری</li>
<li>✅ <strong>پشتیبان‌گیری خودکار</strong>: امکان پشتیبان‌گیری خودکار از فایل‌های سرور قبل از بارگذاری</li>
<li>✅ <strong>مکانیزم تلاش مجدد</strong>: تلاش مجدد خودکار هنگام شکست بارگذاری، افزایش احتمال موفقیت</li>
<li>✅ <strong>آمار دقیق</strong>: نمایش تعداد فایل‌های بارگذاری‌شده، حجم انتقال، مدت زمان و سرعت</li>
<li>✅ <strong>نمایش پیشرفت</strong>: نمایش پیشرفت و اطلاعات فایل‌ها به صورت لحظه‌ای</li>
<li>✅ <strong>مدیریت خطا</strong>: مدیریت خطای کامل و خروجی لاگ مناسب</li>
</ul>
<h2>الزامات سیستم</h2>
<ul>
<li>Go نسخه 1.18 یا بالاتر</li>
<li>سرور هدف باید از پروتکل SSH/SFTP پشتیبانی کند</li>
</ul>
<h2>راهنمای نصب</h2>
<h3>1. کلون کردن پروژه</h3>
<pre><code class="language-bash">git clone &lt;your-repo-url&gt;
cd go-deploy
</code></pre>
<h3>2. مقداردهی اولیه ماژول Go</h3>
<pre><code class="language-bash">go mod init go-deploy
go mod tidy
</code></pre>
<h3>3. نصب وابستگی‌ها</h3>
<p>برنامه به طور خودکار وابستگی‌های زیر را دانلود خواهد کرد:</p>
<ul>
<li><code>github.com/pkg/sftp</code> - کلاینت SFTP</li>
<li><code>golang.org/x/crypto/ssh</code> - کلاینت SSH</li>
</ul>
<h2>راهنمای پیکربندی</h2>
<p>برنامه از دو روش پیکربندی پشتیبانی می‌کند:</p>
<h3>1. استفاده از فایل پیکربندی (توصیه‌شده)</h3>
<p>فایل <code>config.example.json</code> را به <code>config.json</code> کپی کرده و مقادیر آن را ویرایش نمایید:</p>
<pre><code class="language-bash">cp config.example.json config.json
</code></pre>
<p>سپس فایل <code>config.json</code> را ویرایش کنید:</p>
<pre><code class="language-json">{
  &quot;server&quot;: {
    &quot;host&quot;: &quot;your-server-ip&quot;,
    &quot;port&quot;: 22,
    &quot;username&quot;: &quot;your-username&quot;,
    &quot;password&quot;: &quot;your-password&quot;,
    &quot;timeout&quot;: 10
  },
  &quot;paths&quot;: {
    &quot;local&quot;: &quot;../../unpackage/dist/build/web&quot;,
    &quot;remote&quot;: &quot;/opt/your-path/dist&quot;
  },
  &quot;options&quot;: {
    &quot;backup&quot;: true,
    &quot;backup_suffix&quot;: &quot;.backup&quot;,
    &quot;exclude_patterns&quot;: [
      &quot;*.log&quot;,
      &quot;*.map&quot;,
      &quot;.DS_Store&quot;,
      &quot;node_modules&quot;
    ],
    &quot;max_retries&quot;: 3,
    &quot;chunk_size&quot;: 1048576
  }
}
</code></pre>
<h4>توضیح گزینه‌های پیکربندی</h4>
<p><strong>پیکربندی server:</strong></p>
<ul>
<li><code>host</code>: آدرس سرور SSH</li>
<li><code>port</code>: پورت SSH، معمولاً ۲۲</li>
<li><code>username</code>: نام کاربری SSH</li>
<li><code>password</code>: رمز عبور SSH (در محیط تولید پیشنهاد می‌شود از احراز هویت کلید استفاده شود)</li>
<li><code>timeout</code>: زمان انتظار اتصال (ثانیه)</li>
</ul>
<p><strong>پیکربندی paths:</strong></p>
<ul>
<li><code>local</code>: مسیر دایرکتوری محلی، پشتیبانی از مسیر نسبی و مطلق</li>
<li><code>remote</code>: مسیر دایرکتوری راه دور، باید مطلق باشد</li>
</ul>
<p><strong>پیکربندی options:</strong></p>
<ul>
<li><code>backup</code>: آیا قبل از بارگذاری از فایل‌های موجود در سرور پشتیبان تهیه شود یا خیر</li>
<li><code>backup_suffix</code>: پسوند فایل پشتیبان، قابل سفارشی‌سازی؛ اگر فایل پشتیبان وجود نداشته باشد، از این مرحله عبور می‌شود</li>
<li><code>exclude_patterns</code>: الگوی حذف فایل، پشتیبانی از wildcard</li>
<li><code>max_retries</code>: حداکثر تعداد تلاش مجدد هنگام شکست بارگذاری</li>
<li><code>chunk_size</code>: اندازه بلوک انتقال فایل (بایت، فعلاً پیاده‌سازی نشده)</li>
</ul>
<h3>2. پیکربندی پیش‌فرض (حالت سازگاری)</h3>
<p>اگر فایل <code>config.json</code> وجود نداشته باشد، برنامه از پیکربندی پیش‌فرض داخلی استفاده خواهد کرد و سازگاری به عقب را حفظ می‌کند.</p>
<h4>اولویت فایل پیکربندی</h4>
<ol>
<li><strong>فایل پیکربندی مشخص‌شده در خط فرمان</strong>: فایلی که با پارامتر <code>--config</code> مشخص می‌شود</li>
<li><strong>فایل پیکربندی پیش‌فرض</strong>: فایل <code>config.json</code> در دایرکتوری جاری</li>
<li><strong>پیکربندی پیش‌فرض داخلی</strong>: اگر هیچ‌کدام وجود نداشت، از تنظیمات داخلی برنامه استفاده می‌شود</li>
</ol>
<h4>قوانین پردازش مسیرها</h4>
<ul>
<li><strong>مسیر فایل پیکربندی:</strong>
<ul>
<li>مسیر نسبی: نسبت به دایرکتوری محل فایل اجرایی محاسبه می‌شود</li>
<li>مسیر مطلق: مستقیماً استفاده می‌شود</li>
</ul>
</li>
<li><strong>مسیر دایرکتوری محلی:</strong>
<ul>
<li>مسیر نسبی: نسبت به دایرکتوری محل فایل اجرایی محاسبه می‌شود</li>
<li>مسیر مطلق: مستقیماً استفاده می‌شود</li>
</ul>
</li>
</ul>
<h2>راهنمای اجرا</h2>
<h3>پارامترهای خط فرمان</h3>
<p>برنامه از پارامترهای زیر پشتیبانی می‌کند:</p>
<pre><code class="language-bash"># نمایش راهنما
./deploy --help

# نمایش نسخه  
./deploy --version

# استفاده از فایل پیکربندی پیش‌فرض config.json
./deploy

# استفاده از فایل پیکربندی مشخص‌شده
./deploy --config prod.json

# استفاده از فایل پیکربندی با مسیر مطلق
./deploy --config /path/to/config.json
</code></pre>
<h3>اجرای محیط توسعه</h3>
<pre><code class="language-bash"># استفاده از پیکربندی پیش‌فرض
go run main.go

# استفاده از فایل پیکربندی مشخص‌شده
go run main.go --config test.json

# نمایش راهنما
go run main.go --help
</code></pre>
<h3>اجرای برنامه پس از کامپایل</h3>
<pre><code class="language-bash"># کامپایل
go build -o deploy main.go

# اجرای برنامه با پیکربندی پیش‌فرض
./deploy

# اجرای برنامه با فایل پیکربندی مشخص‌شده
./deploy --config prod.json
</code></pre>
<h2>راهنمای بسته‌بندی</h2>
<h3>1. بسته‌بندی برای پلتفرم محلی</h3>
<pre><code class="language-bash"># کامپایل فایل اجرایی برای پلتفرم فعلی
go build -o deploy main.go
</code></pre>
<h3>2. بسته‌بندی چندسکویی</h3>
<h4>لینوکس ۶۴ بیتی</h4>
<pre><code class="language-bash">GOOS=linux GOARCH=amd64 go build -o deploy-linux-amd64 main.go
</code></pre>
<h4>ویندوز ۶۴ بیتی</h4>
<pre><code class="language-bash">GOOS=windows GOARCH=amd64 go build -o deploy-windows-amd64.exe main.go
</code></pre>
<h4>macOS نسخه ۶۴ بیتی</h4>
<pre><code class="language-bash">GOOS=darwin GOARCH=amd64 go build -o deploy-darwin-amd64 main.go
</code></pre>
<h4>macOS ARM64 (M1/M2)</h4>
<pre><code class="language-bash">GOOS=darwin GOARCH=arm64 go build -o deploy-darwin-arm64 main.go
</code></pre>
<h3>۳. بهینه‌سازی بسته‌بندی (کاهش حجم فایل)</h3>
<pre><code class="language-bash"># حذف اطلاعات دیباگ و جدول نمادها
go build -ldflags=&quot;-s -w&quot; -o deploy main.go

# فشرده‌سازی با UPX (نیاز به نصب UPX دارد)
upx --best deploy
</code></pre>
<h3>۴. اسکریپت بسته‌بندی دسته‌ای</h3>
<p>ساخت اسکریپت <code>build.sh</code>:</p>
<pre><code class="language-bash">#!/bin/bash

# ایجاد دایرکتوری ساخت
mkdir -p builds

# ساخت نسخه‌های هر پلتفرم
echo &quot;در حال ساخت نسخه ۶۴ بیتی Linux ...&quot;
GOOS=linux GOARCH=amd64 go build -ldflags=&quot;-s -w&quot; -o builds/deploy-linux-amd64 main.go

echo &quot;در حال ساخت نسخه ۶۴ بیتی Windows ...&quot;
GOOS=windows GOARCH=amd64 go build -ldflags=&quot;-s -w&quot; -o builds/deploy-windows-amd64.exe main.go

echo &quot;در حال ساخت نسخه ۶۴ بیتی macOS ...&quot;
GOOS=darwin GOARCH=amd64 go build -ldflags=&quot;-s -w&quot; -o builds/deploy-darwin-amd64 main.go

echo &quot;در حال ساخت نسخه ARM64 macOS ...&quot;
GOOS=darwin GOARCH=arm64 go build -ldflags=&quot;-s -w&quot; -o builds/deploy-darwin-arm64 main.go

echo &quot;ساخت به پایان رسید!&quot;
ls -la builds/
</code></pre>
<p>اجرای اسکریپت:</p>
<pre><code class="language-bash">chmod +x build.sh
./build.sh
</code></pre>
<h2>نمونه استفاده</h2>
<h3>نمایش اطلاعات راهنما</h3>
<pre><code class="language-bash">$ ./deploy --help
ابزار استقرار Go-Deploy

نحوه استفاده: ./deploy [گزینه‌ها]

گزینه‌ها:
  -config string
        مسیر فایل پیکربندی (پیش‌فرض &quot;config.json&quot;)
  -help
        نمایش اطلاعات راهنما
  -version
        نمایش اطلاعات نسخه

مثال‌ها:
  ./deploy                           # استفاده از فایل پیکربندی پیش‌فرض config.json
  ./deploy --config prod.json        # استفاده از فایل پیکربندی مشخص شده
  ./deploy --config /path/to/config.json  # استفاده از فایل پیکربندی با مسیر مطلق
</code></pre>
<h3>استفاده از فایل پیکربندی مشخص</h3>
<pre><code class="language-bash">$ ./deploy --config prod.json
شروع اجرای برنامه استقرار...
در حال تلاش برای خواندن فایل پیکربندی: /path/to/go-deploy/prod.json
در حال استفاده از فایل پیکربندی...
دایرکتوری محلی /path/to/project/dist وجود دارد
در حال اتصال به سرور SSH...
اتصال به سرور SSH موفقیت‌آمیز بود
...
</code></pre>
<h3>استفاده از فایل پیکربندی</h3>
<pre><code class="language-bash">$ ./deploy
شروع اجرای برنامه استقرار...
در حال تلاش برای خواندن فایل پیکربندی: /path/to/go-deploy/config.json
در حال استفاده از فایل پیکربندی...
دایرکتوری محلی /path/to/project/unpackage/dist/build/web وجود دارد
در حال اتصال به سرور SSH...
اتصال به سرور SSH موفقیت‌آمیز بود
در حال ایجاد کلاینت SFTP...
کلاینت SFTP با موفقیت ایجاد شد
آماده‌سازی برای آپلود به دایرکتوری راه دور: /opt/xsoft/nginx/html/app/dist
شروع آپلود دایرکتوری...
شروع پیمایش دایرکتوری محلی: /path/to/project/unpackage/dist/build/web
ایجاد دایرکتوری: /opt/xsoft/nginx/html/app/dist
فایل static/js/app.js.map مستثنی شد، آپلود نمی‌شود
ایجاد نسخه پشتیبان: /opt/xsoft/nginx/html/app/dist/index.html -&gt; /opt/xsoft/nginx/html/app/dist/index.html.backup
آپلود فایل: /path/to/project/unpackage/dist/build/web/index.html -&gt; /opt/xsoft/nginx/html/app/dist/index.html
فایل .DS_Store مستثنی شد، آپلود نمی‌شود
آپلود فایل: /path/to/project/unpackage/dist/build/web/static/css/app.css -&gt; /opt/xsoft/nginx/html/app/dist/static/css/app.css
آپلود ناموفق بود (تلاش ۱/۳): خطای شبکه
تلاش مجدد برای آپلود فایل (۲/۳): /path/to/project/unpackage/dist/build/web/static/js/app.js
آپلود فایل: /path/to/project/unpackage/dist/build/web/static/js/app.js -&gt; /opt/xsoft/nginx/html/app/dist/static/js/app.js
...
آپلود دایرکتوری با موفقیت انجام شد!
آمار:
  - تعداد فایل‌های آپلود شده: ۴۸۵
  - تعداد دایرکتوری‌های ایجاد شده: ۱۸
  - حجم انتقال یافته: ۲۵.۸ مگابایت
  - مدت زمان آپلود: ۳۸.۵ ثانیه
  - کل مدت زمان: ۳۹.۲ ثانیه
  - سرعت انتقال: ۰.۶۷ مگابایت بر ثانیه
</code></pre>
<h2>نکات مهم</h2>
<ol>
<li><p><strong>امنیت</strong>:</p>
<ul>
<li>در محیط تولید توصیه می‌شود از احراز هویت کلید SSH به جای رمز عبور استفاده شود</li>
<li>در حال حاضر از <code>ssh.InsecureIgnoreHostKey()</code> استفاده می‌شود، در محیط تولید باید کلید میزبان تأیید شود</li>
</ul>
</li>
<li><p><strong>شبکه</strong>:</p>
<ul>
<li>اطمینان حاصل کنید که سیستم محلی به پورت ۲۲ سرور هدف دسترسی دارد</li>
<li>سرعت انتقال وابسته به پهنای باند شبکه و عملکرد سرور است</li>
</ul>
</li>
<li><p><strong>دسترسی‌ها</strong>:</p>
<ul>
<li>اطمینان حاصل کنید که کاربر SSH اجازه نوشتن در دایرکتوری هدف را دارد</li>
<li>در صورت نیاز ممکن است لازم باشد از دسترسی sudo استفاده شود</li>
</ul>
</li>
<li><p><strong>مسیرها</strong>:</p>
<ul>
<li>مسیر محلی به طور خودکار بر اساس مکان فایل اجرایی محاسبه می‌شود و نیازی به نگرانی درباره دایرکتوری اجرا نیست</li>
<li>مسیر راه دور باید مطلق باشد</li>
</ul>
</li>
</ol>
<h2>رفع مشکلات</h2>
<h3>مشکلات رایج</h3>
<ol>
<li><p><strong>اتصال تایم‌اوت شد</strong></p>
<pre><code>اتصال به سرور SSH ناموفق بود: dial tcp: i/o timeout
</code></pre>
<ul>
<li>آدرس و پورت سرور را بررسی کنید</li>
<li>از اتصال شبکه مطمئن شوید</li>
<li>تنظیمات فایروال را بررسی کنید</li>
</ul>
</li>
<li><p><strong>احراز هویت ناموفق</strong></p>
<pre><code>ورود ناموفق: ssh: handshake failed
</code></pre>
<ul>
<li>نام کاربری و رمز عبور را بررسی کنید</li>
<li>اطمینان حاصل کنید سرویس SSH فعال است</li>
<li>پیکربندی SSH را بررسی کنید</li>
</ul>
</li>
<li><p><strong>خطای دسترسی</strong></p>
<pre><code>ایجاد دایرکتوری ناموفق: permission denied
</code></pre>
<ul>
<li>دسترسی کاربر به دایرکتوری هدف را بررسی کنید</li>
<li>ممکن است نیاز به استفاده از sudo یا تغییر مالکیت دایرکتوری باشد</li>
</ul>
</li>
<li><p><strong>دایرکتوری محلی وجود ندارد</strong></p>
<pre><code>خطا: دایرکتوری محلی /path/to/unpackage/dist/build/web وجود ندارد
</code></pre>
<ul>
<li>از اتمام ساخت محلی اطمینان حاصل کنید</li>
<li>ساختار دایرکتوری پروژه را بررسی کنید</li>
<li>مسیر به طور خودکار محاسبه می‌شود و نیازی به تنظیم دستی دایرکتوری کاری نیست</li>
</ul>
</li>
</ol>
<h2>توضیحات توسعه</h2>
<h3>ساختار پروژه</h3>
<pre><code>go-deploy/
├── main.go                 # فایل اصلی برنامه
├── go.mod                  # فایل ماژول Go  
├── go.sum                  # فایل اعتبارسنجی وابستگی‌ها
</code></pre>
<p>├── README.md               # مستندات توضیحی کامل<br />
├── Makefile                # ابزار ساخت<br />
├── build.sh                # اسکریپت بسته‌بندی دسته‌ای<br />
├── install.sh              # اسکریپت نصب یک‌باره<br />
└── config.example.json     # نمونه فایل پیکربندی</p>
<pre><code>
### توابع اصلی

- `main()` - تابع اصلی، مدیریت اتصال و فراخوانی بارگذاری
- `uploadDirectory()` - بارگذاری بازگشتی پوشه
- `uploadFile()` - بارگذاری یک فایل منفرد
- `mkdirAll()` - ایجاد بازگشتی پوشه‌های راه دور

## مجوز

مجوز MIT

## مشارکت

ارسال Issue و Pull Request خوش‌آمدید!


---


Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-06-19


---
</code></pre>

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Statcounter and other scripts can be added here -->
</body>
</html>