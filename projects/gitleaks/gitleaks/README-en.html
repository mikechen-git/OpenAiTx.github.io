<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gitleaks - gitleaks/gitleaks en</title>
    <meta name="title" content="gitleaks - gitleaks/gitleaks en | Dir The dir (aliases include files, directory) command lets you scan directories and files. Example: gitleaks dir -v path_to_directory_or_file. If there is no t...">
    <meta name="description" content="gitleaks/gitleaks - GitHub repository en documentation and information | Dir The dir (aliases include files, directory) command lets you scan directories and files. Example: gitleaks dir -v path_to_directory_or_file. If there is no t...">
    <meta name="keywords" content="gitleaks, gitleaks, GitHub, repository, en documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/gitleaks/gitleaks/README-en.html">
    <meta property="og:title" content="gitleaks - gitleaks/gitleaks en | Dir The dir (aliases include files, directory) command lets you scan directories and files. Example: gitleaks dir -v path_to_directory_or_file. If there is no t...">
    <meta property="og:description" content="gitleaks/gitleaks - GitHub repository en documentation and information | Dir The dir (aliases include files, directory) command lets you scan directories and files. Example: gitleaks dir -v path_to_directory_or_file. If there is no t...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div style="position: fixed; top: 2px; left: 2px; z-index: 2000; background: rgba(255,255,255,0.95); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 4px 14px; font-size: 15px; color: #222; font-family: 'Segoe UI', Arial, sans-serif; font-weight: 500; letter-spacing: 0.5px;">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: 600;">Open AI Tx</a>
    </div>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/gitleaks/gitleaks" id="githubRepoLink" target="_blank">gitleaks/gitleaks</a>
<h1 style="display: none;">Dir The dir (aliases include files, directory) command lets you scan directories and files. Example: gitleaks dir -v path_to_directory_or_file. If there is no t...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h4>Dir</h4>
<p>The <code>dir</code> (aliases include <code>files</code>, <code>directory</code>) command lets you scan directories and files. Example: <code>gitleaks dir -v path_to_directory_or_file</code>.
If there is no target specified as a positional argument, then gitleaks will scan the current working directory.</p>
<h4>Stdin</h4>
<p>You can also stream data to gitleaks with the <code>stdin</code> command. Example: <code>cat some_file | gitleaks -v stdin</code></p>
<h3>Creating a baseline</h3>
<p>When scanning large repositories or repositories with a long history, it can be convenient to use a baseline. When using a baseline,
gitleaks will ignore any old findings that are present in the baseline. A baseline can be any gitleaks report. To create a gitleaks report, run gitleaks with the <code>--report-path</code> parameter.</p>
<pre><code>gitleaks git --report-path gitleaks-report.json # This will save the report in a file called gitleaks-report.json
</code></pre>
<p>Once as baseline is created it can be applied when running the detect command again:</p>
<pre><code>gitleaks git --baseline-path gitleaks-report.json --report-path findings.json
</code></pre>
<p>After running the detect command with the --baseline-path parameter, report output (findings.json) will only contain new issues.</p>
<h2>Pre-Commit hook</h2>
<p>You can run Gitleaks as a pre-commit hook by copying the example <code>pre-commit.py</code> script into
your <code>.git/hooks/</code> directory.</p>
<h2>Load Configuration</h2>
<p>The order of precedence is:</p>
<ol>
<li><code>--config/-c</code> option:
<pre><code class="language-bash">gitleaks git --config /home/dev/customgitleaks.toml .
</code></pre>
</li>
<li>Environment variable <code>GITLEAKS_CONFIG</code> with the file path:
<pre><code class="language-bash">export GITLEAKS_CONFIG=&quot;/home/dev/customgitleaks.toml&quot;
gitleaks git .
</code></pre>
</li>
<li>Environment variable <code>GITLEAKS_CONFIG_TOML</code> with the file content:
<pre><code class="language-bash">export GITLEAKS_CONFIG_TOML=`cat customgitleaks.toml`
gitleaks git .
</code></pre>
</li>
<li>A <code>.gitleaks.toml</code> file within the target path:
<pre><code class="language-bash">gitleaks git .
</code></pre>
</li>
</ol>
<p>If none of the four options are used, then gitleaks will use the default config.</p>
<h2>Configuration</h2>
<p>Gitleaks offers a configuration format you can follow to write your own secret detection rules:</p>
<pre><code class="language-toml"># Title for the gitleaks configuration file.
title = &quot;Custom Gitleaks configuration&quot;

# You have basically two options for your custom configuration:
#
# 1. define your own configuration, default rules do not apply
#
#    use e.g., the default configuration as starting point:
#    https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml
#
# 2. extend a configuration, the rules are overwritten or extended
#
#    When you extend a configuration the extended rules take precedence over the
#    default rules. I.e., if there are duplicate rules in both the extended
#    configuration and the default configuration the extended rules or
#    attributes of them will override the default rules.
#    Another thing to know with extending configurations is you can chain
#    together multiple configuration files to a depth of 2. Allowlist arrays are
#    appended and can contain duplicates.

# useDefault and path can NOT be used at the same time. Choose one.
[extend]
# useDefault will extend the default gitleaks config built in to the binary
# the latest version is located at:
# https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml
useDefault = true
# or you can provide a path to a configuration to extend from.
# The path is relative to where gitleaks was invoked,
# not the location of the base config.
# path = &quot;common_config.toml&quot;
# If there are any rules you don't want to inherit, they can be specified here.
disabledRules = [ &quot;generic-api-key&quot;]

# An array of tables that contain information that define instructions
# on how to detect secrets
[[rules]]
# Unique identifier for this rule
id = &quot;awesome-rule-1&quot;

# Short human-readable description of the rule.
description = &quot;awesome rule 1&quot;

# Golang regular expression used to detect secrets. Note Golang's regex engine
# does not support lookaheads.
regex = '''one-go-style-regex-for-this-rule'''

# Int used to extract secret from regex match and used as the group that will have
# its entropy checked if `entropy` is set.
secretGroup = 3

# Float representing the minimum shannon entropy a regex group must have to be considered a secret.
entropy = 3.5

# Golang regular expression used to match paths. This can be used as a standalone rule or it can be used
# in conjunction with a valid `regex` entry.
path = '''a-file-path-regex'''

# Keywords are used for pre-regex check filtering. Rules that contain
# keywords will perform a quick string compare check to make sure the
# keyword(s) are in the content being scanned. Ideally these values should
# either be part of the identiifer or unique strings specific to the rule's regex
# (introduced in v8.6.0)
keywords = [
  &quot;auth&quot;,
  &quot;password&quot;,
  &quot;token&quot;,
]

# Array of strings used for metadata and reporting purposes.
tags = [&quot;tag&quot;,&quot;another tag&quot;]

    # ⚠️ In v8.21.0 `[rules.allowlist]` was replaced with `[[rules.allowlists]]`.
    # This change was backwards-compatible: instances of `[rules.allowlist]` still  work.
    #
    # You can define multiple allowlists for a rule to reduce false positives.
    # A finding will be ignored if _ANY_ `[[rules.allowlists]]` matches.
    [[rules.allowlists]]
    description = &quot;ignore commit A&quot;
    # When multiple criteria are defined the default condition is &quot;OR&quot;.
    # e.g., this can match on |commits| OR |paths| OR |stopwords|.
    condition = &quot;OR&quot;
    commits = [ &quot;commit-A&quot;, &quot;commit-B&quot;]
    paths = [
      '''go\.mod''',
      '''go\.sum'''
    ]
    # note: stopwords targets the extracted secret, not the entire regex match
    # like 'regexes' does. (stopwords introduced in 8.8.0)
    stopwords = [
      '''client''',
      '''endpoint''',
    ]

    [[rules.allowlists]]
    # The &quot;AND&quot; condition can be used to make sure all criteria match.
    # e.g., this matches if |regexes| AND |paths| are satisfied.
    condition = &quot;AND&quot;
    # note: |regexes| defaults to check the _Secret_ in the finding.
    # Acceptable values for |regexTarget| are &quot;secret&quot; (default), &quot;match&quot;, and &quot;line&quot;.
    regexTarget = &quot;match&quot;
    regexes = [ '''(?i)parseur[il]''' ]
    paths = [ '''package-lock\.json''' ]

# You can extend a particular rule from the default config. e.g., gitlab-pat
# if you have defined a custom token prefix on your GitLab instance
[[rules]]
id = &quot;gitlab-pat&quot;
# all the other attributes from the default rule are inherited

    [[rules.allowlists]]
    regexTarget = &quot;line&quot;
    regexes = [ '''MY-glpat-''' ]


# ⚠️ In v8.25.0 `[allowlist]` was replaced with `[[allowlists]]`.
#
# Global allowlists have a higher order of precedence than rule-specific allowlists.
# If a commit listed in the `commits` field below is encountered then that commit will be skipped and no
# secrets will be detected for said commit. The same logic applies for regexes and paths.
[[allowlists]]
description = &quot;global allow list&quot;
commits = [ &quot;commit-A&quot;, &quot;commit-B&quot;, &quot;commit-C&quot;]
paths = [
  '''gitleaks\.toml''',
  '''(.*?)(jpg|gif|doc)'''
]
# note: (global) regexTarget defaults to check the _Secret_ in the finding.
# Acceptable values for regexTarget are &quot;match&quot; and &quot;line&quot;
regexTarget = &quot;match&quot;
regexes = [
  '''219-09-9999''',
  '''078-05-1120''',
  '''(9[0-9]{2}|666)-\d{2}-\d{4}''',
]
# note: stopwords targets the extracted secret, not the entire regex match
# like 'regexes' does. (stopwords introduced in 8.8.0)
stopwords = [
  '''client''',
'''endpoint''',
]

# ⚠️ In v8.25.0, `[[allowlists]]` have a new field called |targetRules|.
#
# Common allowlists can be defined once and assigned to multiple rules using |targetRules|.
# This will only run on the specified rules, not globally.
[[allowlists]]
targetRules = [&quot;awesome-rule-1&quot;, &quot;awesome-rule-2&quot;]
description = &quot;Our test assets trigger false-positives in a couple rules.&quot;
paths = ['''tests/expected/._\.json$''']
</code></pre>
<p>Refer to the default <a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/config/gitleaks.toml">gitleaks config</a> for examples or follow the <a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/CONTRIBUTING.md">contributing guidelines</a> if you would like to contribute to the default configuration. Additionally, you can check out <a href="https://blog.gitleaks.io/stop-leaking-secrets-configuration-2-3-aeed293b1fbf">this gitleaks blog post</a> which covers advanced configuration setups.</p>
<h3>Additional Configuration</h3>
<h4>gitleaks:allow</h4>
<p>If you are knowingly committing a test secret that gitleaks will catch you can add a <code>gitleaks:allow</code> comment to that line which will instruct gitleaks
to ignore that secret. Ex:</p>
<pre><code>class CustomClass:
    discord_client_secret = '8dyfuiRyq=vVc3RRr_edRk-fK__JItpZ'  #gitleaks:allow

</code></pre>
<h4>.gitleaksignore</h4>
<p>You can ignore specific findings by creating a <code>.gitleaksignore</code> file at the root of your repo. In release v8.10.0 Gitleaks added a <code>Fingerprint</code> value to the Gitleaks report. Each leak, or finding, has a Fingerprint that uniquely identifies a secret. Add this fingerprint to the <code>.gitleaksignore</code> file to ignore that specific secret. See Gitleaks' <a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/.gitleaksignore">.gitleaksignore</a> for an example. Note: this feature is experimental and is subject to change in the future.</p>
<h4>Decoding</h4>
<p>Sometimes secrets are encoded in a way that can make them difficult to find
with just regex. Now you can tell gitleaks to automatically find and decode
encoded text. The flag <code>--max-decode-depth</code> enables this feature (the default
value &quot;0&quot; means the feature is disabled by default).</p>
<p>Recursive decoding is supported since decoded text can also contain encoded
text.  The flag <code>--max-decode-depth</code> sets the recursion limit. Recursion stops
when there are no new segments of encoded text to decode, so setting a really
high max depth doesn't mean it will make that many passes. It will only make as
many as it needs to decode the text. Overall, decoding only minimally increases
scan times.</p>
<p>The findings for encoded text differ from normal findings in the following
ways:</p>
<ul>
<li>The location points the bounds of the encoded text
<ul>
<li>If the rule matches outside the encoded text, the bounds are adjusted to
include that as well</li>
</ul>
</li>
<li>The match and secret contain the decoded value</li>
<li>Two tags are added <code>decoded:&lt;encoding&gt;</code> and <code>decode-depth:&lt;depth&gt;</code></li>
</ul>
<p>Currently supported encodings:</p>
<ul>
<li><strong>percent</strong> - Any printable ASCII percent encoded values</li>
<li><strong>hex</strong> - Any printable ASCII hex encoded values &gt;= 32 characters</li>
<li><strong>base64</strong> - Any printable ASCII base64 encoded values &gt;= 16 characters</li>
</ul>
<h4>Archive Scanning</h4>
<p>Sometimes secrets are packaged within archive files like zip files or tarballs,
making them difficult to discover. Now you can tell gitleaks to automatically
extract and scan the contents of archives. The flag <code>--max-archive-depth</code>
enables this feature for both <code>dir</code> and <code>git</code> scan types. The default value of
&quot;0&quot; means this feature is disabled by default.</p>
<p>Recursive scanning is supported since archives can also contain other archives.
The <code>--max-archive-depth</code> flag sets the recursion limit. Recursion stops when
there are no new archives to extract, so setting a very high max depth just
sets the potential to go that deep. It will only go as deep as it needs to.</p>
<p>The findings for secrets located within an archive will include the path to the
file inside the archive. Inner paths are separated with <code>!</code>.</p>
<p>Example finding (shortened for brevity):</p>
<pre><code>Finding:     DB_PASSWORD=8ae31cacf141669ddfb5da
...
File:        testdata/archives/nested.tar.gz!archives/files.tar!files/.env.prod
Line:        4
Commit:      6e6ee6596d337bb656496425fb98644eb62b4a82
...
Fingerprint: 6e6ee6596d337bb656496425fb98644eb62b4a82:testdata/archives/nested.tar.gz!archives/files.tar!files/.env.prod:generic-api-key:4
Link:        https://github.com/leaktk/gitleaks/blob/6e6ee6596d337bb656496425fb98644eb62b4a82/testdata/archives/nested.tar.gz
</code></pre>
<p>This means a secret was detected on line 4 of <code>files/.env.prod.</code> which is in
<code>archives/files.tar</code> which is in <code>testdata/archives/nested.tar.gz</code>.</p>
<p>Currently supported formats:</p>
<p>The <a href="https://github.com/mholt/archives?tab=readme-ov-file#supported-compression-formats">compression</a>
and <a href="https://github.com/mholt/archives?tab=readme-ov-file#supported-archive-formats">archive</a>
formats supported by mholt's <a href="https://github.com/mholt/archives">archives package</a>
are supported.</p>
<h4>Reporting</h4>
<p>Gitleaks has built-in support for several report formats: <a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/testdata/expected/report/json_simple.json"><code>json</code></a>, <a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/testdata/expected/report/csv_simple.csv?plain=1"><code>csv</code></a>, <a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/testdata/expected/report/junit_simple.xml"><code>junit</code></a>, and <a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/testdata/expected/report/sarif_simple.sarif"><code>sarif</code></a>.</p>
<p>If none of these formats fit your need, you can create your own report format with a <a href="https://www.digitalocean.com/community/tutorials/how-to-use-templates-in-go#step-4-writing-a-template">Go <code>text/template</code> .tmpl file</a> and the <code>--report-template</code> flag. The template can use <a href="https://masterminds.github.io/sprig/">extended functionality from the <code>Masterminds/sprig</code> template library</a>.</p>
<p>For example, the following template provides a custom JSON output:</p>
<pre><code class="language-gotemplate"># jsonextra.tmpl
[{{ $lastFinding := (sub (len . ) 1) }}
{{- range $i, $finding := . }}{{with $finding}}
    {
        &quot;Description&quot;: {{ quote .Description }},
        &quot;StartLine&quot;: {{ .StartLine }},
        &quot;EndLine&quot;: {{ .EndLine }},
        &quot;StartColumn&quot;: {{ .StartColumn }},
        &quot;EndColumn&quot;: {{ .EndColumn }},
        &quot;Line&quot;: {{ quote .Line }},
        &quot;Match&quot;: {{ quote .Match }},
        &quot;Secret&quot;: {{ quote .Secret }},
        &quot;File&quot;: &quot;{{ .File }}&quot;,
        &quot;SymlinkFile&quot;: {{ quote .SymlinkFile }},
        &quot;Commit&quot;: {{ quote .Commit }},
        &quot;Entropy&quot;: {{ .Entropy }},
        &quot;Author&quot;: {{ quote .Author }},
        &quot;Email&quot;: {{ quote .Email }},
        &quot;Date&quot;: {{ quote .Date }},
        &quot;Message&quot;: {{ quote .Message }},
        &quot;Tags&quot;: [{{ $lastTag := (sub (len .Tags ) 1) }}{{ range $j, $tag := .Tags }}{{ quote . }}{{ if ne $j $lastTag }},{{ end }}{{ end }}],
        &quot;RuleID&quot;: {{ quote .RuleID }},
        &quot;Fingerprint&quot;: {{ quote .Fingerprint }}
    }{{ if ne $i $lastFinding }},{{ end }}
{{- end}}{{ end }}
]
</code></pre>
<p>Usage:</p>
<pre><code class="language-sh">$ gitleaks dir ~/leaky-repo/ --report-path &quot;report.json&quot; --report-format template --report-template testdata/report/jsonextra.tmpl
</code></pre>
<h2>Sponsorships</h2>
<p align="left">
	<h3><a href="https://coderabbit.ai/?utm_source=oss&utm_medium=sponsorship&utm_campaign=gitleaks">coderabbit.ai</h3>
	  <a href="https://coderabbit.ai/?utm_source=oss&utm_medium=sponsorship&utm_campaign=gitleaks">
		  <img alt="CodeRabbit.ai Sponsorship" src="https://github.com/gitleaks/gitleaks/assets/15034943/76c30a85-887b-47ca-9956-17a8e55c6c41" width=200>
	  </a>
</p>
<h2>Exit Codes</h2>
<p>You can always set the exit code when leaks are encountered with the --exit-code flag. Default exit codes below:</p>
<pre><code>0 - no leaks present
1 - leaks or error encountered
126 - unknown flag
</code></pre>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-06-27</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>