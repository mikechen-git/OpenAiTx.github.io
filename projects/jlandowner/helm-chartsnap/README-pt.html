<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>helm-chartsnap - jlandowner/helm-chartsnap pt</title>
    <meta name="title" content="helm-chartsnap - jlandowner/helm-chartsnap pt | helm-chartsnap 📸 Ferramenta de testes de snapshot para Helm charts. Traga capacidades poderosas de teste de interface para Helm chart com configuração mínima, ...">
    <meta name="description" content="jlandowner/helm-chartsnap - GitHub repository pt documentation and information | helm-chartsnap 📸 Ferramenta de testes de snapshot para Helm charts. Traga capacidades poderosas de teste de interface para Helm chart com configuração mínima, ...">
    <meta name="keywords" content="jlandowner, helm-chartsnap, GitHub, repository, pt documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/jlandowner/helm-chartsnap/README-pt.html">
    <meta property="og:title" content="helm-chartsnap - jlandowner/helm-chartsnap pt | helm-chartsnap 📸 Ferramenta de testes de snapshot para Helm charts. Traga capacidades poderosas de teste de interface para Helm chart com configuração mínima, ...">
    <meta property="og:description" content="jlandowner/helm-chartsnap - GitHub repository pt documentation and information | helm-chartsnap 📸 Ferramenta de testes de snapshot para Helm charts. Traga capacidades poderosas de teste de interface para Helm chart com configuração mínima, ...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/jlandowner/helm-chartsnap" id="githubRepoLink" target="_blank">jlandowner/helm-chartsnap</a>
<h1 style="display: none;">helm-chartsnap 📸 Ferramenta de testes de snapshot para Helm charts. Traga capacidades poderosas de teste de interface para Helm chart com configuração mínima, ...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <h1>helm-chartsnap 📸</h1>
<p><a href="https://pkg.go.dev/github.com/jlandowner/helm-chartsnap"><img src="https://pkg.go.dev/badge/github.com/jlandowner/helm-chartsnap.svg" alt="Go Reference" /></a>
<a href="https://goreportcard.com/report/github.com/jlandowner/helm-chartsnap"><img src="https://goreportcard.com/badge/github.com/jlandowner/helm-chartsnap" alt="Go Report Card" /></a>
<a href="https://codecov.io/gh/jlandowner/helm-chartsnap"><img src="https://codecov.io/gh/jlandowner/helm-chartsnap/graph/badge.svg?token=8ARG53CRL7" alt="codecov" /></a>
<a href="https://github.com/jlandowner/helm-chartsnap/actions/workflows/release.yaml"><img src="https://github.com/jlandowner/helm-chartsnap/actions/workflows/release.yaml/badge.svg" alt="Workflow Status" /></a>
<a href="https://github.com/jlandowner/helm-chartsnap/actions/workflows/ci.yaml"><img src="https://github.com/jlandowner/helm-chartsnap/actions/workflows/ci.yaml/badge.svg" alt="CI" /></a>
<a href="https://github.com/marketplace/actions/helm-chartsnap-action"><img src="https://img.shields.io/badge/Marketplace-Helm%20chartsnap%20action-blue.svg?colorA=24292e&amp;colorB=0366d6&amp;style=flat&amp;longCache=true&amp;logo=github" alt="GitHub Marketplace" /></a></p>
<p>Ferramenta de testes de snapshot para Helm charts.</p>
<p>Traga capacidades poderosas de teste de interface para Helm chart com configuração mínima, apenas dentro do arquivo <code>values.yaml</code>.</p>
<p><img src="https://raw.githubusercontent.com/jlandowner/helm-chartsnap/main/docs/screenshot.png" alt="screenshot" /></p>
<h2>Visão Geral</h2>
<ul>
<li><a href="#funcionalidades-">Funcionalidades 🔑</a></li>
<li><a href="#por-que-teste-de-snapshot-">Por que Teste de Snapshot? 📸</a>
<ul>
<li><a href="#motiva%C3%A7%C3%A3o">Motivação</a></li>
</ul>
</li>
<li><a href="#instala%C3%A7%C3%A3o-">Instalação 🚀</a></li>
<li><a href="#uso">Uso</a>
<ul>
<li><a href="#lidando-com-valores-din%C3%A2micos-">Lidando com valores dinâmicos 💪</a></li>
</ul>
</li>
<li><a href="#exemplos--usu%C3%A1rios-">Exemplos &amp; Usuários ✨</a></li>
</ul>
<h2>Funcionalidades 🔑</h2>
<ul>
<li><p><strong>Teste de snapshot fácil e intuitivo para desenvolvedores Helm</strong></p>
<ul>
<li><strong>Sem formato de arquivo TestSuite específico da ferramenta</strong>: Diferente de algumas ferramentas que exigem a criação de TestSuites separadas com formatos de arquivo personalizados, esta ferramenta não requer formatos de arquivo adicionais. Em vez disso, você pode preparar variações do arquivo padrão <code>values.yaml</code> para cada caso de teste. Isso elimina a necessidade de aprender novos formatos e simplifica os testes.</li>
</ul>
</li>
<li><p><strong>Otimizado para Helm chart</strong></p>
<ul>
<li><strong>Lida com saída dinâmica gerada por funções do helm</strong>: Você pode especificar propriedades adicionais dentro do arquivo values.yaml para cada caso de teste para fornecer flexibilidade ao ajustar o comportamento do teste. Por exemplo, é possível controlar a saída gerada dinamicamente por funções do helm como <a href="https://helm.sh/docs/chart_template_guide/function_list/">randAlphaNum</a>.</li>
</ul>
</li>
<li><p><strong>Teste de snapshot contínuo</strong></p>
<ul>
<li><strong><a href="https://github.com/jlandowner/helm-chartsnap-action">GitHub Action</a> está pronta</strong>: GitHub Action que permite realizar testes contínuos de snapshot para charts Helm locais ou remotos na sua CI está pronta 🚀 -&gt; <a href="https://github.com/jlandowner/helm-chartsnap-action"><code>helm-chart-action</code></a></li>
</ul>
</li>
</ul>
<h2>Por que Teste de Snapshot? 📸</h2>
<p>Acredito que o teste de snapshot, uma abordagem de teste popular em Web ou UI com ferramentas como Jest, seja a melhor forma de testar Helm charts. O teste de snapshot oferece vários benefícios:</p>
<ul>
<li><p><strong>Comparações visuais:</strong> Os testes de snapshot criam uma saída base e depois a comparam com os resultados de testes subsequentes. Isso permite uma inspeção visual fácil de mudanças e regressões no renderização do Helm chart.</p>
</li>
<li><p><strong>Maior manutenibilidade:</strong> O teste de snapshot simplifica o processo de configuração do teste, tornando-o mais acessível e fácil de manter, especialmente ao lidar com charts Helm complexos. A entrada para o Helm chart é uma combinação de valores. Só precisamos manter as combinações de entrada assumidas (=values.yaml) e seus snapshots.</p>
</li>
<li><p><strong>Testes contínuos:</strong> Ao capturar continuamente snapshots do Helm chart em seu processo de CI, você pode rapidamente perceber mudanças em todo o seu chart e evitar regressões.</p>
</li>
</ul>
<p>Essas vantagens não se limitam ao chart Helm que você criou, mas também aos charts de terceiros que você instalou no seu Kubernetes, caso seja um administrador Kubernetes. Ao atualizar um cluster, você pode perceber quaisquer mudanças nos manifests de saída produzidos pelos seus <em>values</em>, por menores que sejam.</p>
<h3>Motivação</h3>
<p>Existem ferramentas de teste Helm que suportam testes de snapshot.</p>
<ul>
<li><a href="https://github.com/helm-unittest/helm-unittest">helm-unittest</a>, uma popular ferramenta de teste unitário, possui uma opção para fazer <a href="https://github.com/helm-unittest/helm-unittest#snapshot-testing">teste de snapshot</a>.</li>
<li><a href="https://terratest.gruntwork.io/">terratest</a>, testes automatizados para seu código de infraestrutura. Permite escrever testes em Go e possui recurso para testar a saída do Helm. <a href="https://blog.gruntwork.io/automated-testing-for-kubernetes-and-helm-charts-using-terratest-a4ddc4e67344">blog post</a></li>
</ul>
<blockquote>
<p>A ferramenta oficial de teste do Helm <a href="https://github.com/helm/chart-testing"><code>ct</code></a> não é para testes unitários ou de snapshot, mas para lint e teste de integração</p>
</blockquote>
<p>Embora sejam ferramentas valiosas para testar Helm charts, possuem certas limitações para teste de snapshot.</p>
<ul>
<li><p>É necessário aprender e preparar arquivos de Test Suite das ferramentas mesmo que seja apenas para teste de snapshot.</p>
</li>
<li><p>Não faz snapshot do chart inteiro por padrão, mas é projetado para testar por arquivo dentro do Helm chart.</p>
</li>
<li><p>As saídas dinâmicas das funções do Helm não são consideradas.</p>
</li>
</ul>
<p>helm-unittest é projetado para conduzir testes por arquivo dentro do Helm chart. Isso significa que avalia cada arquivo de forma independente e, quando valores ou condições do Helm chart levam a um arquivo inteiro ser incluído ou excluído condicionalmente, isso pode resultar em testes incapazes de cobrir cenários importantes.</p>
<p>Aqui está um exemplo de arquivo de especificação de teste para teste de snapshot no helm-unittest.</p>
<blockquote>
<p>https://github.com/helm-unittest/helm-unittest#snapshot-testing</p>
<pre><code class="language-yaml">templates:
  - templates/deployment.yaml
tests:
  - it: pod spec should match snapshot
    asserts:
      - matchSnapshot:
          path: spec.template.spec
  # ou você pode fazer snapshot do manifest inteiro
  - it: manifest should match snapshot
    asserts:
      - matchSnapshot: {}
</code></pre>
</blockquote>
<p>Por exemplo, considere um cenário onde o Helm chart pode criar um recurso <code>Certificate</code> do <code>cert-manager</code> quando ambos TLS e cert-manager estão habilitados, mas criar um recurso <code>Secret</code> TLS autoassinado usando a função do helm <a href="https://helm.sh/docs/chart_template_guide/function_list/#genselfsignedcert"><code>genSelfSignedCert</code></a> quando cert-manager não está habilitado. Além disso, se TLS está habilitado ou não afeta as propriedades TLS do Ingress, opções TLS específicas do Deployment, etc.</p>
<p>Nesses casos, o helm-unittest pode não ser capaz de testar adequadamente o comportamento completo do chart, pois a saída desses arquivos condicionais pode ser vazia, levando a testes incompletos.</p>
<p>No entanto, tudo o que você precisa fazer com <code>helm-chartsnap</code> é apenas preparar alguns arquivos <code>values.yaml</code> dos padrões que você espera 😊</p>
<h2>Instalação 🚀</h2>
<p>Você pode instalar como um plugin do Helm.</p>
<pre><code class="language-sh">helm plugin install https://github.com/jlandowner/helm-chartsnap
</code></pre>
<p>Outras opções:</p>
<ul>
<li><p>Instalação via Go</p>
<pre><code class="language-sh">go install github.com/jlandowner/helm-chartsnap@latest
</code></pre>
</li>
<li><p><a href="https://github.com/jlandowner/helm-chartsnap/releases">Baixar binário de release</a></p>
</li>
</ul>
<h2>Uso</h2>
<p>Basta passar seu chart para um início rápido.</p>
<pre><code>helm chartsnap -c SEU_CHART
</code></pre>
<p>O diretório <code>__snapshot__</code> é criado no diretório do chart e <code>default.snap</code> é criado.</p>
<p>Também é possível criar casos de teste como variações dos arquivos Values do seu chart.</p>
<p>Aqui está o uso completo do comando.</p>
<pre><code class="language-sh">Uso:
  chartsnap -c CHART [flags]

Exemplos:

  # Snapshot com valores padrão:
  chartsnap -c SEU_CHART
  
  # Atualizar arquivos de snapshot:
  chartsnap -c SEU_CHART -u

  # Snapshot com valores do caso de teste:
  chartsnap -c SEU_CHART -f SEU_ARQUIVO_TESTE_VALUES
  
  # Snapshot de todos os casos de teste:
  chartsnap -c SEU_CHART -f SEU_DIRETÓRIO_ARQUIVOS_VALUES_TESTE
  
  # Definir argumentos ou flags adicionais para o comando 'helm template':
  chartsnap -c SEU_CHART -f SEU_ARQUIVO_TESTE_VALUES -- --skip-tests

  # Snapshot de chart remoto em repositório Helm:
  chartsnap -c NOME_DO_CHART -f SEU_ARQUIVO_VALUES -- --repo URL_DO_REPO_HELM

  # Snapshot do ingress-nginx (https://kubernetes.github.io/ingress-nginx/) helm chart para uma versão específica com seu arquivo de valores:
  chartsnap -c ingress-nginx -f SEU_ARQUIVO_VALUES -- --repo https://kubernetes.github.io/ingress-nginx --namespace kube-system --version 4.8.3

  # Snapshot do cilium (https://cilium.io) helm chart com valor padrão e definir flags:
  chartsnap -c cilium -- --repo https://helm.cilium.io --namespace kube-system --set hubble.relay.enabled=true --set hubble.ui.enabled=true

  # Snapshot de charts em registro OCI
  chartsnap -c oci://ghcr.io/nginxinc/charts/nginx-gateway-fabric -n nginx-gateway

  # Saída sem cores:
  NO_COLOR=1 chartsnap -c SEU_CHART

Flags:
  -c, --chart string              caminho para o diretório do chart. este flag é passado para 'helm template RELEASE_NAME CHART --values VALUES' como 'CHART'
      --config-file string        nome ou caminho do arquivo de configuração, que define o comportamento do snapshot, por exemplo, campos dinâmicos (padrão: &quot;.chartsnap.yaml&quot;)
  -N, --ctx-lines int             número de linhas a mostrar na saída diff. 0 para saída completa (padrão: 3)
      --debug                     modo debug
      --fail-helm-error           falha se o comando 'helm template' falhar
      --failfast                  falha ao primeiro caso de teste que falhar
  -h, --help                      ajuda para chartsnap
  -n, --namespace string          namespace. este flag é passado para 'helm template RELEASE_NAME CHART --values VALUES --namespace NAMESPACE' como 'NAMESPACE' (padrão: &quot;default&quot;)
  -o, --output-dir string         diretório onde o diretório __snapshot__ será criado. (padrão: diretório do arquivo de valores se --values estiver definido; diretório do chart se chart for local; senão diretório atual)
      --parallelism int           concorrência dos testes ao tirar múltiplos snapshots para um diretório de arquivos de valores de teste. padrão é ilimitado (padrão: -1)
      --release-name string       nome do release. este flag é passado para 'helm template RELEASE_NAME CHART --values VALUES' como 'RELEASE_NAME' (padrão: &quot;chartsnap&quot;)
      --snapshot-version string   usar uma versão específica de formato de snapshot. v1, v2, v3 são suportados. (padrão: latest)
  -u, --update-snapshot           modo de atualização de snapshot
  -f, --values string             caminho para um arquivo ou diretório de valores de teste. se o diretório for definido, todos os arquivos de teste são testados. se vazio, valores padrão são usados. este flag é passado para 'helm template RELEASE_NAME CHART --values VALUES' como 'VALUES'
  -v, --version                   versão do chartsnap

</code></pre>
<h3>Lidando com valores dinâmicos 💪</h3>
<p>Helm possui um recurso chamado &quot;funções do Helm&quot; que gera valores aleatórios ou certificados autoassinados como <a href="https://helm.sh/docs/chart_template_guide/function_list/#randalphanum-randalpha-randnumeric-and-randascii"><code>randAlphaNum</code></a> e <a href="https://helm.sh/docs/chart_template_guide/function_list/#cryptographic-and-security-functions"><code>genCA</code>, <code>genPrivateKey</code>, <code>genSelfSignedCert</code></a></p>
<p>Ao usar essas funções, a saída irá variar a cada execução do Helm.
Para esses casos, o chartsnap possui um recurso que evita snapshots incompatíveis substituindo-os por um valor fixo, <code>###DYNAMIC_FIELD###</code>.</p>
<p>Você pode especificar os caminhos dos valores dinâmicos no YAML gerado usando <a href="https://datatracker.ietf.org/doc/html/rfc6901">JSONPath</a>.</p>
<pre><code class="language-yaml:.chartsnap.yaml">dynamicFields:
  - apiVersion: v1
    kind: Secret
    name: cosmo-auth-env
    jsonPath:
      - /data/COOKIE_HASHKEY
      - /data/COOKIE_BLOCKKEY
      - /data/COOKIE_HASHKEY
      - /data/COOKIE_SESSION_NAME
    base64: true
</code></pre>
<blockquote>
<p>NOTA:
No JSONPath, o escape do caractere / está documentado na <a href="https://datatracker.ietf.org/doc/html/rfc6901#section-3">RFC6901, seção 3</a></p>
<pre><code>   Porque os caracteres '~' (%x7E) e '/' (%x2F) têm significados especiais no JSON Pointer, '~' precisa ser codificado como '~0' e '/' como '~1' quando esses caracteres aparecem em um token de referência.
</code></pre>
<p>Portanto, se você manipular um manifest como o exemplo a seguir, é necessário especificar o caminho json como <code>/metadata/annotaions/checksum~1values</code>.</p>
<pre><code class="language-yaml">metadata:
  annotations:
    checksum/values: RANDOM_VALUES
</code></pre>
</blockquote>
<p>Se você tiver um diretório de arquivos de valores de teste, coloque um arquivo <code>.chartsnap.yaml</code> dentro desse diretório. É um comportamento comum em todos os testes de snapshot no diretório.</p>
<p>Para mais exemplos, veja <a href="https://raw.githubusercontent.com/jlandowner/helm-chartsnap/main/example/app1">example/app1</a>.</p>
<p>Alternativamente, você pode adicionar a configuração diretamente no arquivo de valores de teste como uma propriedade <code>testSpec</code>.
Neste caso, não é necessário preparar o <code>.chartsnap.yaml</code>. É para tirar snapshots de charts remotos ou de terceiros com seu único arquivo de valores.</p>
<p>Seu arquivo de valores pode ser assim:</p>
<pre><code class="language-yaml"># Adicione esta propriedade aos seus valores.
testSpec:
  dynamicFields:
    - apiVersion: v1
      kind: Secret
      name: cilium-ca
      jsonPath:
        - /data/ca.crt
        - /data/ca.key
      base64: true
    - apiVersion: v1
      kind: Secret
      name: hubble-server-certs
      jsonPath:
        - /data/ca.crt
        - /data/tls.crt
        - /data/tls.key
      base64: true
    - apiVersion: v1
      kind: Secret
      name: hubble-relay-client-certs
      jsonPath:
        - /data/ca.crt
        - /data/tls.crt
        - /data/tls.key
      base64: true

# Os outros podem ser quaisquer valores do seu chart.
# ...
</code></pre>
<p>Para mais exemplos, veja <a href="https://raw.githubusercontent.com/jlandowner/helm-chartsnap/main/example/remote">example/remote</a>.</p>
<h2>Exemplos &amp; Usuários ✨</h2>
<p>| Usuários / Projetos | Descrição | URL |
|:---|:---|:---|
| Exemplo | Chart de exemplo gerado pelo comando <code>helm create</code> | <a href="https://raw.githubusercontent.com/jlandowner/helm-chartsnap/main/example/app1"><code>example/app1</code></a> |
| Exemplo | Exemplo de snapshot de charts em repositórios Helm remotos | <a href="https://raw.githubusercontent.com/jlandowner/helm-chartsnap/main/example/remote"><code>example/remote</code></a> |
| <a href="https://github.com/jlandowner/helm-chartsnap-action">helm-chartsnap-action</a> | GitHub Action para usar helm chartsnap no CI | https://github.com/jlandowner/helm-chartsnap-action |
| <a href="https://github.com/cosmo-workspace/cosmo">cosmo-workspace</a> | Plataforma WebIDE &amp; DevEnvironment open source no Kubernetes | https://github.com/cosmo-workspace/cosmo/tree/main/charts/cosmo/test |
| <a href="https://github.com/Kong/kong">Kong</a> | 🦍 O API Gateway Cloud-Native e AI Gateway. | https://github.com/Kong/charts |</p>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-06-07</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>