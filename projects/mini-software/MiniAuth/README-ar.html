<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mini-software/MiniAuth - ar Documentation</title>

    <!-- Primary Meta Tags -->
    <meta name="title" content="mini-software/MiniAuth - ar Documentation">
    <meta name="description" content="mini-software/MiniAuth - GitHub repository ar documentation and information">
    <meta name="keywords" content="mini-software, MiniAuth, GitHub, repository, ar documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/mini-software/MiniAuth/README-ar.html">
    <meta property="og:title" content="mini-software/MiniAuth - ar Documentation">
    <meta property="og:description" content="mini-software/MiniAuth - GitHub repository ar documentation and information">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">

    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">

    <!-- Marked.js for Markdown rendering -->
    <script type="text/javascript" async="" src="https://www.statcounter.com/counter/recorder.js"></script><script src="/js/marked.min.js?v=20250613"></script>
    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        /* Layout */
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .main-container {
            margin: 0 auto;
            width: 100%;
            max-width: 980px;
            padding: 0 20px;
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 0 15px;
            }
        }

        /* Image size restrictions */
        .markdown-body img {
            max-width: 100%;
            height: auto;
        }

        /* Existing styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f6f8fa;
            border-bottom: 1px solid #e1e4e8;
            position: relative;
        }

        .back-button {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #0366d6;
            text-decoration: none;
            display: flex;
            align-items: center;
            font-size: 14px;
            padding: 5px 10px;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            background-color: #fff;
        }

        .back-button:hover {
            background-color: #f6f8fa;
            border-color: #0366d6;
        }

        .back-button::before {
            content: "←";
            margin-right: 5px;
            font-size: 16px;
        }

        .header .links {
            margin-top: 10px;
            font-size: 16px;
        }

        .header .links a {
            color: #0366d6;
            text-decoration: none;
            margin-left: 5px;
        }

        .header .links a:hover {
            text-decoration: underline;
        }
        
        /* Language badges styles */
        .language-badges {
            margin-top: 15px;
            text-align: center;
        }
        .language-badges a {
            display: inline-block;
            margin: 2px;
            text-decoration: none;
        }
        .language-badges img {
            height: 20px;
            border-radius: 3px;
        }
        .language-badges a:hover img {
            opacity: 0.8;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/mini-software/MiniAuth" id="githubRepoLink" target="_blank">mini-software/MiniAuth</a>
        </div>
        <div class="language-badges" id="languageBadges"><a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=en"><img src="https://img.shields.io/badge/EN-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=zh-CN"><img src="https://img.shields.io/badge/简中-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=zh-TW"><img src="https://img.shields.io/badge/繁中-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=ja"><img src="https://img.shields.io/badge/日本語-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=ko"><img src="https://img.shields.io/badge/한국어-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=th"><img src="https://img.shields.io/badge/ไทย-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=fr"><img src="https://img.shields.io/badge/Français-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=de"><img src="https://img.shields.io/badge/Deutsch-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=es"><img src="https://img.shields.io/badge/Español-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=it"><img src="https://img.shields.io/badge/Italiano-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=ru"><img src="https://img.shields.io/badge/Русский-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=pt"><img src="https://img.shields.io/badge/Português-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=nl"><img src="https://img.shields.io/badge/Nederlands-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=pl"><img src="https://img.shields.io/badge/Polski-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=ar"><img src="https://img.shields.io/badge/العربية-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=tr"><img src="https://img.shields.io/badge/Türkçe-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=vi"><img src="https://img.shields.io/badge/Tiếng Việt-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=hi"><img src="https://img.shields.io/badge/हिंदी-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=fa"><img src="https://img.shields.io/badge/فارسی-white" alt="version"></a> <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniAuth&amp;lang=id"><img src="https://img.shields.io/badge/Bahasa Indonesia-white" alt="version"></a></div>
    </div>

    <div class="main-container">
        <div class="markdown-body" id="content"><div align="center">
<p><a href="https://www.nuget.org/packages/MiniAuth"><img src="https://img.shields.io/nuget/v/MiniAuth.svg" alt="NuGet"></a>  <a href="https://www.nuget.org/packages/MiniAuth"><img src="https://img.shields.io/nuget/dt/MiniAuth.svg" alt=""></a>  
<a href="https://gitee.com/shps951023/MiniAuth"><img src="https://gitee.com/shps951023/MiniAuth/badge/star.svg" alt="star"></a> <a href="https://github.com/Mini-Software/MiniAuth" rel="nofollow"><img src="https://img.shields.io/github/stars/Mini-Software/MiniAuth?logo=github" alt="GitHub stars"></a> <a href="https://www.nuget.org/packages/MiniAuth"><img src="https://img.shields.io/badge/.NET-%3E%3D%206.0-red.svg" alt="version"></a>
</p>
</div>

<hr>
<div align="center">
<p><strong>
    <a href="README.md">English</a> | <a href="README.zh-CN.md">简体中文</a> | <a href="README.zh-Hant.md">繁體中文</a> | <a href="README.ja.md">日本語</a> | <a href="README.ko.md">한국어</a> | <a href="README.es.md">Español</a>  
</strong></p>
</div>



<hr>
<div align="center">
 نجمك على <a href="https://github.com/mini-software/miniauth">GitHub</a>، تبرعك عبر <a href="https://miniexcel.github.io/">Donate</a>، وتوصيتك عبر <a href="https://www.linkedin.com/in/itweihan/">LinkedIn</a> يمكن أن تجعل MiniAuth أفضل 
</div>




<h3>المقدمة</h3>
<p>"سطر واحد من الكود" يضيف إدارة مستخدم/دور هوية asp.net core لتطبيق الويب في مشاريعك الجديدة أو القديمة</p>
<table>
    <tbody><tr>
        <td><img src="https://github.com/mini-software/MiniExcel/assets/12729184/d2aec694-158d-4ebc-bd8b-0e9ae1f855ac" alt="Image 1"></td>
        <td><img src="https://github.com/mini-software/MiniAuth/assets/12729184/2f791e25-9158-495e-9383-4fbedf9b982b" alt="Image 2"></td>
    </tr>
    <tr>
        <td><img src="https://github.com/mini-software/MiniAuth/assets/12729184/03d72ed7-8fb9-465f-9093-24b00279eeb2" alt="Image 3"></td>
        <td><img src="https://github.com/mini-software/MiniAuth/assets/12729184/841df179-7e5f-481a-9039-46738b20aa2e" alt="Image 4"></td>
    </tr>
</tbody></table>


<h3>الميزات</h3>
<ul>
<li>التوافق: يدعم هوية .NET على أساس JWT، الكوكيز، الجلسة، إلخ.</li>
<li>بسيط: تصميم جاهز للتوصيل والتشغيل، يدعم API، SPA، MVC، Razor Page، إلخ.</li>
<li>يدعم قواعد بيانات متعددة: يدعم Oracle، SQL Server، MySQL، إلخ عبر EF Core</li>
<li>غير تدخلي: لا يؤثر على قواعد البيانات أو هياكل المشاريع الحالية</li>
<li>متعدد المنصات: يدعم بيئات Linux وmacOS</li>
</ul>
<h3>التثبيت</h3>
<p>قم بتثبيت الحزمة من NuGet</p>
<h3>بداية سريعة</h3>
<p>أضف سطر كود واحد <code>services.AddMiniAuth()</code> في Startup، ثم شغل مشروعك. مثال:</p>
<pre><code class="language-csharp hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
    {
        <span class="hljs-keyword">var</span> builder = WebApplication.CreateBuilder(args);

        builder.Services.AddMiniAuth(); <span class="hljs-comment">// &lt;= ❗❗❗</span>

        <span class="hljs-keyword">var</span> app = builder.Build();
        app.Run();
    }
}
</code></pre>
<p>حساب المدير الافتراضي هو <code>admin@mini-software.github.io</code> وكلمة المرور <code>E7c4f679-f379-42bf-b547-684d456bc37f</code> (تذكر تغيير كلمة المرور). يمكنك الدخول إلى صفحة الإدارة عبر <code>http(s)://yourhost/miniauth/index.html</code>.</p>
<p>أضف <code>[Authorize]</code> إلى الأقسام أو الدوال التي تتطلب إدارة الصلاحيات، أو تحكم الدور <code>[Authorize(Roles = "role")]</code>، حيث يتم إرجاع الحالة 401 إذا لم يتم تسجيل الدخول، ويتم إرجاع الحالة 403 إذا لم تتوفر الصلاحية.</p>
<h3>MiniAuth هوية الكوكيز</h3>
<p>تم ضبط MiniAuth مسبقًا كهُوية تعتمد على الكوكيز، يرجى التغيير إلى JWT أو غيره إذا كان مشروعك بفصل بين الواجهة الأمامية والخلفية.</p>
<h3>MiniAuth  هوية JWT</h3>
<p>تعيين AuthenticationType = BearerJwt</p>
<pre><code class="language-C# hljs language-C">builder.Services.AddMiniAuth(options:(options) =&gt;
{
    options.AuthenticationType = MiniAuthOptions.AuthType.BearerJwt;
});
</code></pre>
<p>يرجى تذكر تعيين مفتاح أمان JWT جديد، على سبيل المثال:</p>
<pre><code class="language-C# hljs language-C">builder.Services.AddMiniAuth(options: (options) =&gt;
{
    options.JWTKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(<span class="hljs-string">"6ee3edbf-488e-4484-9c2c-e3ffa6dcbc09"</span>));
});
</code></pre>
<h4>الحصول على التوكن</h4>
<p>مثال XHR في جافاسكريبت للواجهة الأمامية</p>
<pre><code class="language-javascript hljs"><span class="hljs-keyword">var</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
  <span class="hljs-string">"username"</span>: <span class="hljs-string">"admin@mini-software.github.io"</span>,
  <span class="hljs-string">"password"</span>: <span class="hljs-string">"E7c4f679-f379-42bf-b547-684d456bc37f"</span>,
  <span class="hljs-string">"remember"</span>: <span class="hljs-literal">false</span>
});
<span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
xhr.<span class="hljs-property">withCredentials</span> = <span class="hljs-literal">true</span>;
xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"readystatechange"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">responseText</span>);
  }
});
xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"http://yourhost/miniauth/login"</span>);
xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);
xhr.<span class="hljs-title function_">send</span>(data);
</code></pre>
<p>الاستجابة</p>
<pre><code class="language-json hljs"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"ok"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"tokenType"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Bearer"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"accessToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1laWQiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYW1lIjoiYWRtaW5AbWluaS1zb2Z0d2FyZS5naXRodWIuaW8iLCJyb2xlIjoibWluaWF1dGgtYWRtaW4iLCJzdWIiOiJhZG1pbkBtaW5pLXNvZnR3YXJlLmdpdGh1Yi5pbyIsIm5iZiI6MTcxODIwNDg5NSwiZXhwIjoxNzE4MjA1Nzk1LCJpYXQiOjE3MTgyMDQ4OTUsImlzcyI6Ik1pbmlBdXRoIn0._-DQ_rcbeju8_nrK2lD5we0rre04_xdDZNF6NhM0Rg0"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"expiresIn"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">900</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>احفظ الـ <code>accessToken</code> في localstorage أو ككوكي. عند استدعاء API المؤمنة بـ [Authorize]، قم بتعيين الـ <code>Header Authorization</code> إلى <code>Bearer + مسافة + accessToken</code>، وسيتم التحقق تلقائيًا.</p>
<p>مثال:</p>
<pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
xhr.<span class="hljs-property">withCredentials</span> = <span class="hljs-literal">true</span>;
xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"readystatechange"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">responseText</span>);
  }
});
xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"http://yourhost:5014/your/api"</span>);
xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1laWQiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYW1lIjoiYWRtaW5AbWluaS1zb2Z0d2FyZS5naXRodWIuaW8iLCJyb2xlIjoibWluaWF1dGgtYWRtaW4iLCJzdWIiOiJhZG1pbkBtaW5pLXNvZnR3YXJlLmdpdGh1Yi5pbyIsIm5iZiI6MTcxODIwNDg5NSwiZXhwIjoxNzE4MjA1Nzk1LCJpYXQiOjE3MTgyMDQ4OTUsImlzcyI6Ik1pbmlBdXRoIn0._-DQ_rcbeju8_nrK2lD5we0rre04_xdDZNF6NhM0Rg0"</span>);
xhr.<span class="hljs-title function_">send</span>();
</code></pre>
<h4>تعيين مدة انتهاء الصلاحية</h4>
<pre><code class="language-c# hljs language-c">options.TokenExpiresIn = <span class="hljs-number">30</span> * <span class="hljs-number">60</span>; 
</code></pre>
<p>الوحدة بالثواني، والإعداد الافتراضي 30 دقيقة. لاحظ أيضًا أن .NET JWT ClockSkew في JwtBearerOptions مضبوط مسبقًا لإضافة 5 دقائق إضافية <a href="https://stackoverflow.com/questions/43045035/jwt-token-authentication-expired-tokens-still-working-net-core-web-api">السبب</a>.</p>
<h4>API لتحديث التوكن (JWT)</h4>
<p>API : <code>/MiniAuth/refreshToken</code><br>المحتوى:</p>
<pre><code class="language-json hljs"><span class="hljs-punctuation">{</span>
   <span class="hljs-attr">"refreshToken"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYmYiOjE3MTg1MjIxOTEsImV4cCI6MTcxODUyMzk5MSwiaWF0IjoxNzE4NTIyMTkxLCJpc3MiOiJNaW5pQXV0aCJ9.HYBWrM2suDiM4OG0FSlXhNgktZIG9l3ufmIAnwZiIoU"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>الهيدر:</p>
<pre><code class="hljs language-makefile"><span class="hljs-section">Authorization:Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW5AbWluaS1zb2Z0d2FyZS5naXRodWIuaW8iLCJyb2xlIjoibWluaWF1dGgtYWRtaW4iLCJzdWIiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYmYiOjE3MTg1MjIxOTEsImV4cCI6MTcxODUyNTc5MSwiaWF0IjoxNzE4NTIyMTkxLCJpc3MiOiJNaW5pQXV0aCJ9.rgAgsziAdLqOC9NYra-M9WQl8BJ99sRdfzRKNkMz9dk</span>
</code></pre>
<p>مدة الانتهاء مضبوطة على <code>MiniAuthOptions.TokenExpiresIn / 2</code>، والقيمة الافتراضية 30 دقيقة.</p>
<h3>الإعدادات، الخيارات، التخصيص</h3>
<h4>الوضع الافتراضي</h4>
<ul>
<li>الوضع الافتراضي لـ MiniAuth هو إدارة مركزية للمستخدمين من قبل مسؤولي تكنولوجيا المعلومات. عمليات مثل تسجيل المستخدم وإعادة تعيين كلمة المرور تتطلب حساب مدير مع الدور المحدد مسبقًا = miniauth-admin.</li>
</ul>
<h4>تعطيل تسجيل الدخول عبر MiniAuth</h4>
<p>إذا كنت ترغب فقط في استخدام منطق تسجيل الدخول الخاص بك، والصفحات، وواجهات API، يمكنك تحديد مسار تسجيل الدخول وإيقاف تشغيل تسجيل الدخول عبر MiniAuth.</p>
<pre><code class="language-C# hljs language-C"><span class="hljs-comment">// ضع هذا قبل تسجيل الخدمة</span>
builder.Services.AddMiniAuth(options: (options) =&gt;
{
    options.LoginPath = <span class="hljs-string">"/Identity/Account/Login"</span>;
    options.DisableMiniAuthLogin = <span class="hljs-literal">true</span>;
});
</code></pre>
<h4>تخصيص سلسلة الاتصال الافتراضية لـ SQLite</h4>
<pre><code class="language-C# hljs language-C">builder.Services.AddMiniAuth(options: (options) =&gt;
{
    options.SqliteConnectionString = <span class="hljs-string">"Data Source=miniauth_identity.db"</span>;
});
</code></pre>
<h3>قاعدة بيانات مخصصة، المستخدمون، والأدوار</h3>
<p>تم تصميم MiniAuth للعمل بسلاسة مع SQLite EF Core، وIdentityUser، وIdentityRole بشكل افتراضي. إذا كنت بحاجة إلى التبديل، يرجى تحديد قواعد بيانات مختلفة وفئات المستخدم والدور الخاصة بك باستخدام Generics في <code>app.UseMiniAuth</code>.</p>
<pre><code class="language-C# hljs language-C">app.UseMiniAuth&lt;YourDbContext, YourIdentityUser, YourIdentityRole&gt;();
</code></pre>
<h3>تسجيل الدخول، مصادقة المستخدم</h3>
<p>بالنسبة لغير ApiController، فإن إعادة التوجيه الافتراضية لتسجيل الدخول تكون إلى صفحة login.html (يتم تحديد ذلك من خلال التحقق من Headers["X-Requested-With"] == "XMLHttpRequest" أو وجود ApiControllerAttribute).<br>المتحكمات التي تم تعليمها بـ ApiController لا تعيد التوجيه إلى صفحة تسجيل الدخول افتراضيًا؛ بل تعيد رمز الحالة 401.</p>
<h3>واجهة أمامية مخصصة</h3>
<ul>
<li>توجد واجهة لوحة تحكم المشرف في <code>/src/Frontend_Identity</code> وتستخدم بشكل رئيسي Vue3 + Vite. عند تشغيل <code>npm run build</code> سيتم تحديث واجهة miniauth.</li>
<li>إذا لم ترغب في استخدام صفحة تسجيل الدخول الافتراضية لـ miniauth، يسمح لك MVC باستخدام Login.cshtml الذي توفره الهوية أو يمكنك تعديل ملفات login.html وjs وcss في الواجهة الأمامية لـ miniauth.</li>
</ul>
<h3>بادئة مسار مخصصة</h3>
<pre><code class="hljs language-javascript">builder.<span class="hljs-property">Services</span>.<span class="hljs-title class_">AddMiniAuth</span>(<span class="hljs-attr">options</span>: <span class="hljs-function">(<span class="hljs-params">options</span>) =&gt;</span>
{
    options.<span class="hljs-property">RoutePrefix</span> = <span class="hljs-string">"YourName"</span>;
});
</code></pre>
<p>بادئة المسار الافتراضية هي <code>MiniAuth</code>.</p>
<h3>واجهة برمجة تطبيقات تسجيل الدخول (JWT)</h3>
<p>API: <code>/MiniAuth/login</code></p>
<p>Body:</p>
<pre><code class="language-json hljs"><span class="hljs-punctuation">{</span>
   <span class="hljs-attr">"username"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"admin@mini-software.github.io"</span><span class="hljs-punctuation">,</span>
   <span class="hljs-attr">"password"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"E7c4f679-f379-42bf-b547-684d456bc37f"</span><span class="hljs-punctuation">,</span>
   <span class="hljs-attr">"remember"</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">false</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>الاستجابة: </p>
<pre><code class="language-json hljs"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"ok"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"tokenType"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Bearer"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"accessToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW5AbWluaS1zb2Z0d2FyZS5naXRodWIuaW8iLCJyb2xlIjoibWluaWF1dGgtYWRtaW4iLCJzdWIiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYmYiOjE3MTg1MjIxOTEsImV4cCI6MTcxODUyNTc5MSwiaWF0IjoxNzE4NTIyMTkxLCJpc3MiOiJNaW5pQXV0aCJ9.rgAgsziAdLqOC9NYra-M9WQl8BJ99sRdfzRKNkMz9dk"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"expiresIn"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3600</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"refreshToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYmYiOjE3MTg1MjIxOTEsImV4cCI6MTcxODUyMzk5MSwiaWF0IjoxNzE4NTIyMTkxLCJpc3MiOiJNaW5pQXV0aCJ9.HYBWrM2suDiM4OG0FSlXhNgktZIG9l3ufmIAnwZiIoU"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3>التسجيل</h3>
<p>يرجى استخدام واجهات برمجة التطبيقات والصفحات المدمجة للتسجيل التي يوفرها ASP.NET Core Identity.</p>
<h3>نسيت كلمة المرور</h3>
<p>يرجى استخدام واجهات برمجة التطبيقات والصفحات المدمجة لنسيان كلمة المرور التي يوفرها ASP.NET Core Identity.</p>
<h3>الحصول على معلومات المستخدم</h3>
<p>يرجى استخدام واجهات برمجة التطبيقات والصفحات المدمجة التي يوفرها ASP.NET Core Identity لاسترداد معلومات المستخدم. لاحظ أنه قد تحتاج إلى تنفيذ منطق إضافي أو نقاط نهاية للكشف عن بيانات المستخدم المطلوبة، حسب احتياجات تطبيقك المحددة. يوفر ASP.NET Core Identity إطار عمل قوي لإدارة معلومات المستخدم، بما في ذلك بيانات الملف الشخصي، والأدوار، والمطالبات.</p>
<h3>ملاحظات</h3>
<h4>الانتباه للترتيب</h4>
<p>يرجى وضع UseMiniAuth بعد توليد المسارات، وإلا فلن يتمكن النظام من الحصول على بيانات المسارات لفحص الأذونات، كما يلي:</p>
<pre><code class="language-c# hljs language-c">app.UseRouting();
app.UseMiniAuth();
</code></pre>
<h4>انتبه: يرجى إضافة قواعد الدور</h4>
<p>يرجى إضافة <code>AddRoles&lt;IdentityRole&gt;()</code>، وإلا لن تعمل <code>[Authorize(Roles = "permission")]</code>.</p>
<pre><code class="language-C# hljs language-C">builder.Services.AddDefaultIdentity&lt;IdentityUser&gt;(options =&gt; options.SignIn.RequireConfirmedAccount = <span class="hljs-literal">true</span>)
    .AddRoles&lt;IdentityRole&gt;() <span class="hljs-comment">// ❗❗❗ </span>
    .AddEntityFrameworkStores&lt;ApplicationDbContext&gt;();
</code></pre>
<h3>دمج MiniAuth في مشروع Identity قائم مع منطق مخصص</h3>
<p>عطّل autoUse في AddMiniAuth، وضع UseMiniAuth بعد المصادقة الخاصة بك، وبدّل المعاملات الجنريك بـ IdentityDBContext الخاص بك، والمستخدم، ومصادقة الأذونات الخاصة بك. إليك مثال:</p>
<pre><code class="language-csharp hljs">        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        {
            <span class="hljs-keyword">var</span> builder = WebApplication.CreateBuilder(args);

            <span class="hljs-keyword">var</span> connectionString = builder.Configuration.GetConnectionString(<span class="hljs-string">"DefaultConnection"</span>) ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidOperationException(<span class="hljs-string">"Connection string 'DefaultConnection' not found."</span>);
            builder.Services.AddDbContext&lt;ApplicationDbContext&gt;(options =&gt;
                options.UseSqlServer(connectionString));
            builder.Services.AddDatabaseDeveloperPageExceptionFilter();

            builder.Services.AddDefaultIdentity&lt;IdentityUser&gt;(options =&gt; options.SignIn.RequireConfirmedAccount = <span class="hljs-literal">true</span>)
                .AddRoles&lt;IdentityRole&gt;()
                .AddEntityFrameworkStores&lt;ApplicationDbContext&gt;();

            builder.Services.AddControllersWithViews();

            builder.Services.AddMiniAuth(autoUse: <span class="hljs-literal">false</span>); <span class="hljs-comment">// &lt;= ❗❗❗</span>


            <span class="hljs-keyword">var</span> app = builder.Build();

            app.UseMiniAuth&lt;ApplicationDbContext, IdentityUser, IdentityRole&gt;();  <span class="hljs-comment">// &lt;= ❗❗❗ </span>
            app.MapControllerRoute(
                name: <span class="hljs-string">"default"</span>,
                pattern: <span class="hljs-string">"{controller=Home}/{action=Index}/{id?}"</span>);
            app.MapRazorPages();

            app.Run();
        }
</code></pre>
<p>يسمح لك هذا بالتبديل بين استخدام المستخدمين، الأدوار، قاعدة البيانات، ومنطق الهوية الخاص بك.</p>
<h4>الأنظمة الموزعة</h4>
<ul>
<li>لمصادر قاعدة البيانات، ضع في اعتبارك التبديل إلى قواعد بيانات مثل SQL Server، MySQL، PostgreSQL، إلخ.</li>
<li>يوصى بالتبديل إلى طرق مصادقة مثل JWT لدمج أفضل في بيئة موزعة.</li>
</ul>
<h3>ملاحظات الإصدار</h3>
<p>راجع <a href="https://raw.githubusercontent.com/mini-software/MiniAuth/main/releases">ملاحظات الإصدار</a> للتحديثات.</p>
<h3>TODO</h3>
<p>الرابط: <a href="https://github.com/orgs/mini-software/projects/7/views/1">مشروع MiniAuth.Identify</a></p>
<pre><code class="hljs language-yaml">

<span class="hljs-meta">---

</span>
<span class="hljs-string">Tranlated</span> <span class="hljs-string">By</span> [<span class="hljs-string">Open</span> <span class="hljs-string">Ai</span> <span class="hljs-string">Tx</span>]<span class="hljs-string">(https://github.com/OpenAiTx/OpenAiTx)</span> <span class="hljs-string">|</span> <span class="hljs-attr">Last indexed:</span> <span class="hljs-number">2025-06-11</span>


<span class="hljs-meta">---
</span></code></pre>
</div>
    </div>

    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async=""></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
    


</body></html>