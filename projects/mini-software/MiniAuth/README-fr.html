<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniAuth - mini-software/MiniAuth</title>
    <meta name="title" content="MiniAuth - mini-software/MiniAuth">
    <meta name="description" content="mini-software/MiniAuth - GitHub repository fr documentation and informationEnglish | 简体中文 | 繁體中文 | 日本語 | 한국어 | Español Votre étoile, don, recommandation peuvent rendre MiniAuth meilleur Introduction « Un code en une ligne » ajoute une ...">
    <meta name="keywords" content="mini-software, MiniAuth, GitHub, repository, fr documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/mini-software/MiniAuth/README-fr.html">
    <meta property="og:title" content="MiniAuth - mini-software/MiniAuth">
    <meta property="og:description" content="mini-software/MiniAuth - GitHub repository fr documentation and information">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/mini-software/MiniAuth" id="githubRepoLink" target="_blank">mini-software/MiniAuth</a>
<h1 style="display: none;">English | 简体中文 | 繁體中文 | 日本語 | 한국어 | Español Votre étoile, don, recommandation peuvent rendre MiniAuth meilleur Introduction « Un code en une ligne » ajoute une ...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <div align="center">
<p><a href="https://www.nuget.org/packages/MiniAuth"><img src="https://img.shields.io/nuget/v/MiniAuth.svg" alt="NuGet"></a>  <a href="https://www.nuget.org/packages/MiniAuth"><img src="https://img.shields.io/nuget/dt/MiniAuth.svg" alt=""></a>  
<a href="https://gitee.com/shps951023/MiniAuth"><img src="https://gitee.com/shps951023/MiniAuth/badge/star.svg" alt="star"></a> <a href="https://github.com/Mini-Software/MiniAuth" rel="nofollow"><img src="https://img.shields.io/github/stars/Mini-Software/MiniAuth?logo=github" alt="GitHub stars"></a> <a href="https://www.nuget.org/packages/MiniAuth"><img src="https://img.shields.io/badge/.NET-%3E%3D%206.0-red.svg" alt="version"></a>
</p>
</div>
<hr />
<div align="center">
<p><strong>
    <a href="README.md">English</a> | <a href="README.zh-CN.md">简体中文</a> | <a href="README.zh-Hant.md">繁體中文</a> | <a href="README.ja.md">日本語</a> | <a href="README.ko.md">한국어</a> | <a href="README.es.md">Español</a>  
</strong></p>
</div>
<hr />
<div align="center">
 Votre <a href="https://github.com/mini-software/miniauth">étoile</a>, <a href="https://miniexcel.github.io/">don</a>, <a href="https://www.linkedin.com/in/itweihan/">recommandation</a> peuvent rendre MiniAuth meilleur 
</div>
<h3>Introduction</h3>
<p>« Un code en une ligne » ajoute une gestion web des utilisateurs/rôles asp.net core identity à vos projets neufs ou existants</p>
<table>
    <tr>
        <td><img src="https://github.com/mini-software/MiniExcel/assets/12729184/d2aec694-158d-4ebc-bd8b-0e9ae1f855ac" alt="Image 1"></td>
        <td><img src="https://github.com/mini-software/MiniAuth/assets/12729184/2f791e25-9158-495e-9383-4fbedf9b982b" alt="Image 2"></td>
    </tr>
    <tr>
        <td><img src="https://github.com/mini-software/MiniAuth/assets/12729184/03d72ed7-8fb9-465f-9093-24b00279eeb2" alt="Image 3"></td>
        <td><img src="https://github.com/mini-software/MiniAuth/assets/12729184/841df179-7e5f-481a-9039-46738b20aa2e" alt="Image 4"></td>
    </tr>
</table>
<h3>Fonctionnalités</h3>
<ul>
<li>Compatibilité : Prend en charge .NET Identity basé sur JWT, Cookie, Session, etc.</li>
<li>Simplicité : Conception plug-and-play, API, SPA, MVC, Razor Page, etc.</li>
<li>Prise en charge de plusieurs bases de données : Oracle, SQL Server, MySQL, etc. via EF Core</li>
<li>Non intrusif : N’affecte pas les bases de données existantes ou la structure du projet</li>
<li>Multi-plateforme : Prend en charge les environnements Linux, macOS</li>
</ul>
<h3>Installation</h3>
<p>Installez le package depuis NuGet</p>
<h3>Démarrage rapide</h3>
<p>Ajoutez une seule ligne de code <code>services.AddMiniAuth()</code> dans Startup, puis lancez votre projet. Exemple :</p>
<pre><code class="language-csharp">public class Program
{
    public static void Main(string[] args)
    {
        var builder = WebApplication.CreateBuilder(args);

        builder.Services.AddMiniAuth(); // &lt;= ❗❗❗

        var app = builder.Build();
        app.Run();
    }
}
</code></pre>
<p>Le compte admin par défaut est <code>admin@mini-software.github.io</code> avec le mot de passe <code>E7c4f679-f379-42bf-b547-684d456bc37f</code> (n’oubliez pas de modifier le mot de passe). La page d’administration est accessible à l’adresse <code>http(s)://votrehost/miniauth/index.html</code>.</p>
<p>Ajoutez <code>[Authorize]</code> aux catégories ou méthodes nécessitant une gestion des autorisations, ou un contrôle de rôle <code>[Authorize(Roles = &quot;role&quot;)]</code>, renvoie un statut 401 si non connecté, et 403 si non autorisé.</p>
<h3>MiniAuth Cookie Identity</h3>
<p>MiniAuth est préconfiguré en mode identité basée sur un seul Cookie. Pour les projets front-end/back-end séparés, veuillez changer pour JWT, etc.</p>
<h3>MiniAuth JWT Identity</h3>
<p>Définir AuthenticationType = BearerJwt</p>
<pre><code class="language-C#">builder.Services.AddMiniAuth(options:(options) =&gt;
{
    options.AuthenticationType = MiniAuthOptions.AuthType.BearerJwt;
});
</code></pre>
<p>Veuillez penser à définir une nouvelle clé de sécurité JWT, par exemple :</p>
<pre><code class="language-C#">builder.Services.AddMiniAuth(options: (options) =&gt;
{
    options.JWTKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(&quot;6ee3edbf-488e-4484-9c2c-e3ffa6dcbc09&quot;));
});
</code></pre>
<h4>Récupération du token</h4>
<p>Exemple Javascript XHR côté front-end</p>
<pre><code class="language-javascript">var data = JSON.stringify({
  &quot;username&quot;: &quot;admin@mini-software.github.io&quot;,
  &quot;password&quot;: &quot;E7c4f679-f379-42bf-b547-684d456bc37f&quot;,
  &quot;remember&quot;: false
});
var xhr = new XMLHttpRequest();
xhr.withCredentials = true;
xhr.addEventListener(&quot;readystatechange&quot;, function() {
  if(this.readyState === 4) {
    console.log(this.responseText);
  }
});
xhr.open(&quot;POST&quot;, &quot;http://yourhost/miniauth/login&quot;);
xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/json&quot;);
xhr.send(data);
</code></pre>
<p>réponse</p>
<pre><code class="language-json">{
    &quot;ok&quot;: true,
    &quot;code&quot;: 200,
    &quot;message&quot;: null,
    &quot;data&quot;: {
        &quot;tokenType&quot;: &quot;Bearer&quot;,
        &quot;accessToken&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1laWQiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYW1lIjoiYWRtaW5AbWluaS1zb2Z0d2FyZS5naXRodWIuaW8iLCJyb2xlIjoibWluaWF1dGgtYWRtaW4iLCJzdWIiOiJhZG1pbkBtaW5pLXNvZnR3YXJlLmdpdGh1Yi5pbyIsIm5iZiI6MTcxODIwNDg5NSwiZXhwIjoxNzE4MjA1Nzk1LCJpYXQiOjE3MTgyMDQ4OTUsImlzcyI6Ik1pbmlBdXRoIn0._-DQ_rcbeju8_nrK2lD5we0rre04_xdDZNF6NhM0Rg0&quot;,
        &quot;expiresIn&quot;: 900
    }
}
</code></pre>
<p>Sauvegardez le <code>accessToken</code> dans le localstorage ou un cookie. Lors de l’appel de votre API [Authorize], définissez le <code>Header Authorization</code> sur <code>Bearer + espace + accessToken</code>, le système le vérifiera automatiquement.</p>
<p>Exemple :</p>
<pre><code class="language-js">var xhr = new XMLHttpRequest();
xhr.withCredentials = true;
xhr.addEventListener(&quot;readystatechange&quot;, function() {
  if(this.readyState === 4) {
    console.log(this.responseText);
  }
});
xhr.open(&quot;GET&quot;, &quot;http://yourhost:5014/your/api&quot;);
xhr.setRequestHeader(&quot;Authorization&quot;, &quot;Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1laWQiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYW1lIjoiYWRtaW5AbWluaS1zb2Z0d2FyZS5naXRodWIuaW8iLCJyb2xlIjoibWluaWF1dGgtYWRtaW4iLCJzdWIiOiJhZG1pbkBtaW5pLXNvZnR3YXJlLmdpdGh1Yi5pbyIsIm5iZiI6MTcxODIwNDg5NSwiZXhwIjoxNzE4MjA1Nzk1LCJpYXQiOjE3MTgyMDQ4OTUsImlzcyI6Ik1pbmlBdXRoIn0._-DQ_rcbeju8_nrK2lD5we0rre04_xdDZNF6NhM0Rg0&quot;);
xhr.send();
</code></pre>
<h4>Définir la durée d’expiration</h4>
<pre><code class="language-c#">options.TokenExpiresIn = 30 * 60; 
</code></pre>
<p>L’unité est en secondes, la valeur par défaut est 30 minutes. Notez également que le ClockSkew JWT de .NET dans JwtBearerOptions est préconfiguré pour ajouter 5 minutes supplémentaires <a href="https://stackoverflow.com/questions/43045035/jwt-token-authentication-expired-tokens-still-working-net-core-web-api">raison</a>.</p>
<h4>API de rafraîchissement du token (JWT)</h4>
<p>API : <code>/MiniAuth/refreshToken</code>
Body :</p>
<pre><code class="language-json">{
   &quot;refreshToken&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYmYiOjE3MTg1MjIxOTEsImV4cCI6MTcxODUyMzk5MSwiaWF0IjoxNzE4NTIyMTkxLCJpc3MiOiJNaW5pQXV0aCJ9.HYBWrM2suDiM4OG0FSlXhNgktZIG9l3ufmIAnwZiIoU&quot;
}
</code></pre>
<p>Header :</p>
<pre><code>Authorization:Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW5AbWluaS1zb2Z0d2FyZS5naXRodWIuaW8iLCJyb2xlIjoibWluaWF1dGgtYWRtaW4iLCJzdWIiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYmYiOjE3MTg1MjIxOTEsImV4cCI6MTcxODUyNTc5MSwiaWF0IjoxNzE4NTIyMTkxLCJpc3MiOiJNaW5pQXV0aCJ9.rgAgsziAdLqOC9NYra-M9WQl8BJ99sRdfzRKNkMz9dk
</code></pre>
<p>La durée d’expiration est définie à <code>MiniAuthOptions.TokenExpiresIn / 2</code>, valeur par défaut 30 minutes.</p>
<h3>Paramètres, options, personnalisation</h3>
<h4>Mode par défaut</h4>
<ul>
<li>Le mode par défaut de MiniAuth est la gestion centralisée des utilisateurs par les administrateurs IT. Les opérations telles que l’inscription d’utilisateurs et la réinitialisation des mots de passe nécessitent un compte administrateur avec le rôle prédéfini = miniauth-admin.</li>
</ul>
<h4>Désactiver la connexion MiniAuth</h4>
<p>Si vous souhaitez uniquement utiliser votre propre logique de connexion, vos pages et API, vous pouvez spécifier le chemin d’accès à la connexion et désactiver la connexion MiniAuth.</p>
<pre><code class="language-C#">// À placer avant l’enregistrement du service
builder.Services.AddMiniAuth(options: (options) =&gt;
{
    options.LoginPath = &quot;/Identity/Account/Login&quot;;
    options.DisableMiniAuthLogin = true;
});
</code></pre>
<h4>Personnaliser la chaîne de connexion SQLite par défaut</h4>
<pre><code class="language-C#">builder.Services.AddMiniAuth(options: (options) =&gt;
{
    options.SqliteConnectionString = &quot;Data Source=miniauth_identity.db&quot;;
});
</code></pre>
<h3>Base de données, utilisateurs et rôles personnalisés</h3>
<p>MiniAuth est conçu pour fonctionner parfaitement avec SQLite EF Core, IdentityUser et IdentityRole par défaut. Si vous devez changer, veuillez spécifier différentes bases de données et vos propres classes utilisateur et rôle en utilisant les génériques dans <code>app.UseMiniAuth</code>.</p>
<pre><code class="language-C#">app.UseMiniAuth&lt;YourDbContext, YourIdentityUser, YourIdentityRole&gt;();
</code></pre>
<h3>Connexion, authentification utilisateur</h3>
<p>Pour les contrôleurs non-ApiController, la redirection de connexion par défaut est vers la page login.html (déterminée en vérifiant si Headers[&quot;X-Requested-With&quot;] == &quot;XMLHttpRequest&quot; ou la présence de l’ApiControllerAttribute).
Les contrôleurs marqués ApiController ne redirigent pas par défaut vers une page de connexion ; ils renvoient un code d’état 401.</p>
<h3>Frontend personnalisé</h3>
<ul>
<li>Le frontend du tableau de bord d’administration se trouve dans <code>/src/Frontend_Identity</code> et utilise principalement Vue3 + Vite. L’exécution de <code>npm run build</code> mettra à jour l’UI de miniauth.</li>
<li>Si vous ne souhaitez pas utiliser la page de connexion miniauth par défaut, MVC vous permet d’utiliser le Login.cshtml généré par identity, ou vous pouvez modifier les fichiers login.html, js et css du frontend miniauth.</li>
</ul>
<h3>Préfixe de route personnalisé</h3>
<pre><code>builder.Services.AddMiniAuth(options: (options) =&gt;
{
    options.RoutePrefix = &quot;YourName&quot;;
});
</code></pre>
<p>Le RoutePrefix par défaut est <code>MiniAuth</code>.</p>
<h3>API de connexion (JWT)</h3>
<p>API : <code>/MiniAuth/login</code></p>
<p>Body :</p>
<pre><code class="language-json">{
   &quot;username&quot;:&quot;admin@mini-software.github.io&quot;,
   &quot;password&quot;:&quot;E7c4f679-f379-42bf-b547-684d456bc37f&quot;,
   &quot;remember&quot;:false
}
</code></pre>
<p>Réponse :</p>
<pre><code class="language-json">{
    &quot;ok&quot;: true,
    &quot;code&quot;: 200,
    &quot;message&quot;: null,
    &quot;data&quot;: {
        &quot;tokenType&quot;: &quot;Bearer&quot;,
        &quot;accessToken&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW5AbWluaS1zb2Z0d2FyZS5naXRodWIuaW8iLCJyb2xlIjoibWluaWF1dGgtYWRtaW4iLCJzdWIiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYmYiOjE3MTg1MjIxOTEsImV4cCI6MTcxODUyNTc5MSwiaWF0IjoxNzE4NTIyMTkxLCJpc3MiOiJNaW5pQXV0aCJ9.rgAgsziAdLqOC9NYra-M9WQl8BJ99sRdfzRKNkMz9dk&quot;,
        &quot;expiresIn&quot;: 3600,
        &quot;refreshToken&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxZTIxOGY4My1iZjE3LTRhY2YtODhmOS1iOTQ3NjhjOWUwMGMiLCJuYmYiOjE3MTg1MjIxOTEsImV4cCI6MTcxODUyMzk5MSwiaWF0IjoxNzE4NTIyMTkxLCJpc3MiOiJNaW5pQXV0aCJ9.HYBWrM2suDiM4OG0FSlXhNgktZIG9l3ufmIAnwZiIoU&quot;
    }
}
</code></pre>
<h3>Inscription</h3>
<p>Veuillez utiliser l’API d’inscription et les pages intégrées fournies par ASP.NET Core Identity.</p>
<h3>Mot de passe oublié</h3>
<p>Veuillez utiliser l’API et les pages intégrées de récupération de mot de passe fournies par ASP.NET Core Identity.</p>
<h3>Obtenir les informations de l’utilisateur</h3>
<p>Veuillez utiliser les API et pages intégrées fournies par ASP.NET Core Identity pour récupérer les informations utilisateur. Notez que vous devrez peut-être implémenter une logique ou des points de terminaison supplémentaires pour exposer les données utilisateur requises, selon les besoins spécifiques de votre application. ASP.NET Core Identity fournit un cadre robuste pour la gestion des informations utilisateur, y compris les données de profil, les rôles et les claims.</p>
<h3>Remarques</h3>
<h4>Attention à l’ordre</h4>
<p>Veuillez placer UseMiniAuth après la génération des routes, sinon le système ne pourra pas obtenir les données de routage pour les vérifications d’autorisation, comme suit :</p>
<pre><code class="language-c#">app.UseRouting();
app.UseMiniAuth();
</code></pre>
<h4>Attention : veuillez ajouter les règles de rôle</h4>
<p>Veuillez ajouter <code>AddRoles&lt;IdentityRole&gt;()</code>, sinon <code>[Authorize(Roles = &quot;permission&quot;)]</code> ne fonctionnera pas.</p>
<pre><code class="language-C#">builder.Services.AddDefaultIdentity&lt;IdentityUser&gt;(options =&gt; options.SignIn.RequireConfirmedAccount = true)
    .AddRoles&lt;IdentityRole&gt;() // ❗❗❗ 
    .AddEntityFrameworkStores&lt;ApplicationDbContext&gt;();
</code></pre>
<h3>Intégration de MiniAuth dans un projet Identity existant avec logique personnalisée</h3>
<p>Désactivez l’autoUse de AddMiniAuth, et placez UseMiniAuth après votre propre authentification, en remplaçant les paramètres génériques par votre propre IdentityDBContext, utilisateur et logique d’authentification des permissions. Voici un exemple :</p>
<pre><code class="language-csharp">        public static void Main(string[] args)
        {
            var builder = WebApplication.CreateBuilder(args);

            var connectionString = builder.Configuration.GetConnectionString(&quot;DefaultConnection&quot;) ?? throw new InvalidOperationException(&quot;Connection string 'DefaultConnection' not found.&quot;);
            builder.Services.AddDbContext&lt;ApplicationDbContext&gt;(options =&gt;
                options.UseSqlServer(connectionString));
            builder.Services.AddDatabaseDeveloperPageExceptionFilter();

            builder.Services.AddDefaultIdentity&lt;IdentityUser&gt;(options =&gt; options.SignIn.RequireConfirmedAccount = true)
                .AddRoles&lt;IdentityRole&gt;()
                .AddEntityFrameworkStores&lt;ApplicationDbContext&gt;();

            builder.Services.AddControllersWithViews();

            builder.Services.AddMiniAuth(autoUse: false); // &lt;= ❗❗❗


            var app = builder.Build();

            app.UseMiniAuth&lt;ApplicationDbContext, IdentityUser, IdentityRole&gt;();  // &lt;= ❗❗❗ 
            app.MapControllerRoute(
                name: &quot;default&quot;,
                pattern: &quot;{controller=Home}/{action=Index}/{id?}&quot;);
            app.MapRazorPages();

            app.Run();
        }
</code></pre>
<p>Cela vous permet de basculer entre vos propres utilisateurs, rôles, base de données et logique Identity.</p>
<h4>Systèmes distribués</h4>
<ul>
<li>Pour les sources de base de données, envisagez de passer à des bases telles que SQL Server, MySQL, PostgreSQL, etc.</li>
<li>Il est recommandé de passer à des méthodes d’authentification comme JWT pour une meilleure intégration dans un environnement distribué.</li>
</ul>
<h3>Notes de version</h3>
<p>Consultez les <a href="releases">Notes de version</a> pour les mises à jour.</p>
<h3>TODO</h3>
<p>Lien : <a href="https://github.com/orgs/mini-software/projects/7/views/1">Projet MiniAuth.Identify</a></p>
<pre><code>

---


Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-06-11


---
</code></pre>

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Statcounter and other scripts can be added here -->
</body>
</html>