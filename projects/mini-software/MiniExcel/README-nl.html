<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniExcel - mini-software/MiniExcel nl</title>
    <meta name="title" content="MiniExcel - mini-software/MiniExcel nl | Dit project maakt deel uit van de .NET Foundation en opereert onder hun gedragscode. English | 简体中文 | 繁體中文 | 日本語 | 한국어 | हिन्दी | ไทย | Français | Deutsch | Esp...">
    <meta name="description" content="mini-software/MiniExcel - GitHub repository nl documentation and information | Dit project maakt deel uit van de .NET Foundation en opereert onder hun gedragscode. English | 简体中文 | 繁體中文 | 日本語 | 한국어 | हिन्दी | ไทย | Français | Deutsch | Esp...">
    <meta name="keywords" content="mini-software, MiniExcel, GitHub, repository, nl documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/mini-software/MiniExcel/README-nl.html">
    <meta property="og:title" content="MiniExcel - mini-software/MiniExcel nl | Dit project maakt deel uit van de .NET Foundation en opereert onder hun gedragscode. English | 简体中文 | 繁體中文 | 日本語 | 한국어 | हिन्दी | ไทย | Français | Deutsch | Esp...">
    <meta property="og:description" content="mini-software/MiniExcel - GitHub repository nl documentation and information | Dit project maakt deel uit van de .NET Foundation en opereert onder hun gedragscode. English | 简体中文 | 繁體中文 | 日本語 | 한국어 | हिन्दी | ไทย | Français | Deutsch | Esp...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div style="position: fixed; top: 2px; left: 2px; z-index: 2000; background: rgba(255,255,255,0.95); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 4px 14px; font-size: 15px; color: #222; font-family: 'Segoe UI', Arial, sans-serif; font-weight: 500; letter-spacing: 0.5px;">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: 600;">Open AI Tx</a>
    </div>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/mini-software/MiniExcel" id="githubRepoLink" target="_blank">mini-software/MiniExcel</a>
<h1 style="display: none;">Dit project maakt deel uit van de .NET Foundation en opereert onder hun gedragscode. English | 简体中文 | 繁體中文 | 日本語 | 한국어 | हिन्दी | ไทย | Français | Deutsch | Esp...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <div align="center">
<p><a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/nuget/v/MiniExcel.svg" alt="NuGet"></a>  <a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/nuget/dt/MiniExcel.svg" alt=""></a>
<a href="https://ci.appveyor.com/project/mini-software/miniexcel/branch/master"><img src="https://ci.appveyor.com/api/projects/status/b2vustrwsuqx45f4/branch/master?svg=true" alt="Build status"></a>
<a href="https://gitee.com/dotnetchina/MiniExcel"><img src="https://gitee.com/dotnetchina/MiniExcel/badge/star.svg" alt="star"></a> <a href="https://github.com/mini-software/MiniExcel" rel="nofollow"><img src="https://img.shields.io/github/stars/mini-software/MiniExcel?logo=github" alt="GitHub stars"></a>
<a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/badge/.NET-%3E%3D%204.5-red.svg" alt="version"></a>
<a href="https://deepwiki.com/mini-software/MiniExcel"><img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki"></a>
</p>
</div>
<hr />
<p><a href="https://www.dotnetfoundation.org/"><img align="right" src="https://github.com/dotnet-foundation/swag/blob/main/logo/dotnetfoundation_v4.png?raw=true" width="100" /></a></p>
<div align="center">
<p>Dit project maakt deel uit van de <a href="https://www.dotnetfoundation.org/">.NET Foundation</a> en opereert onder hun <a href="https://www.dotnetfoundation.org/code-of-conduct">gedragscode</a>. </p>
</div>
<hr />
<div align="center">
<p><strong><a href="README.md">English</a> | <a href="README.zh-CN.md">简体中文</a> | <a href="README.zh-Hant.md">繁體中文</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=ja">日本語</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=ko">한국어</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=hi">हिन्दी</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=th">ไทย</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=fr">Français</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=de">Deutsch</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=es">Español</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=it">Italiano</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=ru">Русский</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=pt">Português</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=nl">Nederlands</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=pl">Polski</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=ar">العربية</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=fa">فارسی</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=tr">Türkçe</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=vi">Tiếng Việt</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=id">Bahasa Indonesia</a><p></p>
</strong></p>
</div>
<hr />
<div align="center">
 Jouw <a href="https://github.com/mini-software/MiniExcel">Sterren</a> of <a href="https://miniexcel.github.io">Donaties</a> kunnen MiniExcel beter maken
</div>
<hr />
<h3>Introductie</h3>
<p>MiniExcel is een eenvoudige en efficiënte Excel-verwerkingstool voor .NET, speciaal ontworpen om het geheugengebruik te minimaliseren.</p>
<p>Op dit moment moeten de meeste populaire frameworks alle gegevens uit een Excel-document in het geheugen laden om bewerkingen mogelijk te maken, maar dit kan problemen met geheugenverbruik veroorzaken. De aanpak van MiniExcel is anders: de gegevens worden rij voor rij verwerkt in een streaming-manier, waardoor het oorspronkelijke verbruik van mogelijk honderden megabytes wordt teruggebracht tot slechts enkele megabytes, wat effectief OOM-problemen (out-of-memory) voorkomt.</p>
<p><img src="https://github.com/user-attachments/assets/0b99a61e-8061-4604-8957-0b1f3ec74544" alt="Screenshot 2025-06-22 123525" /></p>
<h3>Kenmerken</h3>
<ul>
<li>Minimaliseert geheugengebruik, voorkomt out-of-memory (OOM) fouten en vermijdt volledige garbage collections</li>
<li>Maakt real-time, rij-niveau data-operaties mogelijk voor betere prestaties met grote datasets</li>
<li>Ondersteunt LINQ met uitgestelde uitvoering, waardoor snelle, geheugen-efficiënte paging en complexe queries mogelijk zijn</li>
<li>Lichtgewicht, zonder dat Microsoft Office of COM+ componenten nodig zijn, en een DLL-grootte onder de 500KB</li>
<li>Eenvoudige en intuïtieve API-stijl om excel te lezen/schrijven/invullen</li>
</ul>
<h3>Aan de slag</h3>
<ul>
<li><p><a href="#getstart1">Importeer/Query Excel</a></p>
</li>
<li><p><a href="#getstart2">Exporteer/Creëer Excel</a></p>
</li>
<li><p><a href="#getstart3">Excel Sjabloon</a></p>
</li>
<li><p><a href="#getstart4">Excel Kolomnaam/Index/Ignore Attribuut</a></p>
</li>
<li><p><a href="#getstart5">Voorbeelden</a></p>
</li>
</ul>
<h3>Installatie</h3>
<p>Je kunt het pakket <a href="https://www.nuget.org/packages/MiniExcel">van NuGet installeren</a></p>
<h3>Release-opmerkingen</h3>
<p>Bekijk de <a href="docs">Release-opmerkingen</a></p>
<h3>TODO</h3>
<p>Bekijk <a href="https://github.com/mini-software/MiniExcel/projects/1?fullscreen=true">TODO</a></p>
<h3>Prestaties</h3>
<p>De code voor de benchmarks is te vinden in <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/benchmarks/MiniExcel.Benchmarks/Program.cs">MiniExcel.Benchmarks</a>.</p>
<p>Het bestand dat wordt gebruikt om de prestaties te testen is <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/benchmarks/MiniExcel.Benchmarks/Test1%2C000%2C000x10.xlsx"><strong>Test1,000,000x10.xlsx</strong></a>, een document van 32MB met 1.000.000 rijen * 10 kolommen waarvan de cellen zijn gevuld met de string &quot;HelloWorld&quot;.</p>
<p>Om alle benchmarks uit te voeren gebruik je:</p>
<pre><code class="language-bash">dotnet run -project .\benchmarks\MiniExcel.Benchmarks -c Release -f net9.0 -filter * --join
</code></pre>
<p>Je kunt de benchmarkresultaten voor de laatste release <a href="benchmarks/results">hier vinden</a>.</p>
<h3>Excel Query/Importeren  <a name="getstart1"></a></h3>
<h4>1. Voer een query uit en koppel de resultaten aan een sterk getypeerde IEnumerable <a href="https://dotnetfiddle.net/w5WD1J">[Probeer het]</a></h4>
<p>Aanbevolen om Stream.Query te gebruiken vanwege de betere efficiëntie.</p>
<pre><code class="language-csharp">public class UserAccount
{
```csharp
public Guid ID { get; set; }
public string Name { get; set; }
public DateTime BoD { get; set; }
public int Age { get; set; }
public bool VIP { get; set; }
public decimal Points { get; set; }
}

var rijen = MiniExcel.Query&lt;UserAccount&gt;(pad);

// of

using (var stream = File.OpenRead(pad))
    var rijen = stream.Query&lt;UserAccount&gt;();
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/111107423-c8c46b80-8591-11eb-982f-c97a2dafb379.png" alt="image" /></p>
<h4>2. Voer een query uit en koppel het aan een lijst van dynamische objecten zonder header te gebruiken <a href="https://dotnetfiddle.net/w5WD1J">[Probeer het]</a></h4>
<ul>
<li>dynamische sleutel is <code>A.B.C.D..</code></li>
</ul>
<p>| MiniExcel | 1 |
|-----------|---|
| Github    | 2 |</p>
<pre><code class="language-csharp">
var rijen = MiniExcel.Query(pad).ToList();

// of
using (var stream = File.OpenRead(pad))
{
    var rijen = stream.Query().ToList();

    Assert.Equal(&quot;MiniExcel&quot;, rijen[0].A);
    Assert.Equal(1, rijen[0].B);
    Assert.Equal(&quot;Github&quot;, rijen[1].A);
    Assert.Equal(2, rijen[1].B);
}
</code></pre>
<h4>3. Voer een query uit met de eerste rij als header <a href="https://dotnetfiddle.net/w5WD1J">[Probeer het]</a></h4>
<p>opmerking: bij dezelfde kolomnaam wordt de meest rechtse gebruikt</p>
<p>Invoer Excel :</p>
<p>| Kolom1    | Kolom2  |
|-----------|---------|
| MiniExcel | 1       |
| Github    | 2       |</p>
<pre><code class="language-csharp">
var rijen = MiniExcel.Query(useHeaderRow:true).ToList();

// of

using (var stream = File.OpenRead(pad))
{
    var rijen = stream.Query(useHeaderRow:true).ToList();

    Assert.Equal(&quot;MiniExcel&quot;, rijen[0].Column1);
    Assert.Equal(1, rijen[0].Column2);
    Assert.Equal(&quot;Github&quot;, rijen[1].Column1);
    Assert.Equal(2, rijen[1].Column2);
}
</code></pre>
<h4>4. Query ondersteunt LINQ-extensie First/Take/Skip ...etc</h4>
<p>Query First</p>
<pre><code class="language-csharp">var rij = MiniExcel.Query(pad).First();
Assert.Equal(&quot;HelloWorld&quot;, rij.A);

// of

using (var stream = File.OpenRead(pad))
{
    var rij = stream.Query().First();
    Assert.Equal(&quot;HelloWorld&quot;, rij.A);
}
</code></pre>
<p>Prestaties tussen MiniExcel/ExcelDataReader/ClosedXML/EPPlus
<img src="https://user-images.githubusercontent.com/12729184/111072392-6037a900-8515-11eb-9693-5ce2dad1e460.gif" alt="queryfirst" /></p>
<h4>5. Query op bladnaam</h4>
<pre><code class="language-csharp">MiniExcel.Query(pad, sheetName: &quot;SheetName&quot;);
//of
stream.Query(sheetName: &quot;SheetName&quot;);
</code></pre>
<h4>6. Query alle bladnamen en rijen</h4>
<pre><code>```csharp
var sheetNames = MiniExcel.GetSheetNames(path);
foreach (var sheetName in sheetNames)
{
    var rows = MiniExcel.Query(path, sheetName: sheetName);
}
</code></pre>
<h4>7. Kolommen ophalen</h4>
<pre><code class="language-csharp">var columns = MiniExcel.GetColumns(path); // bijv. resultaat : [&quot;A&quot;,&quot;B&quot;...]

var cnt = columns.Count;  // aantal kolommen ophalen
</code></pre>
<h4>8. Dynamische Query converteert rij naar <code>IDictionary&lt;string,object&gt;</code></h4>
<pre><code class="language-csharp">foreach(IDictionary&lt;string,object&gt; row in MiniExcel.Query(path))
{
    //..
}

// of
var rows = MiniExcel.Query(path).Cast&lt;IDictionary&lt;string,object&gt;&gt;();
// of Query opgegeven bereiken (met hoofdletters)
// A2 vertegenwoordigt de tweede rij van kolom A, C3 vertegenwoordigt de derde rij van kolom C
// Als je de rijen niet wilt beperken, laat dan gewoon de cijfers weg
var rows = MiniExcel.QueryRange(path, startCell: &quot;A2&quot;, endCell: &quot;C3&quot;).Cast&lt;IDictionary&lt;string, object&gt;&gt;();
</code></pre>
<h4>9. Query Excel retourneert DataTable</h4>
<p>Niet aanbevolen, omdat DataTable alle data in het geheugen laadt en daarmee het lage geheugengebruik van MiniExcel verloren gaat.</p>
<pre><code class="language-C#">var table = MiniExcel.QueryAsDataTable(path, useHeaderRow: true);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/116673475-07917200-a9d6-11eb-947e-a6f68cce58df.png" alt="image" /></p>
<h4>10. Specificeer de cel om te beginnen met het lezen van data</h4>
<pre><code class="language-csharp">MiniExcel.Query(path,useHeaderRow:true,startCell:&quot;B3&quot;)
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/117260316-8593c400-ae81-11eb-9877-c087b7ac2b01.png" alt="image" /></p>
<h4>11. Samengevoegde cellen vullen</h4>
<p>Let op: De efficiëntie is lager vergeleken met <code>geen merge fill gebruiken</code></p>
<p>Reden: De OpenXml-standaard plaatst mergeCells onderaan het bestand, waardoor het nodig is om twee keer door de sheetxml te lopen</p>
<pre><code class="language-csharp">    var config = new OpenXmlConfiguration()
    {
        FillMergedCells = true
    };
    var rows = MiniExcel.Query(path, configuration: config);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/117973630-3527d500-b35f-11eb-95c3-bde255f8114e.png" alt="image" /></p>
<p>ondersteunt variabele lengte en breedte voor het vullen van meerdere rijen en kolommen</p>
<p><img src="https://user-images.githubusercontent.com/12729184/117973820-6d2f1800-b35f-11eb-88d8-555063938108.png" alt="image" /></p>
<h4>12. Grote bestanden lezen via disk-gebaseerde cache (Disk-Base Cache - SharedString)</h4>
<p>Als de SharedStrings-grootte groter is dan 5 MB, zal MiniExcel standaard lokale schijfcache gebruiken, bijv. <a href="https://github.com/MiniExcel/MiniExcel/files/8403819/NotDuplicateSharedStrings_10x100000.xlsx">10x100000.xlsx</a>(een miljoen rijen data), als de schijfcache is uitgeschakeld is het maximale geheugengebruik 195MB, maar met ingeschakelde schijfcache is slechts 65MB nodig. Let op, deze optimalisatie kost wat efficiëntie, dus in dit geval zal de leestijd stijgen van 7,4 seconden naar 27,2 seconden. Als je dit niet nodig hebt kun je de schijfcache uitschakelen met de volgende code:</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration { EnableSharedStringCache = false };
MiniExcel.Query(path,configuration: config)
</code></pre>
<p>Je kunt <code>SharedStringCacheSize</code> gebruiken om de sharedString-bestandsgrootte te wijzigen waarna schijfcaching gebruikt wordt</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration { SharedStringCacheSize=500*1024*1024 };
MiniExcel.Query(path, configuration: config);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/161411851-1c3f72a7-33b3-4944-84dc-ffc1d16747dd.png" alt="image" /></p>
<p><img src="https://user-images.githubusercontent.com/12729184/161411825-17f53ec7-bef4-4b16-b234-e24799ea41b0.png" alt="image" /></p>
<pre><code>### Maak/Exporteer Excel  &lt;a name=&quot;getstart2&quot;&gt;&lt;/a&gt;

1. Moet een niet-abstrakt type zijn met een publieke parameterloze constructor.

2. MiniExcel ondersteunt parameter IEnumerable Deferred Execution. Als je zo min mogelijk geheugen wilt gebruiken, roep dan geen methoden zoals ToList aan.

bijv.: ToList of geen geheugengebruik
![image](https://user-images.githubusercontent.com/12729184/112587389-752b0b00-8e38-11eb-8a52-cfb76c57e5eb.png)



#### 1. Anoniem of sterk getypeerd [[Probeer het]](https://dotnetfiddle.net/w5WD1J)

```csharp
var path = Path.Combine(Path.GetTempPath(), $&quot;{Guid.NewGuid()}.xlsx&quot;);
MiniExcel.SaveAs(path, new[] {
    new { Column1 = &quot;MiniExcel&quot;, Column2 = 1 },
    new { Column1 = &quot;Github&quot;, Column2 = 2}
});
</code></pre>
<h4>2. <code>IEnumerable&lt;IDictionary&lt;string, object&gt;&gt;</code></h4>
<pre><code class="language-csharp">var values = new List&lt;Dictionary&lt;string, object&gt;&gt;()
{
    new Dictionary&lt;string,object&gt;{{ &quot;Column1&quot;, &quot;MiniExcel&quot; }, { &quot;Column2&quot;, 1 } },
    new Dictionary&lt;string,object&gt;{{ &quot;Column1&quot;, &quot;Github&quot; }, { &quot;Column2&quot;, 2 } }
};
MiniExcel.SaveAs(path, values);
</code></pre>
<p>Bestandsresultaat aanmaken:</p>
<p>| Column1   | Column2 |
|-----------|---------|
| MiniExcel | 1       |
| Github    | 2       |</p>
<h4>3.  IDataReader</h4>
<ul>
<li><code>Aanbevolen</code>, hiermee kun je voorkomen dat alle data in het geheugen wordt geladen</li>
</ul>
<pre><code class="language-csharp">MiniExcel.SaveAs(path, reader);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/121275378-149a5e80-c8bc-11eb-85fe-5453552134f0.png" alt="image" /></p>
<p>DataReader exporteert meerdere sheets (aanbevolen via Dapper ExecuteReader)</p>
<pre><code class="language-csharp">using (var cnn = Connection)
{
    cnn.Open();
    var sheets = new Dictionary&lt;string,object&gt;();
    sheets.Add(&quot;sheet1&quot;, cnn.ExecuteReader(&quot;select 1 id&quot;));
    sheets.Add(&quot;sheet2&quot;, cnn.ExecuteReader(&quot;select 2 id&quot;));
    MiniExcel.SaveAs(&quot;Demo.xlsx&quot;, sheets);
}
</code></pre>
<h4>4. Datatable</h4>
<ul>
<li><p><code>Niet aanbevolen</code>, het zal alle data in het geheugen laden</p>
</li>
<li><p>DataTable gebruikt eerst Caption als kolomnaam, daarna de kolomnaam</p>
</li>
</ul>
<pre><code class="language-csharp">var path = Path.Combine(Path.GetTempPath(), $&quot;{Guid.NewGuid()}.xlsx&quot;);
var table = new DataTable();
{
    table.Columns.Add(&quot;Column1&quot;, typeof(string));
    table.Columns.Add(&quot;Column2&quot;, typeof(decimal));
    table.Rows.Add(&quot;MiniExcel&quot;, 1);
    table.Rows.Add(&quot;Github&quot;, 2);
}

MiniExcel.SaveAs(path, table);
</code></pre>
<h4>5. Dapper Query</h4>
<p>Dank aan @shaofing #552 , gebruik <code>CommandDefinition + CommandFlags.NoCache</code></p>
<pre><code class="language-csharp">using (var connection = GetConnection(connectionString))
{
    var rows = connection.Query(
        new CommandDefinition(
            @&quot;select 'MiniExcel' as Column1,1 as Column2 union all select 'Github',2&quot;
            , flags: CommandFlags.NoCache)
        );
    // Opmerking: QueryAsync zal een gesloten connectie-exceptie veroorzaken
    MiniExcel.SaveAs(path, rows);
}
</code></pre>
<p>Onderstaande code laadt alle data in het geheugen</p>
<pre><code class="language-csharp">using (var connection = GetConnection(connectionString))
{
    var rows = connection.Query(@&quot;select 'MiniExcel' as Column1,1 as Column2 union all select 'Github',2&quot;);
    MiniExcel.SaveAs(path, rows);
}
</code></pre>
<h4>6. SaveAs naar MemoryStream  <a href="https://dotnetfiddle.net/JOen0e">[Probeer het]</a></h4>
<pre><code class="language-csharp">using (var stream = new MemoryStream()) //ondersteunt FileStream, MemoryStream enz.
{
    stream.SaveAs(values);
}
</code></pre>
<p>bijv.: api voor exporteren van excel</p>
<pre><code class="language-csharp">public IActionResult DownloadExcel()
{
    var values = new[] {
        new { Column1 = &quot;MiniExcel&quot;, Column2 = 1 },
        new { Column1 = &quot;Github&quot;, Column2 = 2}
    };

    var memoryStream = new MemoryStream();
    memoryStream.SaveAs(values);
    memoryStream.Seek(0, SeekOrigin.Begin);
    return new FileStreamResult(memoryStream, &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)
    {
        FileDownloadName = &quot;demo.xlsx&quot;
    };
}
</code></pre>
<h4>7. Meerdere tabbladen aanmaken</h4>
<pre><code class="language-csharp">// 1. Dictionary&lt;string,object&gt;
var users = new[] { new { Name = &quot;Jack&quot;, Age = 25 }, new { Name = &quot;Mike&quot;, Age = 44 } };
var department = new[] { new { ID = &quot;01&quot;, Name = &quot;HR&quot; }, new { ID = &quot;02&quot;, Name = &quot;IT&quot; } };
var sheets = new Dictionary&lt;string, object&gt;
{
    [&quot;users&quot;] = users,
    [&quot;department&quot;] = department
};
MiniExcel.SaveAs(path, sheets);

// 2. DataSet
var sheets = new DataSet();
sheets.Add(UsersDataTable);
sheets.Add(DepartmentDataTable);
//..
MiniExcel.SaveAs(path, sheets);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/118130875-6e7c4580-b430-11eb-9b82-22f02716bd63.png" alt="image" /></p>
<h4>8. TableStyles Opties</h4>
<p>Standaard stijl</p>
<p><img src="https://user-images.githubusercontent.com/12729184/138234373-cfa97109-b71f-4711-b7f5-0eaaa4a0a3a6.png" alt="image" /></p>
<p>Zonder stijlconfiguratie</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration()
{
     TableStyles = TableStyles.None
};
MiniExcel.SaveAs(path, value,configuration:config);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/118784917-f3e57700-b8c2-11eb-8718-8d955b1bc197.png" alt="image" /></p>
<h4>9. AutoFilter</h4>
<p>Sinds v0.19.0 kan <code>OpenXmlConfiguration.AutoFilter</code> AutoFilter in- of uitschakelen, de standaardwaarde is <code>true</code>, en AutoFilter instellen kan als volgt:</p>
<pre><code class="language-csharp">MiniExcel.SaveAs(path, value, configuration: new OpenXmlConfiguration() { AutoFilter = false });
</code></pre>
<h4>10. Afbeelding maken</h4>
<pre><code class="language-csharp">```csharp
var value = new[] {
    new { Name=&quot;github&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/github_logo.png&quot;))},
    new { Name=&quot;google&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/google_logo.png&quot;))},
    new { Name=&quot;microsoft&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/microsoft_logo.png&quot;))},
    new { Name=&quot;reddit&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/reddit_logo.png&quot;))},
    new { Name=&quot;statck_overflow&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/statck_overflow_logo.png&quot;))},
};
MiniExcel.SaveAs(path, value);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/150462383-ad9931b3-ed8d-4221-a1d6-66f799743433.png" alt="image" /></p>
<h4>11. Byte Array Bestand Exporteren</h4>
<p>Sinds versie 1.22.0, wanneer het waarde type <code>byte[]</code> is, slaat het systeem standaard het bestandspad op in de cel, en bij importeren kan het systeem dit omzetten naar <code>byte[]</code>. Als je dit niet wilt gebruiken, kun je <code>OpenXmlConfiguration.EnableConvertByteArray</code> op <code>false</code> zetten, dit kan de systeemefficiëntie verbeteren.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/153702334-c3b834f4-6ae4-4ddf-bd4e-e5005d5d8c6a.png" alt="image" /></p>
<p>Sinds versie 1.22.0, wanneer het waarde type <code>byte[]</code> is, slaat het systeem standaard het bestandspad op in de cel, en bij importeren kan het systeem dit omzetten naar <code>byte[]</code>. Als je dit niet wilt gebruiken, kun je <code>OpenXmlConfiguration.EnableConvertByteArray</code> op <code>false</code> zetten, dit kan de systeemefficiëntie verbeteren.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/153702334-c3b834f4-6ae4-4ddf-bd4e-e5005d5d8c6a.png" alt="image" /></p>
<h4>12. Dezelfde cellen verticaal samenvoegen</h4>
<p>Deze functionaliteit wordt alleen ondersteund in het <code>xlsx</code>-formaat en voegt cellen verticaal samen tussen @merge- en @endmerge-tags.
Je kunt @mergelimit gebruiken om de grenzen van het samenvoegen van cellen verticaal te beperken.</p>
<pre><code class="language-csharp">var mergedFilePath = Path.Combine(Path.GetTempPath(), $&quot;{Guid.NewGuid().ToString()}.xlsx&quot;);

var path = @&quot;../../../../../samples/xlsx/TestMergeWithTag.xlsx&quot;;

MiniExcel.MergeSameCells(mergedFilePath, path);
</code></pre>
<pre><code class="language-csharp">var memoryStream = new MemoryStream();

var path = @&quot;../../../../../samples/xlsx/TestMergeWithTag.xlsx&quot;;

memoryStream.MergeSameCells(path);
</code></pre>
<p>Bestandsinhoud vóór en na samenvoegen:</p>
<p>Zonder merge limit:</p>
<img width="318" alt="Screenshot 2023-08-07 at 11 59 24" src="https://github.com/mini-software/MiniExcel/assets/38832863/49cc96b9-6c35-4bf3-8d43-a9752a15b22e">
<img width="318" alt="Screenshot 2023-08-07 at 11 59 57" src="https://github.com/mini-software/MiniExcel/assets/38832863/3fbd529b-3ae6-4bbe-b4d8-2793a5a58010">
<p>Met merge limit:</p>
<img width="346" alt="Screenshot 2023-08-08 at 18 21 00" src="https://github.com/mini-software/MiniExcel/assets/38832863/04049d28-84d5-4c2a-bcff-5847547df5e1">
<img width="346" alt="Screenshot 2023-08-08 at 18 21 40" src="https://github.com/mini-software/MiniExcel/assets/38832863/f5cf8957-b0b0-4831-b8fc-8556299235c2">
<h4>13. Null-waarden overslaan</h4>
<p>Nieuwe expliciete optie om lege cellen te schrijven voor null-waarden:</p>
<pre><code class="language-csharp">DataTable dt = new DataTable();

/* ... */

DataRow dr = dt.NewRow();

dr[&quot;Name1&quot;] = &quot;Somebody once&quot;;
dr[&quot;Name2&quot;] = null;
dr[&quot;Name3&quot;] = &quot;told me.&quot;;

dt.Rows.Add(dr);

OpenXmlConfiguration configuration = new OpenXmlConfiguration()
{
     EnableWriteNullValueCell = true // Standaardwaarde.
};

MiniExcel.SaveAs(@&quot;C:\temp\Book1.xlsx&quot;, dt, configuration: configuration);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/31481586/241419455-3c0aec8a-4e5f-4d83-b7ec-6572124c165d.png" alt="image" /></p>
<pre><code class="language-xml">&lt;x:row r=&quot;2&quot;&gt;
    &lt;x:c r=&quot;A2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;Somebody once&lt;/x:v&gt;
    &lt;/x:c&gt;
    &lt;x:c r=&quot;B2&quot; s=&quot;2&quot;&gt;&lt;/x:c&gt;
    &lt;x:c r=&quot;C2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;told me.&lt;/x:v&gt;
    &lt;/x:c&gt;
&lt;/x:row&gt;
</code></pre>
<p>Eerder gedrag:</p>
<pre><code>```csharp
/* ... */

OpenXmlConfiguration configuratie = new OpenXmlConfiguration()
{
     EnableWriteNullValueCell = false // Standaardwaarde is true.
};

MiniExcel.SaveAs(@&quot;C:\temp\Book1.xlsx&quot;, dt, configuration: configuratie);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/31481586/241419441-c4f27e8f-3f87-46db-a10f-08665864c874.png" alt="image" /></p>
<pre><code class="language-xml">&lt;x:row r=&quot;2&quot;&gt;
    &lt;x:c r=&quot;A2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;Somebody once&lt;/x:v&gt;
    &lt;/x:c&gt;
    &lt;x:c r=&quot;B2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;&lt;/x:v&gt;
    &lt;/x:c&gt;
    &lt;x:c r=&quot;C2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;told me.&lt;/x:v&gt;
    &lt;/x:c&gt;
&lt;/x:row&gt;
</code></pre>
<p>Werkt voor null- en DBNull-waarden.</p>
<h4>14. Bevries Rijen/Kolommen (Freeze Panes)</h4>
<pre><code class="language-csharp">/* ... */

OpenXmlConfiguration configuratie = new OpenXmlConfiguration()
{
    FreezeRowCount = 1,     // standaard is 1
    FreezeColumnCount = 2   // standaard is 0
};

MiniExcel.SaveAs(@&quot;C:\temp\Book1.xlsx&quot;, dt, configuration: configuratie);
</code></pre>
<p><img src="https://raw.githubusercontent.com/mini-software/MiniExcel/master/docs/images/freeze-pane-1.png" alt="image" /></p>
<h3>Data Invullen in Excel Sjabloon <a name="getstart3"></a></h3>
<ul>
<li>De declaratie lijkt op een Vue-sjabloon <code>{{variabelenaam}}</code>, of het weergeven van collecties <code>{{collectienaam.veldnaam}}</code></li>
<li>Collectieweergave ondersteunt IEnumerable/DataTable/DapperRow</li>
</ul>
<h4>1. Basis Invulling</h4>
<p>Sjabloon:
<img src="https://user-images.githubusercontent.com/12729184/114537556-ed8d2b00-9c84-11eb-8303-a69f62c41e5b.png" alt="image" /></p>
<p>Resultaat:
<img src="https://user-images.githubusercontent.com/12729184/114537490-d8180100-9c84-11eb-8c69-db58692f3a85.png" alt="image" /></p>
<p>Code:</p>
<pre><code class="language-csharp">// 1. Door POCO
var value = new
{
    Name = &quot;Jack&quot;,
    CreateDate = new DateTime(2021, 01, 01),
    VIP = true,
    Points = 123
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);


// 2. Door Dictionary
var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;Name&quot;] = &quot;Jack&quot;,
    [&quot;CreateDate&quot;] = new DateTime(2021, 01, 01),
    [&quot;VIP&quot;] = true,
    [&quot;Points&quot;] = 123
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>2. IEnumerable Data Invulling</h4>
<blockquote>
<p>Opmerking1: Gebruik de eerste IEnumerable met dezelfde kolom als basis voor het invullen van de lijst</p>
</blockquote>
<p>Sjabloon:
<img src="https://user-images.githubusercontent.com/12729184/114564652-14f2f080-9ca3-11eb-831f-09e3fedbc5fc.png" alt="image" /></p>
<p>Resultaat:
<img src="https://user-images.githubusercontent.com/12729184/114564204-b2015980-9ca2-11eb-900d-e21249f93f7c.png" alt="image" /></p>
<p>Code:</p>
<pre><code class="language-csharp">//1. Door POCO
var value = new
{
    employees = new[] {
</code></pre>
<p>new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
new {name=&quot;Lisa&quot;,department=&quot;HR&quot;},
new {name=&quot;John&quot;,department=&quot;HR&quot;},
new {name=&quot;Mike&quot;,department=&quot;IT&quot;},
new {name=&quot;Neo&quot;,department=&quot;IT&quot;},
new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
}
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);</p>
<p>//2. Met Dictionary
var value = new Dictionary&lt;string, object&gt;()
{
[&quot;employees&quot;] = new[] {
new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
new {name=&quot;Lisa&quot;,department=&quot;HR&quot;},
new {name=&quot;John&quot;,department=&quot;HR&quot;},
new {name=&quot;Mike&quot;,department=&quot;IT&quot;},
new {name=&quot;Neo&quot;,department=&quot;IT&quot;},
new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
}
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);</p>
<pre><code>


#### 3. Complexe gegevensvulling

&gt; Opmerking: Ondersteunt meerdere werkbladen en het gebruik van dezelfde variabele

Sjabloon:

![image](https://user-images.githubusercontent.com/12729184/114565255-acf0da00-9ca3-11eb-8a7f-8131b2265ae8.png)

Resultaat:

![image](https://user-images.githubusercontent.com/12729184/114565329-bf6b1380-9ca3-11eb-85e3-3969e8bf6378.png)

```csharp
// 1. Met POCO
var value = new
{
    title = &quot;FooCompany&quot;,
    managers = new[] {
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
    },
    employees = new[] {
        new {name=&quot;Wade&quot;,department=&quot;HR&quot;},
        new {name=&quot;Felix&quot;,department=&quot;HR&quot;},
        new {name=&quot;Eric&quot;,department=&quot;IT&quot;},
        new {name=&quot;Keaton&quot;,department=&quot;IT&quot;}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);

// 2. Met Dictionary
var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;title&quot;] = &quot;FooCompany&quot;,
    [&quot;managers&quot;] = new[] {
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
    },
    [&quot;employees&quot;] = new[] {
        new {name=&quot;Wade&quot;,department=&quot;HR&quot;},
        new {name=&quot;Felix&quot;,department=&quot;HR&quot;},
        new {name=&quot;Eric&quot;,department=&quot;IT&quot;},
        new {name=&quot;Keaton&quot;,department=&quot;IT&quot;}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>4. Grote hoeveelheden data vullen: prestaties</h4>
<blockquote>
<p>OPMERKING: Gebruik van IEnumerable uitgestelde uitvoering in plaats van ToList kan het maximale geheugengebruik besparen in MiniExcel</p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/12729184/114577091-5046ec80-9cae-11eb-924b-087c7becf8da.png" alt="image" /></p>
<h4>5. Celwaarde automatische type-mapping</h4>
<p>Sjabloon</p>
<p><img src="https://user-images.githubusercontent.com/12729184/114802504-64830a80-9dd0-11eb-8d56-8e8c401b3ace.png" alt="image" /></p>
<p>Resultaat</p>
<p><img src="https://user-images.githubusercontent.com/12729184/114802419-43221e80-9dd0-11eb-9ffe-a2ce34fe7076.png" alt="image" /></p>
<p>Klasse</p>
<pre><code class="language-csharp">public class Poco
{
    public string @string { get; set; }
    public int? @int { get; set; }
```csharp
public decimal? @decimal { get; set; }
public double? @double { get; set; }
public DateTime? datetime { get; set; }
public bool? @bool { get; set; }
public Guid? Guid { get; set; }
}
</code></pre>
<p>Code</p>
<pre><code class="language-csharp">var poco = new TestIEnumerableTypePoco { @string = &quot;string&quot;, @int = 123, @decimal = decimal.Parse(&quot;123.45&quot;), @double = (double)123.33, @datetime = new DateTime(2021, 4, 1), @bool = true, @Guid = Guid.NewGuid() };
var value = new
{
    Ts = new[] {
        poco,
        new TestIEnumerableTypePoco{},
        null,
        poco
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>6. Voorbeeld :  Lijst Github Projecten</h4>
<p>Sjabloon</p>
<p><img src="https://user-images.githubusercontent.com/12729184/115068623-12073280-9f25-11eb-9124-f4b3efcdb2a7.png" alt="image" /></p>
<p>Resultaat</p>
<p><img src="https://user-images.githubusercontent.com/12729184/115068639-1a5f6d80-9f25-11eb-9f45-27c434d19a78.png" alt="image" /></p>
<p>Code</p>
<pre><code class="language-csharp">var projects = new[]
{
    new {Name = &quot;MiniExcel&quot;,Link=&quot;https://github.com/mini-software/MiniExcel&quot;,Star=146, CreateTime=new DateTime(2021,03,01)},
    new {Name = &quot;HtmlTableHelper&quot;,Link=&quot;https://github.com/mini-software/HtmlTableHelper&quot;,Star=16, CreateTime=new DateTime(2020,02,01)},
    new {Name = &quot;PocoClassGenerator&quot;,Link=&quot;https://github.com/mini-software/PocoClassGenerator&quot;,Star=16, CreateTime=new DateTime(2019,03,17)}
};
var value = new
{
    User = &quot;ITWeiHan&quot;,
    Projects = projects,
    TotalStar = projects.Sum(s =&gt; s.Star)
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>7. Gegroepeerde Data Invullen</h4>
<pre><code class="language-csharp">var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;employees&quot;] = new[] {
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;John&quot;,department=&quot;HR&quot;},
        new {name=&quot;John&quot;,department=&quot;IT&quot;},
        new {name=&quot;Neo&quot;,department=&quot;IT&quot;},
        new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
    }
};
await MiniExcel.SaveAsByTemplateAsync(path, templatePath, value);
</code></pre>
<h5>1. Met <code>@group</code> tag en met <code>@header</code> tag</h5>
<p>Voor</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646717-21b9d57a-2be2-4e9a-801b-ae212231d2b4.PNG" alt="before_with_header" /></p>
<p>Na</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646721-58a7a340-7004-4bc2-af24-cffcb2c20737.PNG" alt="after_with_header" /></p>
<h5>2. Met @group tag en zonder @header tag</h5>
<p>Voor</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646873-b12417fa-801b-4890-8e96-669ed3b43902.PNG" alt="before_without_header" /></p>
<p>Na</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646872-622461ba-342e-49ee-834f-b91ad9c2dac3.PNG" alt="after_without_header" /></p>
<h5>3. Zonder @group tag</h5>
<p>Voor</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646975-f52a68eb-e031-43b5-abaa-03b67c052d1a.PNG" alt="without_group" /></p>
<p>Na</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646974-4a3c0e07-7c66-4088-ad07-b4ad3695b7e1.PNG" alt="without_group_after" /></p>
<h4>8. If/ElseIf/Else-instructies in een cel</h4>
<p>Regels:</p>
<ol>
<li>Ondersteunt DateTime, Double, Int met de operatoren ==, !=, &gt;, &gt;=, &lt;, &lt;=.</li>
<li>Ondersteunt String met de operatoren ==, !=.</li>
<li>Elke instructie moet op een nieuwe regel staan.</li>
<li>Er moet een enkele spatie vóór en na de operatoren staan.</li>
<li>Er mag geen nieuwe regel binnen de instructies staan.</li>
<li>De cel moet exact hetzelfde formaat hebben als hieronder.</li>
</ol>
<pre><code class="language-csharp">@if(name == Jack)
{{employees.name}}
@elseif(name == Neo)
Test {{employees.name}}
@else
{{employees.department}}
@endif
</code></pre>
<p>Voor</p>
<p><img src="https://user-images.githubusercontent.com/38832863/235360606-ca654769-ff55-4f5b-98d2-d2ec0edb8173.PNG" alt="if_before" /></p>
<p>Na</p>
<p><img src="https://user-images.githubusercontent.com/38832863/235360609-869bb960-d63d-45ae-8d64-9e8b0d0ab658.PNG" alt="if_after" /></p>
<h4>9. DataTable als parameter</h4>
<pre><code class="language-csharp">var managers = new DataTable();
{
    managers.Columns.Add(&quot;name&quot;);
    managers.Columns.Add(&quot;department&quot;);
    managers.Rows.Add(&quot;Jack&quot;, &quot;HR&quot;);
    managers.Rows.Add(&quot;Loan&quot;, &quot;IT&quot;);
}
var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;title&quot;] = &quot;FooCompany&quot;,
    [&quot;managers&quot;] = managers,
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>10. Formules</h4>
<h5>1. Voorbeeld</h5>
<p>Voeg een <code>$</code> toe aan het begin van je formule en gebruik <code>$enumrowstart</code> en <code>$enumrowend</code> om verwijzingen naar het begin- en eindrij van de enumerable aan te geven:</p>
<p><img src="https://raw.githubusercontent.com/mini-software/MiniExcel/master/docs/images/template-formulas-1.png" alt="image" /></p>
<p>Wanneer de template wordt gerenderd, wordt het <code>$</code>-voorvoegsel verwijderd en worden <code>$enumrowstart</code> en <code>$enumrowend</code> vervangen door de begin- en eindrijnummers van de enumerable:</p>
<p><img src="https://raw.githubusercontent.com/mini-software/MiniExcel/master/docs/images/template-formulas-2.png" alt="image" /></p>
<h5>2. Andere Voorbeeldformules:</h5>
<p>|              |                                                                                           |
|--------------|-------------------------------------------------------------------------------------------|
| Som          | <code>$=SUM(C{{$enumrowstart}}:C{{$enumrowend}})</code>                                              |
| Alt. Gemiddelde | <code>$=SUM(C{{$enumrowstart}}:C{{$enumrowend}}) / COUNT(C{{$enumrowstart}}:C{{$enumrowend}})</code> |
| Bereik       | <code>$=MAX(C{{$enumrowstart}}:C{{$enumrowend}}) - MIN(C{{$enumrowstart}}:C{{$enumrowend}})</code>   |</p>
<h4>11. Overig</h4>
<h5>1. Controleren van template parameter key</h5>
<p>Sinds V1.24.0 wordt standaard het ontbreken van een template parameter key genegeerd en vervangen door een lege string. <code>IgnoreTemplateParameterMissing</code> kan bepalen of er een uitzondering wordt gegooid of niet.</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration()
{
    IgnoreTemplateParameterMissing = false,
};
MiniExcel.SaveAsByTemplate(path, templatePath, value, config)
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/157464332-e316f829-54aa-4c84-a5aa-9aef337b668d.png" alt="image" /></p>
<h3>Excel Kolomnaam/Index/Ignore Attribuut <a name="getstart4"></a></h3>
<h4>1. Specificeer de kolomnaam, kolomindex, kolom negeren</h4>
<p>Excel Voorbeeld</p>
<p><img src="https://user-images.githubusercontent.com/12729184/114230869-3e163700-99ac-11eb-9a90-2039d4b4b313.png" alt="image" /></p>
<p>Code</p>
<pre><code class="language-csharp">public class ExcelAttributeDemo
{
    [ExcelColumnName(&quot;Column1&quot;)]
```csharp
public string Test1 { get; set; }
[ExcelColumnName(&quot;Column2&quot;)]
public string Test2 { get; set; }
[ExcelIgnore]
public string Test3 { get; set; }
[ExcelColumnIndex(&quot;I&quot;)] // systeem zal &quot;I&quot; omzetten naar index 8
public string Test4 { get; set; }
public string Test5 { get; } //zonder set wordt genegeerd
public string Test6 { get; private set; } //niet-publieke set wordt genegeerd
[ExcelColumnIndex(3)] // begint bij 0
public string Test7 { get; set; }
}

var rows = MiniExcel.Query&lt;ExcelAttributeDemo&gt;(path).ToList();
Assert.Equal(&quot;Column1&quot;, rows[0].Test1);
Assert.Equal(&quot;Column2&quot;, rows[0].Test2);
Assert.Null(rows[0].Test3);
Assert.Equal(&quot;Test7&quot;, rows[0].Test4);
Assert.Null(rows[0].Test5);
Assert.Null(rows[0].Test6);
Assert.Equal(&quot;Test4&quot;, rows[0].Test7);
</code></pre>
<h4>2. Aangepast formaat (ExcelFormatAttribute)</h4>
<p>Sinds V0.21.0 wordt klasse ondersteund die een <code>ToString(string content)</code> methode bevat voor formattering</p>
<p>Klasse</p>
<pre><code class="language-csharp">public class Dto
{
    public string Name { get; set; }

    [ExcelFormat(&quot;MMMM dd, yyyy&quot;)]
    public DateTime InDate { get; set; }
}
</code></pre>
<p>Code</p>
<pre><code class="language-csharp">var value = new Dto[] {
    new Issue241Dto{ Name=&quot;Jack&quot;,InDate=new DateTime(2021,01,04)},
    new Issue241Dto{ Name=&quot;Henry&quot;,InDate=new DateTime(2020,04,05)},
};
MiniExcel.SaveAs(path, value);
</code></pre>
<p>Resultaat</p>
<p><img src="https://user-images.githubusercontent.com/12729184/118910788-ab2bcd80-b957-11eb-8d42-bfce36621b1b.png" alt="image" /></p>
<p>Query ondersteunt aangepaste formaatconversie</p>
<p><img src="https://user-images.githubusercontent.com/12729184/118911286-87b55280-b958-11eb-9a88-c8ff403d240a.png" alt="image" /></p>
<h4>3. Kolombreedte instellen (ExcelColumnWidthAttribute)</h4>
<pre><code class="language-csharp">public class Dto
{
    [ExcelColumnWidth(20)]
    public int ID { get; set; }
    [ExcelColumnWidth(15.50)]
    public string Name { get; set; }
}
</code></pre>
<h4>4. Meerdere kolomnamen toewijzen aan dezelfde property.</h4>
<pre><code class="language-csharp">public class Dto
{
    [ExcelColumnName(excelColumnName:&quot;EmployeeNo&quot;,aliases:new[] { &quot;EmpNo&quot;,&quot;No&quot; })]
    public string Empno { get; set; }
    public string Name { get; set; }
}
</code></pre>
<h4>5. System.ComponentModel.DisplayNameAttribute = ExcelColumnName.excelColumnNameAttribute</h4>
<p>Sinds 1.24.0 ondersteunt het systeem System.ComponentModel.DisplayNameAttribute = ExcelColumnName.excelColumnNameAttribute</p>
<pre><code class="language-C#">public class TestIssueI4TXGTDto
{
    public int ID { get; set; }
    public string Name { get; set; }
    [DisplayName(&quot;Specification&quot;)]
    public string Spc { get; set; }
    [DisplayName(&quot;Unit Price&quot;)]
    public decimal Up { get; set; }
}
</code></pre>
<pre><code>

#### 6. ExcelColumnAttribute

Sinds V1.26.0 kunnen meerdere attributen als volgt worden vereenvoudigd:
```csharp
        public class TestIssueI4ZYUUDto
        {
            [ExcelColumn(Name = &quot;ID&quot;,Index =0)]
            public string MyProperty { get; set; }
            [ExcelColumn(Name = &quot;CreateDate&quot;, Index = 1,Format =&quot;yyyy-MM&quot;,Width =100)]
            public DateTime MyProperty2 { get; set; }
        }
</code></pre>
<h4>7. DynamicColumnAttribute</h4>
<p>Sinds V1.26.0 kunnen we de attributen van een kolom dynamisch instellen</p>
<pre><code class="language-csharp">            var config = new OpenXmlConfiguration
            {
                DynamicColumns = new DynamicExcelColumn[] {
                    new DynamicExcelColumn(&quot;id&quot;){Ignore=true},
                    new DynamicExcelColumn(&quot;name&quot;){Index=1,Width=10},
                    new DynamicExcelColumn(&quot;createdate&quot;){Index=0,Format=&quot;yyyy-MM-dd&quot;,Width=15},
                    new DynamicExcelColumn(&quot;point&quot;){Index=2,Name=&quot;Account Point&quot;},
                }
            };
            var path = PathHelper.GetTempPath();
            var value = new[] { new { id = 1, name = &quot;Jack&quot;, createdate = new DateTime(2022, 04, 12) ,point = 123.456} };
            MiniExcel.SaveAs(path, value, configuration: config);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/164510353-5aecbc4e-c3ce-41e8-b6cf-afd55eb23b68.png" alt="image" /></p>
<h4>8. DynamicSheetAttribute</h4>
<p>Sinds V1.31.4 kunnen we de attributen van een sheet dynamisch instellen. We kunnen de naam van het werkblad en de status (zichtbaarheid) instellen.</p>
<pre><code class="language-csharp">            var configuration = new OpenXmlConfiguration
            {
                DynamicSheets = new DynamicExcelSheet[] {
                    new DynamicExcelSheet(&quot;usersSheet&quot;) { Name = &quot;Users&quot;, State = SheetState.Visible },
                    new DynamicExcelSheet(&quot;departmentSheet&quot;) { Name = &quot;Departments&quot;, State = SheetState.Hidden }
                }
            };

            var users = new[] { new { Name = &quot;Jack&quot;, Age = 25 }, new { Name = &quot;Mike&quot;, Age = 44 } };
            var department = new[] { new { ID = &quot;01&quot;, Name = &quot;HR&quot; }, new { ID = &quot;02&quot;, Name = &quot;IT&quot; } };
            var sheets = new Dictionary&lt;string, object&gt;
            {
                [&quot;usersSheet&quot;] = users,
                [&quot;departmentSheet&quot;] = department
            };

            var path = PathHelper.GetTempPath();
            MiniExcel.SaveAs(path, sheets, configuration: configuration);
</code></pre>
<p>We kunnen ook het nieuwe attribuut ExcelSheetAttribute gebruiken:</p>
<pre><code class="language-C#">   [ExcelSheet(Name = &quot;Departments&quot;, State = SheetState.Hidden)]
   private class DepartmentDto
   {
      [ExcelColumn(Name = &quot;ID&quot;,Index = 0)]
      public string ID { get; set; }
      [ExcelColumn(Name = &quot;Name&quot;,Index = 1)]
      public string Name { get; set; }
   }
</code></pre>
<h3>Toevoegen, Verwijderen, Bijwerken</h3>
<h4>Toevoegen</h4>
<p>v1.28.0 ondersteunt CSV invoegen van N rijen na de laatste rij</p>
<pre><code class="language-csharp">// Oorspronkelijk
{
    var value = new[] {
          new { ID=1,Name =&quot;Jack&quot;,InDate=new DateTime(2021,01,03)},
          new { ID=2,Name =&quot;Henry&quot;,InDate=new DateTime(2020,05,03)},
    };
    MiniExcel.SaveAs(path, value);
}
// Voeg 1 rij toe na de laatste
{
    var value = new { ID=3,Name = &quot;Mike&quot;, InDate = new DateTime(2021, 04, 23) };
    MiniExcel.Insert(path, value);
}
// Voeg N rijen toe na de laatste
{
    var value = new[] {
          new { ID=4,Name =&quot;Frank&quot;,InDate=new DateTime(2021,06,07)},
          new { ID=5,Name =&quot;Gloria&quot;,InDate=new DateTime(2022,05,03)},
</code></pre>
<pre><code class="language-csharp">};
MiniExcel.Insert(path, value);
}
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/191023733-1e2fa732-db5c-4a3a-9722-b891fe5aa069.png" alt="image" /></p>
<p>v1.37.0 ondersteunt het invoegen van een nieuw werkblad in een bestaande werkmap</p>
<pre><code class="language-csharp">// Originele excel
{
    var value = new[] {
          new { ID=1,Name =&quot;Jack&quot;,InDate=new DateTime(2021,01,03)},
          new { ID=2,Name =&quot;Henry&quot;,InDate=new DateTime(2020,05,03)},
    };
    MiniExcel.SaveAs(path, value, sheetName: &quot;Sheet1&quot;);
}
// Voeg een nieuw werkblad toe
{
    var value = new { ID=3,Name = &quot;Mike&quot;, InDate = new DateTime(2021, 04, 23) };
    MiniExcel.Insert(path, table, sheetName: &quot;Sheet2&quot;);
}
</code></pre>
<h4>Verwijderen (in afwachting)</h4>
<h4>Bijwerken (in afwachting)</h4>
<h3>Excel Type Automatisch Controleren <a name="getstart5"></a></h3>
<ul>
<li>MiniExcel controleert standaard of het een xlsx of csv is op basis van de <code>bestandsextensie</code>, maar dit kan onnauwkeurig zijn, specificeer het daarom handmatig.</li>
<li>Bij een stream kan niet worden vastgesteld van welk type excel het is, specificeer het daarom handmatig.</li>
</ul>
<pre><code class="language-csharp">stream.SaveAs(excelType:ExcelType.CSV);
//of
stream.SaveAs(excelType:ExcelType.XLSX);
//of
stream.Query(excelType:ExcelType.CSV);
//of
stream.Query(excelType:ExcelType.XLSX);
</code></pre>
<h3>CSV</h3>
<h4>Opmerking</h4>
<ul>
<li>Geeft standaard een <code>string</code> type terug, en de waarde zal niet worden omgezet naar getallen of datum/tijd, tenzij het type is gedefinieerd door een sterk getypeerde generic.</li>
</ul>
<h4>Aangepaste scheidingsteken</h4>
<p>Standaard is <code>,</code> het scheidingsteken, je kunt de eigenschap <code>Seperator</code> aanpassen voor personalisatie</p>
<pre><code class="language-csharp">var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    Seperator=';'
};
MiniExcel.SaveAs(path, values,configuration: config);
</code></pre>
<p>Sinds V1.30.1 is er ondersteuning voor een functie om het scheidingsteken aan te passen (dank aan @hyzx86)</p>
<pre><code class="language-csharp">var config = new CsvConfiguration()
{
    SplitFn = (row) =&gt; Regex.Split(row, $&quot;[\t,](?=(?:[^\&quot;]|\&quot;[^\&quot;]*\&quot;)*$)&quot;)
        .Select(s =&gt; Regex.Replace(s.Replace(&quot;\&quot;\&quot;&quot;, &quot;\&quot;&quot;), &quot;^\&quot;|\&quot;$&quot;, &quot;&quot;)).ToArray()
};
var rows = MiniExcel.Query(path, configuration: config).ToList();
</code></pre>
<h4>Aangepaste regeleinde</h4>
<p>Standaard is <code>\r\n</code> het nieuwe-regel karakter, je kunt de eigenschap <code>NewLine</code> aanpassen voor personalisatie</p>
<pre><code class="language-csharp">var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    NewLine='\n'
};
MiniExcel.SaveAs(path, values,configuration: config);
</code></pre>
<h4>Aangepaste codering</h4>
<ul>
<li>De standaardcodering is &quot;Detect Encoding From Byte Order Marks&quot; (detectEncodingFromByteOrderMarks: true)</li>
<li>Als u aangepaste coderingsvereisten heeft, pas dan de eigenschap StreamReaderFunc / StreamWriterFunc aan</li>
</ul>
<pre><code class="language-csharp">// Lezen
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    StreamReaderFunc = (stream) =&gt; new StreamReader(stream,Encoding.GetEncoding(&quot;gb2312&quot;))
};
var rows = MiniExcel.Query(path, true,excelType:ExcelType.CSV,configuration: config);

// Schrijven
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    StreamWriterFunc = (stream) =&gt; new StreamWriter(stream, Encoding.GetEncoding(&quot;gb2312&quot;))
};
MiniExcel.SaveAs(path, value,excelType:ExcelType.CSV, configuration: config);
</code></pre>
<h4>Leeg tekenreeks als null lezen</h4>
<p>Standaard worden lege waarden gemapt naar string.Empty. U kunt dit gedrag aanpassen</p>
<pre><code class="language-csharp">var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
   ReadEmptyStringAsNull = true
};
</code></pre>
<h3>DataReader</h3>
<h4>1. GetReader</h4>
<p>Sinds 1.23.0 kunt u GetDataReader gebruiken</p>
<pre><code class="language-csharp">    using (var reader = MiniExcel.GetReader(path,true))
    {
        while (reader.Read())
        {
            for (int i = 0; i &lt; reader.FieldCount; i++)
            {
                var value = reader.GetValue(i);
            }
        }
    }
</code></pre>
<h3>Async</h3>
<ul>
<li>v0.17.0 ondersteunt Async (met dank aan isdaniel ( SHIH,BING-SIOU)](https://github.com/isdaniel))</li>
</ul>
<pre><code class="language-csharp">public static Task SaveAsAsync(string path, object value, bool printHeader = true, string sheetName = &quot;Sheet1&quot;, ExcelType excelType = ExcelType.UNKNOWN, IConfiguration configuration = null)
public static Task SaveAsAsync(this Stream stream, object value, bool printHeader = true, string sheetName = &quot;Sheet1&quot;, ExcelType excelType = ExcelType.XLSX, IConfiguration configuration = null)
public static Task&lt;IEnumerable&lt;dynamic&gt;&gt; QueryAsync(string path, bool useHeaderRow = false, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null)
public static Task&lt;IEnumerable&lt;T&gt;&gt; QueryAsync&lt;T&gt;(this Stream stream, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null) where T : class, new()
public static Task&lt;IEnumerable&lt;T&gt;&gt; QueryAsync&lt;T&gt;(string path, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null) where T : class, new()
public static Task&lt;IEnumerable&lt;IDictionary&lt;string, object&gt;&gt;&gt; QueryAsync(this Stream stream, bool useHeaderRow = false, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null)
public static Task SaveAsByTemplateAsync(this Stream stream, string templatePath, object value)
public static Task SaveAsByTemplateAsync(this Stream stream, byte[] templateBytes, object value)
public static Task SaveAsByTemplateAsync(string path, string templatePath, object value)
public static Task SaveAsByTemplateAsync(string path, byte[] templateBytes, object value)
public static Task&lt;DataTable&gt; QueryAsDataTableAsync(string path, bool useHeaderRow = true, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null)
</code></pre>
<ul>
<li>v1.25.0 ondersteunt <code>cancellationToken</code>。</li>
</ul>
<h3>Overige</h3>
<h4>1. Enum</h4>
<p>Zorg ervoor dat de excel- en eigenschapsnaam hetzelfde zijn, het systeem zal automatisch mappen (hoofdletterongevoelig)</p>
<p><img src="https://user-images.githubusercontent.com/12729184/116210595-9784b100-a775-11eb-936f-8e7a8b435961.png" alt="image" /></p>
<p>Sinds V0.18.0 wordt Enum Description ondersteund</p>
<pre><code class="language-csharp">public class Dto
{
    public string Name { get; set; }
    public I49RYZUserType UserType { get; set; }
}

public enum Type
{
    [Description(&quot;Algemene gebruiker&quot;)]
    V1,
    [Description(&quot;Algemene beheerder&quot;)]
    V2,
    [Description(&quot;Superbeheerder&quot;)]
    V3
}
</code></pre>
<pre><code>
![image](https://user-images.githubusercontent.com/12729184/133116630-27cc7161-099a-48b8-9784-cd1e443af3d1.png)

Sinds versie 1.30.0 wordt excel Description naar Enum ondersteund, dank aan @KaneLeung

#### 2. Converteer CSV naar XLSX of converteer XLSX naar CSV

```csharp
MiniExcel.ConvertXlsxToCsv(xlsxPath, csvPath);
MiniExcel.ConvertXlsxToCsv(xlsxStream, csvStream);
MiniExcel.ConvertCsvToXlsx(csvPath, xlsxPath);
MiniExcel.ConvertCsvToXlsx(csvStream, xlsxStream);
</code></pre>
<pre><code class="language-csharp">using (var excelStream = new FileStream(path: filePath, FileMode.Open, FileAccess.Read))
using (var csvStream = new MemoryStream())
{
   MiniExcel.ConvertXlsxToCsv(excelStream, csvStream);
}
</code></pre>
<h4>3. Aangepaste CultureInfo</h4>
<p>Sinds 1.22.0 kun je een aangepaste CultureInfo instellen zoals hieronder, systeemstandaard is <code>CultureInfo.InvariantCulture</code>.</p>
<pre><code class="language-csharp">var config = new CsvConfiguration()
{
    Culture = new CultureInfo(&quot;fr-FR&quot;),
};
MiniExcel.SaveAs(path, value, configuration: config);

// of
MiniExcel.Query(path, configuration: config);
</code></pre>
<h4>4. Aangepaste Buffer Size</h4>
<pre><code class="language-csharp">    public abstract class Configuration : IConfiguration
    {
        public int BufferSize { get; set; } = 1024 * 512;
    }
</code></pre>
<h4>5. FastMode</h4>
<p>Het systeem beheert het geheugen niet, maar je kunt wel sneller opslaan.</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration() { FastMode = true };
MiniExcel.SaveAs(path, reader,configuration:config);
</code></pre>
<h4>6. Afbeeldingen in bulk toevoegen (MiniExcel.AddPicture)</h4>
<p>Voeg afbeeldingen toe vóór het batch genereren van rijen met data, anders zal het systeem veel geheugen gebruiken bij het aanroepen van AddPicture.</p>
<pre><code class="language-csharp">var images = new[]
{
    new MiniExcelPicture
    {
        ImageBytes = File.ReadAllBytes(PathHelper.GetFile(&quot;images/github_logo.png&quot;)),
        SheetName = null, // standaard null is eerste sheet
        CellAddress = &quot;C3&quot;, // verplicht
    },
    new MiniExcelPicture
    {
        ImageBytes = File.ReadAllBytes(PathHelper.GetFile(&quot;images/google_logo.png&quot;)),
        PictureType = &quot;image/png&quot;, // standaard PictureType = image/png
        SheetName = &quot;Demo&quot;,
        CellAddress = &quot;C9&quot;, // verplicht
        WidthPx = 100,
        HeightPx = 100,
    },
};
MiniExcel.AddPicture(path, images);
</code></pre>
<p><img src="https://github.com/user-attachments/assets/19c4d241-9753-4ede-96c8-f810c1a22247" alt="Image" /></p>
<h4>7. Sheet-afmetingen ophalen</h4>
<pre><code class="language-csharp">var dim = MiniExcel.GetSheetDimensions(path);
</code></pre>
<h3>Voorbeelden:</h3>
<h4>1. SQLite &amp; Dapper <code>Groot Bestandsformaat</code> SQL Insert Voorkomt OOM</h4>
<p>opmerking: roep na Query geen ToList/ToArray methoden aan, dit laadt alle data in het geheugen</p>
<pre><code class="language-csharp">using (var connection = new SQLiteConnection(connectionString))
{
    connection.Open();
    using (var transaction = connection.BeginTransaction())
    using (var stream = File.OpenRead(path))
</code></pre>
<pre><code class="language-csharp">{
   var rows = stream.Query();
   foreach (var row in rows)
         connection.Execute(&quot;insert into T (A,B) values (@A,@B)&quot;, new { row.A, row.B }, transaction: transaction);
   transaction.Commit();
}
}
</code></pre>
<p>prestaties:
<img src="https://user-images.githubusercontent.com/12729184/111072579-2dda7b80-8516-11eb-9843-c01a1edc88ec.png" alt="image" /></p>
<h4>2. ASP.NET Core 3.1 of MVC 5 Download/Upload Excel Xlsx API Demo <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/tests/MiniExcel.Tests.AspNetCore">Probeer het</a></h4>
<pre><code class="language-csharp">public class ApiController : Controller
{
    public IActionResult Index()
    {
        return new ContentResult
        {
            ContentType = &quot;text/html&quot;,
            StatusCode = (int)HttpStatusCode.OK,
            Content = @&quot;&lt;html&gt;&lt;body&gt;
&lt;a href='api/DownloadExcel'&gt;DownloadExcel&lt;/a&gt;&lt;br&gt;
&lt;a href='api/DownloadExcelFromTemplatePath'&gt;DownloadExcelFromTemplatePath&lt;/a&gt;&lt;br&gt;
&lt;a href='api/DownloadExcelFromTemplateBytes'&gt;DownloadExcelFromTemplateBytes&lt;/a&gt;&lt;br&gt;
&lt;p&gt;Upload Excel&lt;/p&gt;
&lt;form method='post' enctype='multipart/form-data' action='/api/uploadexcel'&gt;
    &lt;input type='file' name='excel'&gt; &lt;br&gt;
    &lt;input type='submit' &gt;
&lt;/form&gt;
&lt;/body&gt;&lt;/html&gt;&quot;
        };
    }

    public IActionResult DownloadExcel()
    {
        var values = new[] {
            new { Column1 = &quot;MiniExcel&quot;, Column2 = 1 },
            new { Column1 = &quot;Github&quot;, Column2 = 2}
        };
        var memoryStream = new MemoryStream();
        memoryStream.SaveAs(values);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)
        {
            FileDownloadName = &quot;demo.xlsx&quot;
        };
    }

    public IActionResult DownloadExcelFromTemplatePath()
    {
        string templatePath = &quot;TestTemplateComplex.xlsx&quot;;

        Dictionary&lt;string, object&gt; value = new Dictionary&lt;string, object&gt;()
        {
            [&quot;title&quot;] = &quot;FooCompany&quot;,
            [&quot;managers&quot;] = new[] {
                new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
                new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
            },
            [&quot;employees&quot;] = new[] {
                new {name=&quot;Wade&quot;,department=&quot;HR&quot;},
                new {name=&quot;Felix&quot;,department=&quot;HR&quot;},
                new {name=&quot;Eric&quot;,department=&quot;IT&quot;},
                new {name=&quot;Keaton&quot;,department=&quot;IT&quot;}
            }
        };

        MemoryStream memoryStream = new MemoryStream();
        memoryStream.SaveAsByTemplate(templatePath, value);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)
        {
            FileDownloadName = &quot;demo.xlsx&quot;
        };
    }

    private static Dictionary&lt;string, Byte[]&gt; TemplateBytesCache = new Dictionary&lt;string, byte[]&gt;();

    static ApiController()
    {
        string templatePath = &quot;TestTemplateComplex.xlsx&quot;;
        byte[] bytes = System.IO.File.ReadAllBytes(templatePath);
        TemplateBytesCache.Add(templatePath, bytes);
    }

    public IActionResult DownloadExcelFromTemplateBytes()
    {
        byte[] bytes = TemplateBytesCache[&quot;TestTemplateComplex.xlsx&quot;];

        Dictionary&lt;string, object&gt; value = new Dictionary&lt;string, object&gt;()
        {
            [&quot;title&quot;] = &quot;FooCompany&quot;,
            [&quot;managers&quot;] = new[] {
</code></pre>
<pre><code class="language-csharp">                new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
                new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
            },
            [&quot;employees&quot;] = new[] {
                new {name=&quot;Wade&quot;,department=&quot;HR&quot;},
                new {name=&quot;Felix&quot;,department=&quot;HR&quot;},
                new {name=&quot;Eric&quot;,department=&quot;IT&quot;},
                new {name=&quot;Keaton&quot;,department=&quot;IT&quot;}
            }
        };

        MemoryStream memoryStream = new MemoryStream();
        memoryStream.SaveAsByTemplate(bytes, value);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)
        {
            FileDownloadName = &quot;demo.xlsx&quot;
        };
    }

    public IActionResult UploadExcel(IFormFile excel)
    {
        var stream = new MemoryStream();
        excel.CopyTo(stream);

        foreach (var item in stream.Query(true))
        {
            // voer je logica uit etc.
        }

        return Ok(&quot;Bestand succesvol geüpload&quot;);
    }
}
</code></pre>
<h4>3. Paginering Query</h4>
<pre><code class="language-csharp">void Main()
{
    var rows = MiniExcel.Query(path);

    Console.WriteLine(&quot;==== Nr.1 Pagina ====&quot;);
    Console.WriteLine(Page(rows,pageSize:3,page:1));
    Console.WriteLine(&quot;==== Nr.50 Pagina ====&quot;);
    Console.WriteLine(Page(rows,pageSize:3,page:50));
    Console.WriteLine(&quot;==== Nr.5000 Pagina ====&quot;);
    Console.WriteLine(Page(rows,pageSize:3,page:5000));
}

public static IEnumerable&lt;T&gt; Page&lt;T&gt;(IEnumerable&lt;T&gt; en, int pageSize, int page)
{
    return en.Skip(page * pageSize).Take(pageSize);
}
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/114679083-6ef4c400-9d3e-11eb-9f78-a86daa45fe46.gif" alt="20210419" /></p>
<h4>4. WebForm exporteer Excel via memorystream</h4>
<pre><code class="language-csharp">var fileName = &quot;Demo.xlsx&quot;;
var sheetName = &quot;Sheet1&quot;;
HttpResponse response = HttpContext.Current.Response;
response.Clear();
response.ContentType = &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;;
response.AddHeader(&quot;Content-Disposition&quot;, $&quot;attachment;filename=\&quot;{fileName}\&quot;&quot;);
var values = new[] {
    new { Column1 = &quot;MiniExcel&quot;, Column2 = 1 },
    new { Column1 = &quot;Github&quot;, Column2 = 2}
};
var memoryStream = new MemoryStream();
memoryStream.SaveAs(values, sheetName: sheetName);
memoryStream.Seek(0, SeekOrigin.Begin);
memoryStream.CopyTo(Response.OutputStream);
response.End();
</code></pre>
<h4>5. Dynamische i18n meertaligheid en rolbevoegdheidsbeheer</h4>
<p>Zoals in het voorbeeld, maak een methode om i18n en machtigingenbeheer af te handelen en gebruik <code>yield return om IEnumerable&lt;Dictionary&lt;string, object&gt;&gt;</code> te retourneren voor dynamische en geheugenarme verwerkingseffecten</p>
<pre><code class="language-csharp">void Main()
{
    var value = new Order[] {
        new Order(){OrderNo = &quot;SO01&quot;,CustomerID=&quot;C001&quot;,ProductID=&quot;P001&quot;,Qty=100,Amt=500},
        new Order(){OrderNo = &quot;SO02&quot;,CustomerID=&quot;C002&quot;,ProductID=&quot;P002&quot;,Qty=300,Amt=400},
    };

    Console.WriteLine(&quot;en-Us en Sales rol&quot;);
    {
        var path = Path.GetTempPath() + Guid.NewGuid() + &quot;.xlsx&quot;;
        var lang = &quot;en-US&quot;;
        var role = &quot;Sales&quot;;
        MiniExcel.SaveAs(path, GetOrders(lang, role, value));
</code></pre>
<pre><code class="language-csharp">        MiniExcel.Query(path, true).Dump();
    }

    Console.WriteLine(&quot;zh-CN en PMC rol&quot;);
    {
        var path = Path.GetTempPath() + Guid.NewGuid() + &quot;.xlsx&quot;;
        var lang = &quot;zh-CN&quot;;
        var role = &quot;PMC&quot;;
        MiniExcel.SaveAs(path, GetOrders(lang, role, value));
        MiniExcel.Query(path, true).Dump();
    }
}

private IEnumerable&lt;Dictionary&lt;string, object&gt;&gt; GetOrders(string lang, string role, Order[] orders)
{
    foreach (var order in orders)
    {
        var newOrder = new Dictionary&lt;string, object&gt;();

        if (lang == &quot;zh-CN&quot;)
        {
            newOrder.Add(&quot;客户编号&quot;, order.CustomerID);
            newOrder.Add(&quot;订单编号&quot;, order.OrderNo);
            newOrder.Add(&quot;产品编号&quot;, order.ProductID);
            newOrder.Add(&quot;数量&quot;, order.Qty);
            if (role == &quot;Sales&quot;)
                newOrder.Add(&quot;价格&quot;, order.Amt);
            yield return newOrder;
        }
        else if (lang == &quot;en-US&quot;)
        {
            newOrder.Add(&quot;Customer ID&quot;, order.CustomerID);
            newOrder.Add(&quot;Order No&quot;, order.OrderNo);
            newOrder.Add(&quot;Product ID&quot;, order.ProductID);
            newOrder.Add(&quot;Quantity&quot;, order.Qty);
            if (role == &quot;Sales&quot;)
                newOrder.Add(&quot;Amount&quot;, order.Amt);
            yield return newOrder;
        }
        else
        {
            throw new InvalidDataException($&quot;lang {lang} wrong&quot;);
        }
    }
}

public class Order
{
    public string OrderNo { get; set; }
    public string CustomerID { get; set; }
    public decimal Qty { get; set; }
    public string ProductID { get; set; }
    public decimal Amt { get; set; }
}
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/118939964-d24bc480-b982-11eb-88dd-f06655f6121a.png" alt="image" /></p>
<h3>FAQ</h3>
<h4>V: Excel-koptitel is niet gelijk aan de klasse-eigenschapsnaam, hoe te mappen?</h4>
<p>A. Gebruik alstublieft het ExcelColumnName-attribuut</p>
<p><img src="https://user-images.githubusercontent.com/12729184/116020475-eac50980-a678-11eb-8804-129e87200e5e.png" alt="image" /></p>
<h4>V. Hoe queryen of exporteren van meerdere sheets?</h4>
<p>A. Gebruik de methode <code>GetSheetNames</code> met de  Query  parameter sheetName.</p>
<pre><code class="language-csharp">var sheets = MiniExcel.GetSheetNames(path);
foreach (var sheet in sheets)
{
    Console.WriteLine($&quot;sheet name : {sheet} &quot;);
    var rows = MiniExcel.Query(path,useHeaderRow:true,sheetName:sheet);
    Console.WriteLine(rows);
}
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/116199841-2a1f5300-a76a-11eb-90a3-6710561cf6db.png" alt="image" /></p>
<h4>V. Hoe queryen of exporteren van informatie over sheet-zichtbaarheid?</h4>
<p>A. Gebruik de methode <code>GetSheetInformations</code>.</p>
<pre><code class="language-csharp">var sheets = MiniExcel.GetSheetInformations(path);
foreach (var sheetInfo in sheets)
{
    Console.WriteLine($&quot;sheet index : {sheetInfo.Index} &quot;); // volgende sheet index - genummerd vanaf 0
    Console.WriteLine($&quot;sheet name : {sheetInfo.Name} &quot;);   // sheetnaam
    Console.WriteLine($&quot;sheet state : {sheetInfo.State} &quot;); // sheet zichtbaarheidstoestand - zichtbaar / verborgen
}
</code></pre>
<pre><code>

#### V. Zal het gebruik van Count alle data in het geheugen laden?

Nee, de afbeeldingstest heeft 1 miljoen rijen*10 kolommen aan data, het maximale geheugengebruik is &lt;60MB, en het duurt 13,65 seconden

![image](https://user-images.githubusercontent.com/12729184/117118518-70586000-adc3-11eb-9ce3-2ba76cf8b5e5.png)

#### V. Hoe gebruikt Query gehele getal indexen?

De standaard index van Query is de string Key: A,B,C.... Als u wilt overschakelen naar een numerieke index, maak dan de volgende methode aan om te converteren

```csharp
void Main()
{
    var path = @&quot;D:\git\MiniExcel\samples\xlsx\TestTypeMapping.xlsx&quot;;
    var rows = MiniExcel.Query(path,true);
    foreach (var r in ConvertToIntIndexRows(rows))
    {
        Console.Write($&quot;kolom 0 : {r[0]} ,kolom 1 : {r[1]}&quot;);
        Console.WriteLine();
    }
}

private IEnumerable&lt;Dictionary&lt;int, object&gt;&gt; ConvertToIntIndexRows(IEnumerable&lt;object&gt; rows)
{
    ICollection&lt;string&gt; keys = null;
    var isFirst = true;
    foreach (IDictionary&lt;string,object&gt; r in rows)
    {
        if(isFirst)
        {
            keys = r.Keys;
            isFirst = false;
        }

        var dic = new Dictionary&lt;int, object&gt;();
        var index = 0;
        foreach (var key in keys)
            dic[index++] = r[key];
        yield return dic;
    }
}
</code></pre>
<h4>V. Er wordt een lege Excel zonder titel gegenereerd wanneer de waarde leeg is bij het exporteren van Excel</h4>
<p>Omdat MiniExcel een vergelijkbare logica als JSON.NET gebruikt om dynamisch het type uit waarden te halen om API-bewerkingen te vereenvoudigen, kan het type niet bekend zijn zonder data. Zie <a href="https://github.com/mini-software/MiniExcel/issues/133">issue #133</a> voor meer informatie.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/122639771-546c0c00-d12e-11eb-800c-498db27889ca.png" alt="image" /></p>
<blockquote>
<p>Sterk getypeerd &amp; DataTable zal headers genereren, maar Dictionary blijft een lege Excel</p>
</blockquote>
<h4>V. Hoe stop je de foreach bij een lege rij?</h4>
<p>MiniExcel kan worden gebruikt met <code>LINQ TakeWhile</code> om de foreach-iterator te stoppen.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/130209137-162621c2-f337-4479-9996-beeac65bc4d4.png" alt="Image" /></p>
<h4>V. Hoe verwijder je lege rijen?</h4>
<p><img src="https://user-images.githubusercontent.com/12729184/137873865-7107d8f5-eb59-42db-903a-44e80589f1b2.png" alt="image" /></p>
<p>IEnumerable :</p>
<pre><code class="language-csharp">public static IEnumerable&lt;dynamic&gt; QueryWithoutEmptyRow(Stream stream, bool useHeaderRow, string sheetName, ExcelType excelType, string startCell, IConfiguration configuration)
{
    var rows = stream.Query(useHeaderRow,sheetName,excelType,startCell,configuration);
    foreach (IDictionary&lt;string,object&gt; row in rows)
    {
        if(row.Keys.Any(key=&gt;row[key]!=null))
            yield return row;
    }
}
</code></pre>
<p>DataTable :</p>
<pre><code class="language-csharp">public static DataTable QueryAsDataTableWithoutEmptyRow(Stream stream, bool useHeaderRow, string sheetName, ExcelType excelType, string startCell, IConfiguration configuration)
{
    if (sheetName == null &amp;&amp; excelType != ExcelType.CSV) /*Issue #279*/
        sheetName = stream.GetSheetNames().First();

    var dt = new DataTable(sheetName);
    var first = true;
    var rows = stream.Query(useHeaderRow,sheetName,excelType,startCell,configuration);
    foreach (IDictionary&lt;string, object&gt; row in rows)
    {
        if (first)
        {

            foreach (var key in row.Keys)
            {
                var column = new DataColumn(key, typeof(object)) { Caption = key };
</code></pre>
<pre><code class="language-csharp">                dt.Columns.Add(column);
            }

            dt.BeginLoadData();
            first = false;
        }

        var newRow = dt.NewRow();
        var isNull=true;
        foreach (var key in row.Keys)
        {
            var _v = row[key];
            if(_v!=null)
                isNull = false;
            newRow[key] = _v;
        }

        if(!isNull)
            dt.Rows.Add(newRow);
    }

    dt.EndLoadData();
    return dt;
}
</code></pre>
<h4>V. Hoe SaveAs(path,value) gebruiken om een bestaand bestand te vervangen zonder de foutmelding &quot;The file ...xlsx already exists error&quot;</h4>
<p>Gebruik de Stream-klasse om aangepaste logica voor het aanmaken van bestanden te implementeren, bijvoorbeeld:</p>
<pre><code class="language-C#">    using (var stream = File.Create(&quot;Demo.xlsx&quot;))
        MiniExcel.SaveAs(stream,value);
</code></pre>
<p>of, sinds V1.25.0, ondersteunt SaveAs de parameter overwriteFile om het overschrijven van een bestaand bestand mogelijk of onmogelijk te maken</p>
<pre><code class="language-csharp">    MiniExcel.SaveAs(path, value, overwriteFile: true);
</code></pre>
<h3>Beperkingen en kanttekeningen</h3>
<ul>
<li>Ondersteunt momenteel geen xls- en versleutelde bestanden</li>
<li>xlsm ondersteunt alleen Query</li>
</ul>
<h3>Referentie</h3>
<p><a href="https://github.com/ExcelDataReader/ExcelDataReader">ExcelDataReader</a>  / <a href="https://github.com/ClosedXML/ClosedXML">ClosedXML</a> / <a href="https://github.com/DapperLib/Dapper">Dapper</a> / <a href="https://github.com/andersnm/ExcelNumberFormat">ExcelNumberFormat</a></p>
<h3>Dankwoord</h3>
<h4><a href="https://www.jetbrains.com/">Jetbrains</a></h4>
<p><img src="https://user-images.githubusercontent.com/12729184/123997015-8456c180-da02-11eb-829a-aec476fe8e94.png" alt="jetbrains-variant-2" /></p>
<p>Dank voor het gratis ter beschikking stellen van een All product IDE voor dit project (<a href="https://user-images.githubusercontent.com/12729184/123988233-6ab17c00-d9fa-11eb-8739-2a08c6a4a263.png">Licentie</a>)</p>
<h3>Donatie voor bijdrage delen</h3>
<p>Link https://github.com/orgs/mini-software/discussions/754</p>
<h3>Bijdragers</h3>
<p><img src="https://contrib.rocks/image?repo=mini-software/MiniExcel" alt="" /></p>
<pre><code>

---


Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-02


---
</code></pre>

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>