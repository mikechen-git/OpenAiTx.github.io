<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniExcel - mini-software/MiniExcel tr</title>
    <meta name="title" content="MiniExcel - mini-software/MiniExcel tr | Bu proje .NET Foundation'ın bir parçasıdır ve onların davranış kurallarına tabidir. English | 简体中文 | 繁體中文 Sizin Yıldızınız ve Bağışınız MiniExcel'i daha iyi yap...">
    <meta name="description" content="mini-software/MiniExcel - GitHub repository tr documentation and information | Bu proje .NET Foundation'ın bir parçasıdır ve onların davranış kurallarına tabidir. English | 简体中文 | 繁體中文 Sizin Yıldızınız ve Bağışınız MiniExcel'i daha iyi yap...">
    <meta name="keywords" content="mini-software, MiniExcel, GitHub, repository, tr documentation">
    <meta name="author" content="Open AI Tx">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://openaitx.github.io/projects/mini-software/MiniExcel/README-tr.html">
    <meta property="og:title" content="MiniExcel - mini-software/MiniExcel tr | Bu proje .NET Foundation'ın bir parçasıdır ve onların davranış kurallarına tabidir. English | 简体中文 | 繁體中文 Sizin Yıldızınız ve Bağışınız MiniExcel'i daha iyi yap...">
    <meta property="og:description" content="mini-software/MiniExcel - GitHub repository tr documentation and information | Bu proje .NET Foundation'ın bir parçasıdır ve onların davranış kurallarına tabidir. English | 简体中文 | 繁體中文 Sizin Yıldızınız ve Bağışınız MiniExcel'i daha iyi yap...">
    <meta property="og:image" content="https://openaitx.github.io/logo_crop.png">
    <link rel="icon" type="image/jpeg" href="/icon.jpg">
    <link rel="apple-touch-icon" href="/icon.jpg">
    <script src="/js/marked.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/css/github.min.css?v=20250613">
    <script src="/js/highlight.min.js?v=20250613"></script>
    <link rel="stylesheet" href="/view.css?v=20250613">
    <style>
        body { display: flex; flex-direction: column; min-height: 100vh; }
        .main-container { margin: 0 auto; width: 100%; max-width: 980px; padding: 0 20px; }
        @media (max-width: 768px) { .main-container { padding: 0 15px; } }
        .markdown-body img { max-width: 100%; height: auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background-color: #f6f8fa; border-bottom: 1px solid #e1e4e8; position: relative; }
        .header .links { margin-top: 10px; font-size: 16px; }
        .header .links a { color: #0366d6; text-decoration: none; margin-left: 5px; }
        .header .links a:hover { text-decoration: underline; }
        .language-badges { margin-top: 15px; text-align: center; }
        .language-badges a { display: inline-block; margin: 2px; text-decoration: none; }
        .language-badges img { height: 20px; border-radius: 3px; }
        .language-badges a:hover img { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="header">
        <div class="links">
            GitHub Repository: <a href="https://github.com/mini-software/MiniExcel" id="githubRepoLink" target="_blank">mini-software/MiniExcel</a>
<h1 style="display: none;">Bu proje .NET Foundation'ın bir parçasıdır ve onların davranış kurallarına tabidir. English | 简体中文 | 繁體中文 Sizin Yıldızınız ve Bağışınız MiniExcel'i daha iyi yap...</h1>
        </div>
        <div class="language-badges" id="languageBadges">
            <!-- You can generate language badges here if needed -->
        </div>
    </div>
    <div class="main-container">
        <div class="markdown-body" id="content">
            <div style="text-align: center">
<p><a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/nuget/v/MiniExcel.svg" alt="NuGet"></a>  <a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/nuget/dt/MiniExcel.svg" alt=""></a>
<a href="https://ci.appveyor.com/project/mini-software/miniexcel/branch/master"><img src="https://ci.appveyor.com/api/projects/status/b2vustrwsuqx45f4/branch/master?svg=true" alt="Build status"></a>
<a href="https://gitee.com/dotnetchina/MiniExcel"><img src="https://gitee.com/dotnetchina/MiniExcel/badge/star.svg" alt="star"></a> <a href="https://github.com/mini-software/MiniExcel" rel="nofollow"><img src="https://img.shields.io/github/stars/mini-software/MiniExcel?logo=github" alt="GitHub stars"></a>
<a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/badge/.NET-%3E%3D%204.5-red.svg" alt="version"></a>
<a href="https://deepwiki.com/mini-software/MiniExcel"><img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki"></a>
</p>
</div>
<hr />
<p><a href="https://www.dotnetfoundation.org/"><img align="right" src="https://github.com/dotnet-foundation/swag/blob/main/logo/dotnetfoundation_v4.png?raw=true" width="100" /></a></p>
<div style="text-align: center">
<p>Bu proje <a href="https://www.dotnetfoundation.org/">.NET Foundation</a>'ın bir parçasıdır ve onların <a href="https://www.dotnetfoundation.org/code-of-conduct">davranış kurallarına</a> tabidir.</p>
</div>
<hr />
<div style="text-align: center">
<p><strong><a href="README.md">English</a> | <a href="README.zh-CN.md">简体中文</a> | <a href="README.zh-Hant.md">繁體中文</a></strong></p>
</div>
<hr />
<div style="text-align: center">
 Sizin <a href="https://github.com/mini-software/MiniExcel">Yıldızınız</a> ve <a href="https://miniexcel.github.io">Bağışınız</a> MiniExcel'i daha iyi yapabilir
</div>
<hr />
<h3>Giriş</h3>
<p>MiniExcel, OOM'dan (bellek taşması) kaçınmak için basit ve verimli bir .NET Excel işleme aracıdır.</p>
<p>Şu anda en popüler frameworkler, işlemleri kolaylaştırmak için tüm verileri belleğe yüklemeye ihtiyaç duyar, fakat bu durum bellek tüketimi sorunlarına yol açar. MiniExcel, algoritmayı bir akış (stream) üzerinden kullanarak orijinalde 1000 MB olan bellek kullanımını birkaç MB'a düşürmeye ve OOM'dan (bellek taşması) kaçınmaya çalışır.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/113086657-ab8bd000-9214-11eb-9563-c970ac1ee35e.png" alt="image" /></p>
<h3>Özellikler</h3>
<ul>
<li>Düşük bellek tüketimi, OOM'dan (bellek taşması) ve tam GC'den kaçınır</li>
<li>Her veri satırı üzerinde gerçek zamanlı işlem desteği</li>
<li>LINQ ertelenmiş yürütme desteği, düşük tüketimli, hızlı sayfalama ve diğer karmaşık sorgulamaları yapabilir</li>
<li>Hafif, Microsoft Office kurulumu gerektirmez, COM+ yok, DLL boyutu 400KB'den küçük</li>
<li>Excel okuma/yazma/doldurma için kolay API stili</li>
</ul>
<h3>Hızlı Başlangıç</h3>
<ul>
<li><p><a href="#getstart1">Excel İçe Aktar/Sorgu</a></p>
</li>
<li><p><a href="#getstart2">Excel Dışa Aktar/Oluştur</a></p>
</li>
<li><p><a href="#getstart3">Excel Şablonu</a></p>
</li>
<li><p><a href="#getstart4">Excel Sütun Adı/İndeks/Yoksayma Özelliği</a></p>
</li>
<li><p><a href="#getstart5">Örnekler</a></p>
</li>
</ul>
<h3>Kurulum</h3>
<p>Paketi <a href="https://www.nuget.org/packages/MiniExcel">NuGet üzerinden</a> yükleyebilirsiniz</p>
<h3>Sürüm Notları</h3>
<p>Lütfen <a href="docs">Sürüm Notları</a> bölümüne bakın</p>
<h3>YAPILACAKLAR</h3>
<p>Lütfen <a href="https://github.com/mini-software/MiniExcel/projects/1?fullscreen=true">TODO</a> bölümüne bakın</p>
<h3>Performans</h3>
<p>Kıyaslama kodlarına <a href="benchmarks/MiniExcel.Benchmarks/Program.cs">MiniExcel.Benchmarks</a> üzerinden ulaşabilirsiniz.</p>
<p>Performans testlerinde kullanılan dosya <a href="benchmarks/MiniExcel.Benchmarks/Test1%2C000%2C000x10.xlsx"><strong>Test1,000,000x10.xlsx</strong></a>, her bir hücresinde &quot;HelloWorld&quot; yazan, 1.000.000 satır * 10 sütundan oluşan 32MB'lık bir belgedir.</p>
<p>Tüm kıyaslamaları çalıştırmak için:</p>
<pre><code class="language-bash">dotnet run -project .\benchmarks\MiniExcel.Benchmarks -c Release -f net9.0 -filter * --join
</code></pre>
<p>Son sürüme ait kıyaslama sonuçlarını <a href="benchmarks/results">burada</a> bulabilirsiniz.</p>
<h3>Excel Sorgu/İçe Aktar  <a name="getstart1"></a></h3>
<h4>1. Sorgu çalıştır ve sonuçları güçlü türde bir IEnumerable'a eşle <a href="https://dotnetfiddle.net/w5WD1J">[Deneyin]</a></h4>
<p>Daha iyi verimlilik için Stream.Query kullanılması önerilir.</p>
<pre><code class="language-csharp">public class UserAccount
{
    public Guid ID { get; set; }
    public string Name { get; set; }
    public DateTime BoD { get; set; }
    public int Age { get; set; }
    public bool VIP { get; set; }
    public decimal Points { get; set; }
}

var rows = MiniExcel.Query&lt;UserAccount&gt;(path);

// veya

using (var stream = File.OpenRead(path))
    var rows = stream.Query&lt;UserAccount&gt;();
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/111107423-c8c46b80-8591-11eb-982f-c97a2dafb379.png" alt="image" /></p>
<h4>2. Başlık kullanmadan sorgu çalıştır ve sonucu dinamik nesne listesine eşle <a href="https://dotnetfiddle.net/w5WD1J">[Deneyin]</a></h4>
<ul>
<li>dinamik anahtar <code>A.B.C.D..</code></li>
</ul>
<p>| MiniExcel | 1 |
|-----------|---|
| Github    | 2 |</p>
<pre><code class="language-csharp">
var rows = MiniExcel.Query(path).ToList();

// veya
using (var stream = File.OpenRead(path))
{
    var rows = stream.Query().ToList();

    Assert.Equal(&quot;MiniExcel&quot;, rows[0].A);
    Assert.Equal(1, rows[0].B);
    Assert.Equal(&quot;Github&quot;, rows[1].A);
    Assert.Equal(2, rows[1].B);
}
</code></pre>
<h4>3. İlk başlık satırıyla sorgu çalıştır <a href="https://dotnetfiddle.net/w5WD1J">[Deneyin]</a></h4>
<p>not : aynı sütun adı için en sağdaki kullanılır</p>
<p>Excel Girişi :</p>
<p>| Column1   | Column2 |
|-----------|---------|
| MiniExcel | 1       |
| Github    | 2       |</p>
<pre><code class="language-csharp">
var rows = MiniExcel.Query(useHeaderRow:true).ToList();

// veya

using (var stream = File.OpenRead(path))
{
    var rows = stream.Query(useHeaderRow:true).ToList();

    Assert.Equal(&quot;MiniExcel&quot;, rows[0].Column1);
    Assert.Equal(1, rows[0].Column2);
    Assert.Equal(&quot;Github&quot;, rows[1].Column1);
    Assert.Equal(2, rows[1].Column2);
}
</code></pre>
<h4>4. Sorguda LINQ Uzantı First/Take/Skip ...vs destekler</h4>
<p>İlk Değeri Sorgula</p>
<pre><code class="language-csharp">var row = MiniExcel.Query(path).First();
Assert.Equal(&quot;HelloWorld&quot;, row.A);

// veya

using (var stream = File.OpenRead(path))
{
    var row = stream.Query().First();
    Assert.Equal(&quot;HelloWorld&quot;, row.A);
}
</code></pre>
<p>MiniExcel/ExcelDataReader/ClosedXML/EPPlus performans karşılaştırması
<img src="https://user-images.githubusercontent.com/12729184/111072392-6037a900-8515-11eb-9693-5ce2dad1e460.gif" alt="queryfirst" /></p>
<h4>5. Sayfa adına göre sorgu</h4>
<pre><code class="language-csharp">MiniExcel.Query(path, sheetName: &quot;SheetName&quot;);
//veya
stream.Query(sheetName: &quot;SheetName&quot;);
</code></pre>
<h4>6. Tüm sayfa adlarını ve satırları sorgula</h4>
<pre><code class="language-csharp">var sheetNames = MiniExcel.GetSheetNames(path);
foreach (var sheetName in sheetNames)
{
    var rows = MiniExcel.Query(path, sheetName: sheetName);
}
</code></pre>
<h4>7. Sütunları Al</h4>
<pre><code class="language-csharp">var columns = MiniExcel.GetColumns(path); // örn. sonuç : [&quot;A&quot;,&quot;B&quot;...]

var cnt = columns.Count;  // sütun sayısını al
</code></pre>
<h4>8. Dinamik Sorgu satırı <code>IDictionary&lt;string,object&gt;</code>'e dönüştürme</h4>
<pre><code class="language-csharp">foreach(IDictionary&lt;string,object&gt; row in MiniExcel.Query(path))
{
    //..
}

// veya
var rows = MiniExcel.Query(path).Cast&lt;IDictionary&lt;string,object&gt;&gt;();
// veya Belirtilen aralıkları sorgula (büyük harfli)
// A2, A sütununun ikinci satırını, C3 ise C sütununun üçüncü satırını temsil eder
// Sadece satırları kısıtlamak istemiyorsanız, sayıları dahil etmeyin
var rows = MiniExcel.QueryRange(path, startCell: &quot;A2&quot;, endCell: &quot;C3&quot;).Cast&lt;IDictionary&lt;string, object&gt;&gt;();
</code></pre>
<h4>9. Excel Sorgulama ile DataTable Döndürme</h4>
<p>Tavsiye edilmez, çünkü DataTable tüm veriyi belleğe yükler ve MiniExcel'in düşük bellek tüketimi özelliğini kaybettirir.</p>
<pre><code class="language-C#">var table = MiniExcel.QueryAsDataTable(path, useHeaderRow: true);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/116673475-07917200-a9d6-11eb-947e-a6f68cce58df.png" alt="image" /></p>
<h4>10. Veriyi Okumaya Başlanacak Hücreyi Belirtme</h4>
<pre><code class="language-csharp">MiniExcel.Query(path,useHeaderRow:true,startCell:&quot;B3&quot;)
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/117260316-8593c400-ae81-11eb-9877-c087b7ac2b01.png" alt="image" /></p>
<h4>11. Birleştirilmiş Hücreleri Doldur</h4>
<p>Not: Verimlilik, <code>birleştirme doldurma kullanılmadığında</code> göre daha yavaştır.</p>
<p>Sebep: OpenXml standardı mergeCells'i dosyanın en altına koyar, bu da sheetxml'in iki kez foreach ile gezilmesi gerektiği anlamına gelir.</p>
<pre><code class="language-csharp">    var config = new OpenXmlConfiguration()
    {
        FillMergedCells = true
    };
    var rows = MiniExcel.Query(path, configuration: config);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/117973630-3527d500-b35f-11eb-95c3-bde255f8114e.png" alt="image" /></p>
<p>değişken uzunluk ve genişlikte çoklu satır ve sütun doldurma desteklenir</p>
<p><img src="https://user-images.githubusercontent.com/12729184/117973820-6d2f1800-b35f-11eb-88d8-555063938108.png" alt="image" /></p>
<h4>12. Disk tabanlı önbellek ile büyük dosya okuma (Disk-Tabanlı Önbellek - SharedString)</h4>
<p>SharedStrings boyutu 5 MB'ı aşarsa, MiniExcel varsayılan olarak yerel disk önbelleği kullanır, örn, <a href="https://github.com/MiniExcel/MiniExcel/files/8403819/NotDuplicateSharedStrings_10x100000.xlsx">10x100000.xlsx</a> (bir milyon satır veri), disk önbelleği devre dışı bırakıldığında maksimum bellek kullanımı 195MB'dır, ancak disk önbelleği etkinleştirildiğinde sadece 65MB gerekir. Dikkat, bu optimizasyonun bir miktar verimlilik maliyeti vardır, bu nedenle bu durumda okuma süresi 7.4 saniyeden 27.2 saniyeye çıkar. Eğer buna ihtiyacınız yoksa disk önbelleğini aşağıdaki kod ile devre dışı bırakabilirsiniz:</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration { EnableSharedStringCache = false };
MiniExcel.Query(path,configuration: config)
</code></pre>
<p><code>SharedStringCacheSize </code> ile sharedString dosya boyutunu, disk önbellekleme için aşılması gereken boyutu değiştirebilirsiniz.</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration { SharedStringCacheSize=500*1024*1024 };
MiniExcel.Query(path, configuration: config);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/161411851-1c3f72a7-33b3-4944-84dc-ffc1d16747dd.png" alt="image" /></p>
<p><img src="https://user-images.githubusercontent.com/12729184/161411825-17f53ec7-bef4-4b16-b234-e24799ea41b0.png" alt="image" /></p>
<h3>Excel Oluştur/İhracat Et  <a name="getstart2"></a></h3>
<ol>
<li><p>Ortak parametresiz kurucuya sahip soyut olmayan bir tip olmalı.</p>
</li>
<li><p>MiniExcel, parametre olarak IEnumerable Ertelenmiş Yürütme'yi destekler. En az bellek kullanmak istiyorsanız, ToList gibi metodları çağırmayınız.</p>
</li>
</ol>
<p>örn : ToList ile veya olmadan bellek kullanımı
<img src="https://user-images.githubusercontent.com/12729184/112587389-752b0b00-8e38-11eb-8a52-cfb76c57e5eb.png" alt="image" /></p>
<h4>1. Anonim veya güçlü tip <a href="https://dotnetfiddle.net/w5WD1J">[Deneyin]</a></h4>
<pre><code class="language-csharp">var path = Path.Combine(Path.GetTempPath(), $&quot;{Guid.NewGuid()}.xlsx&quot;);
MiniExcel.SaveAs(path, new[] {
    new { Column1 = &quot;MiniExcel&quot;, Column2 = 1 },
    new { Column1 = &quot;Github&quot;, Column2 = 2}
});
</code></pre>
<h4>2. <code>IEnumerable&lt;IDictionary&lt;string, object&gt;&gt;</code></h4>
<pre><code class="language-csharp">var values = new List&lt;Dictionary&lt;string, object&gt;&gt;()
{
    new Dictionary&lt;string,object&gt;{{ &quot;Column1&quot;, &quot;MiniExcel&quot; }, { &quot;Column2&quot;, 1 } },
    new Dictionary&lt;string,object&gt;{{ &quot;Column1&quot;, &quot;Github&quot; }, { &quot;Column2&quot;, 2 } }
};
MiniExcel.SaveAs(path, values);
</code></pre>
<p>Oluşturulan Dosya Sonucu :</p>
<p>| Column1   | Column2 |
|-----------|---------|
| MiniExcel | 1       |
| Github    | 2       |</p>
<h4>3.  IDataReader</h4>
<ul>
<li><code>Tavsiye edilir</code>, tüm veriyi belleğe yüklemekten kaçınır</li>
</ul>
<pre><code class="language-csharp">MiniExcel.SaveAs(path, reader);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/121275378-149a5e80-c8bc-11eb-85fe-5453552134f0.png" alt="image" /></p>
<p>DataReader ile birden fazla sayfa dışa aktarımı (Dapper ExecuteReader ile önerilir)</p>
<pre><code class="language-csharp">using (var cnn = Connection)
{
    cnn.Open();
    var sheets = new Dictionary&lt;string,object&gt;();
    sheets.Add(&quot;sheet1&quot;, cnn.ExecuteReader(&quot;select 1 id&quot;));
    sheets.Add(&quot;sheet2&quot;, cnn.ExecuteReader(&quot;select 2 id&quot;));
    MiniExcel.SaveAs(&quot;Demo.xlsx&quot;, sheets);
}
</code></pre>
<h4>4. Datatable</h4>
<ul>
<li><p><code>Tavsiye edilmez</code>, tüm veriyi belleğe yükler</p>
</li>
<li><p>DataTable önce sütun adı için Caption'ı, sonra columname'i kullanır</p>
</li>
</ul>
<pre><code class="language-csharp">var path = Path.Combine(Path.GetTempPath(), $&quot;{Guid.NewGuid()}.xlsx&quot;);
var table = new DataTable();
{
    table.Columns.Add(&quot;Column1&quot;, typeof(string));
    table.Columns.Add(&quot;Column2&quot;, typeof(decimal));
    table.Rows.Add(&quot;MiniExcel&quot;, 1);
    table.Rows.Add(&quot;Github&quot;, 2);
}

MiniExcel.SaveAs(path, table);
</code></pre>
<h4>5. Dapper Sorgusu</h4>
<p>Teşekkürler @shaofing #552 , lütfen <code>CommandDefinition + CommandFlags.NoCache</code> kullanın</p>
<pre><code class="language-csharp">using (var connection = GetConnection(connectionString))
{
    var rows = connection.Query(
        new CommandDefinition(
            @&quot;select 'MiniExcel' as Column1,1 as Column2 union all select 'Github',2&quot;
            , flags: CommandFlags.NoCache)
        );
    // Not: QueryAsync kapalı bağlantı hatası fırlatır
    MiniExcel.SaveAs(path, rows);
</code></pre>
<pre><code>}

</code></pre>
<p>Aşağıdaki kod tüm verileri belleğe yükleyecektir</p>
<pre><code class="language-csharp">using (var connection = GetConnection(connectionString))
{
    var rows = connection.Query(@&quot;select 'MiniExcel' as Column1,1 as Column2 union all select 'Github',2&quot;);
    MiniExcel.SaveAs(path, rows);
}
</code></pre>
<h4>6. Bellek Akışına (MemoryStream) Kaydetme  <a href="https://dotnetfiddle.net/JOen0e">[Deneyin]</a></h4>
<pre><code class="language-csharp">using (var stream = new MemoryStream()) // FileStream, MemoryStream vb. desteklenir.
{
    stream.SaveAs(values);
}
</code></pre>
<p>Örneğin : excel dışa aktarma api'si</p>
<pre><code class="language-csharp">public IActionResult DownloadExcel()
{
    var values = new[] {
        new { Column1 = &quot;MiniExcel&quot;, Column2 = 1 },
        new { Column1 = &quot;Github&quot;, Column2 = 2}
    };

    var memoryStream = new MemoryStream();
    memoryStream.SaveAs(values);
    memoryStream.Seek(0, SeekOrigin.Begin);
    return new FileStreamResult(memoryStream, &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)
    {
        FileDownloadName = &quot;demo.xlsx&quot;
    };
}
</code></pre>
<h4>7. Çoklu Sayfa Oluşturma</h4>
<pre><code class="language-csharp">// 1. Dictionary&lt;string,object&gt;
var users = new[] { new { Name = &quot;Jack&quot;, Age = 25 }, new { Name = &quot;Mike&quot;, Age = 44 } };
var department = new[] { new { ID = &quot;01&quot;, Name = &quot;HR&quot; }, new { ID = &quot;02&quot;, Name = &quot;IT&quot; } };
var sheets = new Dictionary&lt;string, object&gt;
{
    [&quot;users&quot;] = users,
    [&quot;department&quot;] = department
};
MiniExcel.SaveAs(path, sheets);

// 2. DataSet
var sheets = new DataSet();
sheets.Add(UsersDataTable);
sheets.Add(DepartmentDataTable);
//..
MiniExcel.SaveAs(path, sheets);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/118130875-6e7c4580-b430-11eb-9b82-22f02716bd63.png" alt="image" /></p>
<h4>8. Tablo Stilleri Seçenekleri</h4>
<p>Varsayılan stil</p>
<p><img src="https://user-images.githubusercontent.com/12729184/138234373-cfa97109-b71f-4711-b7f5-0eaaa4a0a3a6.png" alt="image" /></p>
<p>Stil yapılandırması olmadan</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration()
{
     TableStyles = TableStyles.None
};
MiniExcel.SaveAs(path, value,configuration:config);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/118784917-f3e57700-b8c2-11eb-8718-8d955b1bc197.png" alt="image" /></p>
<h4>9. Otomatik Filtre (AutoFilter)</h4>
<p>v0.19.0'dan itibaren <code>OpenXmlConfiguration.AutoFilter</code> ile Otomatik Filtre etkinleştirilebilir/devre dışı bırakılabilir, varsayılan değeri <code>true</code>'dur. Otomatik Filtre ayarlama şekli:</p>
<pre><code class="language-csharp">MiniExcel.SaveAs(path, value, configuration: new OpenXmlConfiguration() { AutoFilter = false });
</code></pre>
<h4>10. Resim Oluşturma</h4>
<pre><code class="language-csharp">var value = new[] {
    new { Name=&quot;github&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/github_logo.png&quot;))},
    new { Name=&quot;google&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/google_logo.png&quot;))},
    new { Name=&quot;microsoft&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/microsoft_logo.png&quot;))},
    new { Name=&quot;reddit&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/reddit_logo.png&quot;))},
    new { Name=&quot;statck_overflow&quot;,Image=File.ReadAllBytes(PathHelper.GetFile(&quot;images/statck_overflow_logo.png&quot;))},
};
MiniExcel.SaveAs(path, value);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/150462383-ad9931b3-ed8d-4221-a1d6-66f799743433.png" alt="image" /></p>
<h4>11. Bayt Dizisi Dosya Aktarımı</h4>
<p>1.22.0'dan itibaren, değer tipi <code>byte[]</code> olduğunda sistem varsayılan olarak dosya yolunu hücrede kaydeder ve içe aktarımda sistem <code>byte[]</code>'ye dönüştürebilir. Bunu kullanmak istemiyorsanız, <code>OpenXmlConfiguration.EnableConvertByteArray</code>'i <code>false</code> olarak ayarlayabilirsiniz, bu sistem verimliliğini artırabilir.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/153702334-c3b834f4-6ae4-4ddf-bd4e-e5005d5d8c6a.png" alt="image" /></p>
<p>1.22.0'dan itibaren, değer tipi <code>byte[]</code> olduğunda sistem varsayılan olarak dosya yolunu hücrede kaydeder ve içe aktarımda sistem <code>byte[]</code>'ye dönüştürebilir. Bunu kullanmak istemiyorsanız, <code>OpenXmlConfiguration.EnableConvertByteArray</code>'i <code>false</code> olarak ayarlayabilirsiniz, bu sistem verimliliğini artırabilir.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/153702334-c3b834f4-6ae4-4ddf-bd4e-e5005d5d8c6a.png" alt="image" /></p>
<h4>12. Aynı Hücreleri Dikey Olarak Birleştirme</h4>
<p>Bu işlev yalnızca <code>xlsx</code> formatında desteklenir ve @merge ile @endmerge etiketleri arasındaki hücreleri dikey olarak birleştirir.
@mergelimit kullanarak dikey birleştirme sınırlarını belirleyebilirsiniz.</p>
<pre><code class="language-csharp">var mergedFilePath = Path.Combine(Path.GetTempPath(), $&quot;{Guid.NewGuid().ToString()}.xlsx&quot;);

var path = @&quot;../../../../../samples/xlsx/TestMergeWithTag.xlsx&quot;;

MiniExcel.MergeSameCells(mergedFilePath, path);
</code></pre>
<pre><code class="language-csharp">var memoryStream = new MemoryStream();

var path = @&quot;../../../../../samples/xlsx/TestMergeWithTag.xlsx&quot;;

memoryStream.MergeSameCells(path);
</code></pre>
<p>Birleştirme öncesi ve sonrası dosya içeriği:</p>
<p>Birleştirme sınırı olmadan:</p>
<img width="318" alt="Screenshot 2023-08-07 at 11 59 24" src="https://github.com/mini-software/MiniExcel/assets/38832863/49cc96b9-6c35-4bf3-8d43-a9752a15b22e">
<img width="318" alt="Screenshot 2023-08-07 at 11 59 57" src="https://github.com/mini-software/MiniExcel/assets/38832863/3fbd529b-3ae6-4bbe-b4d8-2793a5a58010">
<p>Birleştirme sınırı ile:</p>
<img width="346" alt="Screenshot 2023-08-08 at 18 21 00" src="https://github.com/mini-software/MiniExcel/assets/38832863/04049d28-84d5-4c2a-bcff-5847547df5e1">
<img width="346" alt="Screenshot 2023-08-08 at 18 21 40" src="https://github.com/mini-software/MiniExcel/assets/38832863/f5cf8957-b0b0-4831-b8fc-8556299235c2">
<h4>13. Boş Değerleri Atla</h4>
<p>Boş değerler için boş hücre yazma konusunda yeni bir açık seçenek:</p>
<pre><code class="language-csharp">DataTable dt = new DataTable();

/* ... */

DataRow dr = dt.NewRow();

dr[&quot;Name1&quot;] = &quot;Somebody once&quot;;
dr[&quot;Name2&quot;] = null;
dr[&quot;Name3&quot;] = &quot;told me.&quot;;

dt.Rows.Add(dr);

OpenXmlConfiguration configuration = new OpenXmlConfiguration()
{
     EnableWriteNullValueCell = true // Varsayılan değer.
};

MiniExcel.SaveAs(@&quot;C:\temp\Book1.xlsx&quot;, dt, configuration: configuration);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/31481586/241419455-3c0aec8a-4e5f-4d83-b7ec-6572124c165d.png" alt="image" /></p>
<pre><code class="language-xml">&lt;x:row r=&quot;2&quot;&gt;
    &lt;x:c r=&quot;A2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;Somebody once&lt;/x:v&gt;
    &lt;/x:c&gt;
    &lt;x:c r=&quot;B2&quot; s=&quot;2&quot;&gt;&lt;/x:c&gt;
    &lt;x:c r=&quot;C2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;told me.&lt;/x:v&gt;
    &lt;/x:c&gt;
&lt;/x:row&gt;
</code></pre>
<p>Önceki davranış:</p>
<pre><code>```csharp
/* ... */

OpenXmlConfiguration configuration = new OpenXmlConfiguration()
{
     EnableWriteNullValueCell = false // Varsayılan değer true'dur.
};

MiniExcel.SaveAs(@&quot;C:\temp\Book1.xlsx&quot;, dt, configuration: configuration);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/31481586/241419441-c4f27e8f-3f87-46db-a10f-08665864c874.png" alt="image" /></p>
<pre><code class="language-xml">&lt;x:row r=&quot;2&quot;&gt;
    &lt;x:c r=&quot;A2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;Somebody once&lt;/x:v&gt;
    &lt;/x:c&gt;
    &lt;x:c r=&quot;B2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;&lt;/x:v&gt;
    &lt;/x:c&gt;
    &lt;x:c r=&quot;C2&quot; t =&quot;str&quot; s=&quot;2&quot;&gt;
        &lt;x:v&gt;told me.&lt;/x:v&gt;
    &lt;/x:c&gt;
&lt;/x:row&gt;
</code></pre>
<p>Null ve DBNull değerler için çalışır.</p>
<h4>14. Pencere Dondurma (Freeze Panes)</h4>
<pre><code class="language-csharp">/* ... */

OpenXmlConfiguration configuration = new OpenXmlConfiguration()
{
    FreezeRowCount = 1,     // varsayılan değer 1
    FreezeColumnCount = 2   // varsayılan değer 0
};

MiniExcel.SaveAs(@&quot;C:\temp\Book1.xlsx&quot;, dt, configuration: configuration);
</code></pre>
<p><img src="https://raw.githubusercontent.com/mini-software/MiniExcel/master/docs/images/freeze-pane-1.png" alt="image" /></p>
<h3>Excel Şablonuna Veri Doldurma <a name="getstart3"></a></h3>
<ul>
<li>Bildirim, Vue şablonundaki <code>{{değişken adı}}</code> veya koleksiyon işleme <code>{{koleksiyon adı.alan adı}}</code> ile benzerdir</li>
<li>Koleksiyon işleme IEnumerable/DataTable/DapperRow destekler</li>
</ul>
<h4>1. Temel Doldurma</h4>
<p>Şablon:
<img src="https://user-images.githubusercontent.com/12729184/114537556-ed8d2b00-9c84-11eb-8303-a69f62c41e5b.png" alt="image" /></p>
<p>Sonuç:
<img src="https://user-images.githubusercontent.com/12729184/114537490-d8180100-9c84-11eb-8c69-db58692f3a85.png" alt="image" /></p>
<p>Kod:</p>
<pre><code class="language-csharp">// 1. POCO ile
var value = new
{
    Name = &quot;Jack&quot;,
    CreateDate = new DateTime(2021, 01, 01),
    VIP = true,
    Points = 123
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);


// 2. Dictionary ile
var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;Name&quot;] = &quot;Jack&quot;,
    [&quot;CreateDate&quot;] = new DateTime(2021, 01, 01),
    [&quot;VIP&quot;] = true,
    [&quot;Points&quot;] = 123
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>2. IEnumerable Veri Doldurma</h4>
<blockquote>
<p>Not1: Listenin doldurulmasında aynı sütundan ilk IEnumerable temel alınır</p>
</blockquote>
<p>Şablon:
<img src="https://user-images.githubusercontent.com/12729184/114564652-14f2f080-9ca3-11eb-831f-09e3fedbc5fc.png" alt="image" /></p>
<p>Sonuç:
<img src="https://user-images.githubusercontent.com/12729184/114564204-b2015980-9ca2-11eb-900d-e21249f93f7c.png" alt="image" /></p>
<p>Kod:</p>
<pre><code class="language-csharp">//1. POCO ile
var value = new
{
    employees = new[] {
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;Lisa&quot;,department=&quot;HR&quot;},
        new {name=&quot;John&quot;,department=&quot;HR&quot;},
        new {name=&quot;Mike&quot;,department=&quot;IT&quot;},
        new {name=&quot;Neo&quot;,department=&quot;IT&quot;},
        new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);

//2. Dictionary ile
var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;employees&quot;] = new[] {
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;Lisa&quot;,department=&quot;HR&quot;},
        new {name=&quot;John&quot;,department=&quot;HR&quot;},
        new {name=&quot;Mike&quot;,department=&quot;IT&quot;},
        new {name=&quot;Neo&quot;,department=&quot;IT&quot;},
        new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>3. Karmaşık Veri Doldurma</h4>
<blockquote>
<p>Not: Çoklu sayfa ve aynı değişkeni kullanma desteği vardır</p>
</blockquote>
<p>Şablon:</p>
<p><img src="https://user-images.githubusercontent.com/12729184/114565255-acf0da00-9ca3-11eb-8a7f-8131b2265ae8.png" alt="image" /></p>
<p>Sonuç:</p>
<p><img src="https://user-images.githubusercontent.com/12729184/114565329-bf6b1380-9ca3-11eb-85e3-3969e8bf6378.png" alt="image" /></p>
<pre><code class="language-csharp">// 1. POCO ile
var value = new
{
    title = &quot;FooCompany&quot;,
    managers = new[] {
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
    },
    employees = new[] {
        new {name=&quot;Wade&quot;,department=&quot;HR&quot;},
        new {name=&quot;Felix&quot;,department=&quot;HR&quot;},
        new {name=&quot;Eric&quot;,department=&quot;IT&quot;},
        new {name=&quot;Keaton&quot;,department=&quot;IT&quot;}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);

// 2. Dictionary ile
var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;title&quot;] = &quot;FooCompany&quot;,
    [&quot;managers&quot;] = new[] {
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
    },
    [&quot;employees&quot;] = new[] {
        new {name=&quot;Wade&quot;,department=&quot;HR&quot;},
        new {name=&quot;Felix&quot;,department=&quot;HR&quot;},
        new {name=&quot;Eric&quot;,department=&quot;IT&quot;},
        new {name=&quot;Keaton&quot;,department=&quot;IT&quot;}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>4. Büyük Veri Doldurma Performansı</h4>
<blockquote>
<p>NOT: MiniExcel'de maksimum bellek kullanımını azaltmak için IEnumerable ertelenmiş yürütme kullanın, ToList kullanmayın</p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/12729184/114577091-5046ec80-9cae-11eb-924b-087c7becf8da.png" alt="image" /></p>
<h4>5. Hücre değeri otomatik tip eşleme</h4>
<p>Şablon</p>
<p><img src="https://user-images.githubusercontent.com/12729184/114802504-64830a80-9dd0-11eb-8d56-8e8c401b3ace.png" alt="image" /></p>
<p>Sonuç</p>
<p><img src="https://user-images.githubusercontent.com/12729184/114802419-43221e80-9dd0-11eb-9ffe-a2ce34fe7076.png" alt="image" /></p>
<p>Sınıf</p>
<pre><code class="language-csharp">public class Poco
{
    public string @string { get; set; }
    public int? @int { get; set; }
</code></pre>
<pre><code class="language-csharp">public decimal? @decimal { get; set; }
public double? @double { get; set; }
public DateTime? datetime { get; set; }
public bool? @bool { get; set; }
public Guid? Guid { get; set; }
}
</code></pre>
<p>Kod</p>
<pre><code class="language-csharp">var poco = new TestIEnumerableTypePoco { @string = &quot;string&quot;, @int = 123, @decimal = decimal.Parse(&quot;123.45&quot;), @double = (double)123.33, @datetime = new DateTime(2021, 4, 1), @bool = true, @Guid = Guid.NewGuid() };
var value = new
{
    Ts = new[] {
        poco,
        new TestIEnumerableTypePoco{},
        null,
        poco
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>6. Örnek: Github Projeleri Listesi</h4>
<p>Şablon</p>
<p><img src="https://user-images.githubusercontent.com/12729184/115068623-12073280-9f25-11eb-9124-f4b3efcdb2a7.png" alt="image" /></p>
<p>Sonuç</p>
<p><img src="https://user-images.githubusercontent.com/12729184/115068639-1a5f6d80-9f25-11eb-9f45-27c434d19a78.png" alt="image" /></p>
<p>Kod</p>
<pre><code class="language-csharp">var projects = new[]
{
    new {Name = &quot;MiniExcel&quot;,Link=&quot;https://github.com/mini-software/MiniExcel&quot;,Star=146, CreateTime=new DateTime(2021,03,01)},
    new {Name = &quot;HtmlTableHelper&quot;,Link=&quot;https://github.com/mini-software/HtmlTableHelper&quot;,Star=16, CreateTime=new DateTime(2020,02,01)},
    new {Name = &quot;PocoClassGenerator&quot;,Link=&quot;https://github.com/mini-software/PocoClassGenerator&quot;,Star=16, CreateTime=new DateTime(2019,03,17)}
};
var value = new
{
    User = &quot;ITWeiHan&quot;,
    Projects = projects,
    TotalStar = projects.Sum(s =&gt; s.Star)
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>7. Gruplandırılmış Veri Doldurma</h4>
<pre><code class="language-csharp">var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;employees&quot;] = new[] {
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
        new {name=&quot;John&quot;,department=&quot;HR&quot;},
        new {name=&quot;John&quot;,department=&quot;IT&quot;},
        new {name=&quot;Neo&quot;,department=&quot;IT&quot;},
        new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
    }
};
await MiniExcel.SaveAsByTemplateAsync(path, templatePath, value);
</code></pre>
<h5>1. <code>@group</code> etiketiyle ve <code>@header</code> etiketiyle</h5>
<p>Önce</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646717-21b9d57a-2be2-4e9a-801b-ae212231d2b4.PNG" alt="before_with_header" /></p>
<p>Sonra</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646721-58a7a340-7004-4bc2-af24-cffcb2c20737.PNG" alt="after_with_header" /></p>
<h5>2. @group etiketiyle ve @header etiketi olmadan</h5>
<p>Önce</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646873-b12417fa-801b-4890-8e96-669ed3b43902.PNG" alt="before_without_header" /></p>
<p>Sonra</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646872-622461ba-342e-49ee-834f-b91ad9c2dac3.PNG" alt="after_without_header" /></p>
<h5>3. @group etiketi olmadan</h5>
<p>Önce</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646975-f52a68eb-e031-43b5-abaa-03b67c052d1a.PNG" alt="without_group" /></p>
<p>Sonra</p>
<p><img src="https://user-images.githubusercontent.com/38832863/218646974-4a3c0e07-7c66-4088-ad07-b4ad3695b7e1.PNG" alt="without_group_after" /></p>
<h4>8. Hücre İçinde If/ElseIf/Else İfadeleri</h4>
<p>Kurallar:</p>
<ol>
<li>DateTime, Double, Int tiplerinde ==, !=, &gt;, &gt;=, &lt;, &lt;= operatörlerini destekler.</li>
<li>String tipinde ==, != operatörlerini destekler.</li>
<li>Her ifade yeni satırda olmalıdır.</li>
<li>Operatörlerin öncesinde ve sonrasında birer boşluk olmalıdır.</li>
<li>İfadelerin içinde yeni satır olmamalıdır.</li>
<li>Hücre aşağıdaki formatta olmalıdır.</li>
</ol>
<pre><code class="language-csharp">@if(name == Jack)
{{employees.name}}
@elseif(name == Neo)
Test {{employees.name}}
@else
{{employees.department}}
@endif
</code></pre>
<p>Önce</p>
<p><img src="https://user-images.githubusercontent.com/38832863/235360606-ca654769-ff55-4f5b-98d2-d2ec0edb8173.PNG" alt="if_before" /></p>
<p>Sonra</p>
<p><img src="https://user-images.githubusercontent.com/38832863/235360609-869bb960-d63d-45ae-8d64-9e8b0d0ab658.PNG" alt="if_after" /></p>
<h4>9. Parametre Olarak DataTable</h4>
<pre><code class="language-csharp">var managers = new DataTable();
{
    managers.Columns.Add(&quot;name&quot;);
    managers.Columns.Add(&quot;department&quot;);
    managers.Rows.Add(&quot;Jack&quot;, &quot;HR&quot;);
    managers.Rows.Add(&quot;Loan&quot;, &quot;IT&quot;);
}
var value = new Dictionary&lt;string, object&gt;()
{
    [&quot;title&quot;] = &quot;FooCompany&quot;,
    [&quot;managers&quot;] = managers,
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
</code></pre>
<h4>10. Formüller</h4>
<h5>1. Örnek</h5>
<p>Formülünüzün başına <code>$</code> ekleyin ve sayılabilir veri başlangıç ve bitiş satır referansları için <code>$enumrowstart</code> ve <code>$enumrowend</code> kullanın:</p>
<p><img src="docs/images/template-formulas-1.png" alt="image" /></p>
<p>Şablon işlendiğinde, <code>$</code> ön eki kaldırılır ve <code>$enumrowstart</code> ile <code>$enumrowend</code> ilgili veri aralığı satır numaraları ile değiştirilir:</p>
<p><img src="docs/images/template-formulas-2.png" alt="image" /></p>
<h5>2. Diğer Örnek Formüller:</h5>
<p>|              |                                                                                           |
|--------------|-------------------------------------------------------------------------------------------|
| Toplam       | <code>$=SUM(C{{$enumrowstart}}:C{{$enumrowend}})</code>                                              |
| Alternatif Ortalama | <code>$=SUM(C{{$enumrowstart}}:C{{$enumrowend}}) / COUNT(C{{$enumrowstart}}:C{{$enumrowend}})</code> |
| Aralık       | <code>$=MAX(C{{$enumrowstart}}:C{{$enumrowend}}) - MIN(C{{$enumrowstart}}:C{{$enumrowend}})</code>   |</p>
<h4>11. Diğer</h4>
<h5>1. Şablon parametre anahtarını kontrol etme</h5>
<p>V1.24.0 sürümünden itibaren, varsayılan olarak eksik şablon parametre anahtarları yok sayılır ve boş string ile değiştirilir. <code>IgnoreTemplateParameterMissing</code> ayarı ile istisna fırlatılıp fırlatılmayacağını kontrol edebilirsiniz.</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration()
{
    IgnoreTemplateParameterMissing = false,
};
MiniExcel.SaveAsByTemplate(path, templatePath, value, config)
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/157464332-e316f829-54aa-4c84-a5aa-9aef337b668d.png" alt="image" /></p>
<h3>Excel Sütun Adı/İndeksi/Yok Sayma Özelliği <a name="getstart4"></a></h3>
<h4>1. Sütun adını, sütun indeksini, sütunu yok sayma</h4>
<p>Excel Örneği</p>
<p><img src="https://user-images.githubusercontent.com/12729184/114230869-3e163700-99ac-11eb-9a90-2039d4b4b313.png" alt="image" /></p>
<p>Kod</p>
<pre><code class="language-csharp">public class ExcelAttributeDemo
{
    [ExcelColumnName(&quot;Column1&quot;)]
</code></pre>
<pre><code class="language-csharp">public string Test1 { get; set; }
[ExcelColumnName(&quot;Column2&quot;)]
public string Test2 { get; set; }
[ExcelIgnore]
public string Test3 { get; set; }
[ExcelColumnIndex(&quot;I&quot;)] // sistem &quot;I&quot; harfini 8. indekse dönüştürecek
public string Test4 { get; set; }
public string Test5 { get; } // set olmadan ignore edilir
public string Test6 { get; private set; } // public olmayan set ignore edilir
[ExcelColumnIndex(3)] // 0'dan başlar
public string Test7 { get; set; }
}

var rows = MiniExcel.Query&lt;ExcelAttributeDemo&gt;(path).ToList();
Assert.Equal(&quot;Column1&quot;, rows[0].Test1);
Assert.Equal(&quot;Column2&quot;, rows[0].Test2);
Assert.Null(rows[0].Test3);
Assert.Equal(&quot;Test7&quot;, rows[0].Test4);
Assert.Null(rows[0].Test5);
Assert.Null(rows[0].Test6);
Assert.Equal(&quot;Test4&quot;, rows[0].Test7);
</code></pre>
<h4>2. Özel Format (ExcelFormatAttribute)</h4>
<p>V0.21.0'dan itibaren, <code>ToString(string content)</code> metodunu içeren sınıflar için format desteği sağlanır</p>
<p>Sınıf</p>
<pre><code class="language-csharp">public class Dto
{
    public string Name { get; set; }

    [ExcelFormat(&quot;MMMM dd, yyyy&quot;)]
    public DateTime InDate { get; set; }
}
</code></pre>
<p>Kod</p>
<pre><code class="language-csharp">var value = new Dto[] {
    new Issue241Dto{ Name=&quot;Jack&quot;,InDate=new DateTime(2021,01,04)},
    new Issue241Dto{ Name=&quot;Henry&quot;,InDate=new DateTime(2020,04,05)},
};
MiniExcel.SaveAs(path, value);
</code></pre>
<p>Sonuç</p>
<p><img src="https://user-images.githubusercontent.com/12729184/118910788-ab2bcd80-b957-11eb-8d42-bfce36621b1b.png" alt="image" /></p>
<p>Sorgu işlemi özel format dönüşümünü destekler</p>
<p><img src="https://user-images.githubusercontent.com/12729184/118911286-87b55280-b958-11eb-9a88-c8ff403d240a.png" alt="image" /></p>
<h4>3. Sütun Genişliğini Ayarlama (ExcelColumnWidthAttribute)</h4>
<pre><code class="language-csharp">public class Dto
{
    [ExcelColumnWidth(20)]
    public int ID { get; set; }
    [ExcelColumnWidth(15.50)]
    public string Name { get; set; }
}
</code></pre>
<h4>4. Aynı özelliğe birden fazla sütun adı eşleştirme.</h4>
<pre><code class="language-csharp">public class Dto
{
    [ExcelColumnName(excelColumnName:&quot;EmployeeNo&quot;,aliases:new[] { &quot;EmpNo&quot;,&quot;No&quot; })]
    public string Empno { get; set; }
    public string Name { get; set; }
}
</code></pre>
<h4>5. System.ComponentModel.DisplayNameAttribute = ExcelColumnName.excelColumnNameAttribute</h4>
<p>1.24.0'dan itibaren, sistem System.ComponentModel.DisplayNameAttribute = ExcelColumnName.excelColumnNameAttribute desteği sağlar</p>
<pre><code class="language-C#">public class TestIssueI4TXGTDto
{
    public int ID { get; set; }
    public string Name { get; set; }
    [DisplayName(&quot;Specification&quot;)]
    public string Spc { get; set; }
    [DisplayName(&quot;Unit Price&quot;)]
    public decimal Up { get; set; }
}
</code></pre>
<h4>6. ExcelColumnAttribute</h4>
<p>V1.26.0'dan itibaren, birden fazla özellik aşağıdaki gibi sadeleştirilebilir:</p>
<pre><code class="language-csharp">        public class TestIssueI4ZYUUDto
        {
            [ExcelColumn(Name = &quot;ID&quot;,Index =0)]
            public string MyProperty { get; set; }
            [ExcelColumn(Name = &quot;CreateDate&quot;, Index = 1,Format =&quot;yyyy-MM&quot;,Width =100)]
            public DateTime MyProperty2 { get; set; }
        }
</code></pre>
<h4>7. DynamicColumnAttribute</h4>
<p>V1.26.0'dan itibaren, Sütun özellikleri dinamik olarak ayarlanabilir</p>
<pre><code class="language-csharp">            var config = new OpenXmlConfiguration
            {
                DynamicColumns = new DynamicExcelColumn[] {
                    new DynamicExcelColumn(&quot;id&quot;){Ignore=true},
                    new DynamicExcelColumn(&quot;name&quot;){Index=1,Width=10},
                    new DynamicExcelColumn(&quot;createdate&quot;){Index=0,Format=&quot;yyyy-MM-dd&quot;,Width=15},
                    new DynamicExcelColumn(&quot;point&quot;){Index=2,Name=&quot;Account Point&quot;},
                }
            };
            var path = PathHelper.GetTempPath();
            var value = new[] { new { id = 1, name = &quot;Jack&quot;, createdate = new DateTime(2022, 04, 12) ,point = 123.456} };
            MiniExcel.SaveAs(path, value, configuration: config);
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/164510353-5aecbc4e-c3ce-41e8-b6cf-afd55eb23b68.png" alt="image" /></p>
<h4>8. DynamicSheetAttribute</h4>
<p>V1.31.4'ten itibaren Sheet (Sayfa) özellikleri dinamik olarak ayarlanabilir. Sayfa adı ve durumu (görünürlük) ayarlanabilir.</p>
<pre><code class="language-csharp">            var configuration = new OpenXmlConfiguration
            {
                DynamicSheets = new DynamicExcelSheet[] {
                    new DynamicExcelSheet(&quot;usersSheet&quot;) { Name = &quot;Users&quot;, State = SheetState.Visible },
                    new DynamicExcelSheet(&quot;departmentSheet&quot;) { Name = &quot;Departments&quot;, State = SheetState.Hidden }
                }
            };

            var users = new[] { new { Name = &quot;Jack&quot;, Age = 25 }, new { Name = &quot;Mike&quot;, Age = 44 } };
            var department = new[] { new { ID = &quot;01&quot;, Name = &quot;HR&quot; }, new { ID = &quot;02&quot;, Name = &quot;IT&quot; } };
            var sheets = new Dictionary&lt;string, object&gt;
            {
                [&quot;usersSheet&quot;] = users,
                [&quot;departmentSheet&quot;] = department
            };

            var path = PathHelper.GetTempPath();
            MiniExcel.SaveAs(path, sheets, configuration: configuration);
</code></pre>
<p>Ayrıca yeni ExcelSheetAttribute özniteliği de kullanılabilir:</p>
<pre><code class="language-C#">   [ExcelSheet(Name = &quot;Departments&quot;, State = SheetState.Hidden)]
   private class DepartmentDto
   {
      [ExcelColumn(Name = &quot;ID&quot;,Index = 0)]
      public string ID { get; set; }
      [ExcelColumn(Name = &quot;Name&quot;,Index = 1)]
      public string Name { get; set; }
   }
</code></pre>
<h3>Ekleme, Silme, Güncelleme</h3>
<h4>Ekleme</h4>
<p>v1.28.0 ile birlikte CSV dosyasına son satırdan sonra N satır veri ekleme desteği</p>
<pre><code class="language-csharp">// Orijinal
{
    var value = new[] {
          new { ID=1,Name =&quot;Jack&quot;,InDate=new DateTime(2021,01,03)},
          new { ID=2,Name =&quot;Henry&quot;,InDate=new DateTime(2020,05,03)},
    };
    MiniExcel.SaveAs(path, value);
}
// Son satırdan sonra 1 satır ekle
{
    var value = new { ID=3,Name = &quot;Mike&quot;, InDate = new DateTime(2021, 04, 23) };
    MiniExcel.Insert(path, value);
}
// Son satırdan sonra N satır ekle
{
    var value = new[] {
          new { ID=4,Name =&quot;Frank&quot;,InDate=new DateTime(2021,06,07)},
          new { ID=5,Name =&quot;Gloria&quot;,InDate=new DateTime(2022,05,03)},
</code></pre>
<pre><code class="language-csharp">};
MiniExcel.Insert(path, value);
}
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/191023733-1e2fa732-db5c-4a3a-9722-b891fe5aa069.png" alt="image" /></p>
<p>v1.37.0 mevcut bir çalışma kitabına yeni bir sayfa eklemeyi destekler</p>
<pre><code class="language-csharp">// Orijinal excel
{
    var value = new[] {
          new { ID=1,Name =&quot;Jack&quot;,InDate=new DateTime(2021,01,03)},
          new { ID=2,Name =&quot;Henry&quot;,InDate=new DateTime(2020,05,03)},
    };
    MiniExcel.SaveAs(path, value, sheetName: &quot;Sheet1&quot;);
}
// Yeni bir sayfa ekle
{
    var value = new { ID=3,Name = &quot;Mike&quot;, InDate = new DateTime(2021, 04, 23) };
    MiniExcel.Insert(path, table, sheetName: &quot;Sheet2&quot;);
}
</code></pre>
<h4>Sil (bekleniyor)</h4>
<h4>Güncelle (bekleniyor)</h4>
<h3>Excel Tipi Otomatik Kontrol <a name="getstart5"></a></h3>
<ul>
<li>MiniExcel varsayılan olarak <code>dosya uzantısına</code> göre xlsx veya csv olup olmadığını kontrol eder, ancak bu durumda yanlışlık olabilir, lütfen manuel olarak belirtin.</li>
<li>Akıştan (Stream) hangi excel türü olduğu anlaşılamaz, lütfen manuel olarak belirtin.</li>
</ul>
<pre><code class="language-csharp">stream.SaveAs(excelType:ExcelType.CSV);
//veya
stream.SaveAs(excelType:ExcelType.XLSX);
//veya
stream.Query(excelType:ExcelType.CSV);
//veya
stream.Query(excelType:ExcelType.XLSX);
</code></pre>
<h3>CSV</h3>
<h4>Not</h4>
<ul>
<li>Varsayılan olarak <code>string</code> tipinde döner ve değerler sayıya veya datetime'a dönüştürülmez, tip güçlü tip generic ile tanımlanmadıkça.</li>
</ul>
<h4>Özel ayraç</h4>
<p>Varsayılan olarak <code>,</code> ayraçtır, özelleştirmek için <code>Seperator</code> özelliğini değiştirebilirsiniz</p>
<pre><code class="language-csharp">var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    Seperator=';'
};
MiniExcel.SaveAs(path, values,configuration: config);
</code></pre>
<p>V1.30.1'den itibaren özel ayraç fonksiyonu destekleniyor (teşekkürler @hyzx86)</p>
<pre><code class="language-csharp">var config = new CsvConfiguration()
{
    SplitFn = (row) =&gt; Regex.Split(row, $&quot;[\t,](?=(?:[^\&quot;]|\&quot;[^\&quot;]*\&quot;)*$)&quot;)
        .Select(s =&gt; Regex.Replace(s.Replace(&quot;\&quot;\&quot;&quot;, &quot;\&quot;&quot;), &quot;^\&quot;|\&quot;$&quot;, &quot;&quot;)).ToArray()
};
var rows = MiniExcel.Query(path, configuration: config).ToList();
</code></pre>
<h4>Özel satır sonu</h4>
<p>Varsayılan olarak <code>\r\n</code> yeni satır karakteridir, özelleştirmek için <code>NewLine</code> özelliğini değiştirebilirsiniz</p>
<pre><code class="language-csharp">var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    NewLine='\n'
};
MiniExcel.SaveAs(path, values,configuration: config);
</code></pre>
<h4>Özel kodlama</h4>
<ul>
<li>Varsayılan kodlama &quot;Detect Encoding From Byte Order Marks&quot;  (detectEncodingFromByteOrderMarks: true)</li>
<li>Özel kodlama gereksiniminiz varsa, lütfen StreamReaderFunc / StreamWriterFunc  özelliğini değiştirin</li>
</ul>
<pre><code class="language-csharp">// Oku
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    StreamReaderFunc = (stream) =&gt; new StreamReader(stream,Encoding.GetEncoding(&quot;gb2312&quot;))
};
var rows = MiniExcel.Query(path, true,excelType:ExcelType.CSV,configuration: config);

// Yaz
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    StreamWriterFunc = (stream) =&gt; new StreamWriter(stream, Encoding.GetEncoding(&quot;gb2312&quot;))
};
MiniExcel.SaveAs(path, value,excelType:ExcelType.CSV, configuration: config);
</code></pre>
<h4>Boş string'i null olarak oku</h4>
<p>Varsayılan olarak, boş değerler string.Empty ile eşlenir. Bu davranışı değiştirebilirsiniz</p>
<pre><code class="language-csharp">var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
   ReadEmptyStringAsNull = true
};
</code></pre>
<h3>DataReader</h3>
<h4>1. GetReader</h4>
<p>1.23.0'dan itibaren GetDataReader kullanabilirsiniz</p>
<pre><code class="language-csharp">    using (var reader = MiniExcel.GetReader(path,true))
    {
        while (reader.Read())
        {
            for (int i = 0; i &lt; reader.FieldCount; i++)
            {
                var value = reader.GetValue(i);
            }
        }
    }
</code></pre>
<h3>Async</h3>
<ul>
<li>v0.17.0 Async desteği (teşekkürler isdaniel ( SHIH,BING-SIOU)](https://github.com/isdaniel))</li>
</ul>
<pre><code class="language-csharp">public static Task SaveAsAsync(string path, object value, bool printHeader = true, string sheetName = &quot;Sheet1&quot;, ExcelType excelType = ExcelType.UNKNOWN, IConfiguration configuration = null)
public static Task SaveAsAsync(this Stream stream, object value, bool printHeader = true, string sheetName = &quot;Sheet1&quot;, ExcelType excelType = ExcelType.XLSX, IConfiguration configuration = null)
public static Task&lt;IEnumerable&lt;dynamic&gt;&gt; QueryAsync(string path, bool useHeaderRow = false, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null)
public static Task&lt;IEnumerable&lt;T&gt;&gt; QueryAsync&lt;T&gt;(this Stream stream, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null) where T : class, new()
public static Task&lt;IEnumerable&lt;T&gt;&gt; QueryAsync&lt;T&gt;(string path, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null) where T : class, new()
public static Task&lt;IEnumerable&lt;IDictionary&lt;string, object&gt;&gt;&gt; QueryAsync(this Stream stream, bool useHeaderRow = false, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null)
public static Task SaveAsByTemplateAsync(this Stream stream, string templatePath, object value)
public static Task SaveAsByTemplateAsync(this Stream stream, byte[] templateBytes, object value)
public static Task SaveAsByTemplateAsync(string path, string templatePath, object value)
public static Task SaveAsByTemplateAsync(string path, byte[] templateBytes, object value)
public static Task&lt;DataTable&gt; QueryAsDataTableAsync(string path, bool useHeaderRow = true, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = &quot;A1&quot;, IConfiguration configuration = null)
</code></pre>
<ul>
<li>v1.25.0 <code>cancellationToken</code> desteği.</li>
</ul>
<h3>Diğerleri</h3>
<h4>1. Enum</h4>
<p>Excel ve özellik adının aynı olmasına dikkat edin, sistem otomatik olarak eşleyecektir (büyük/küçük harfe duyarsız)</p>
<p><img src="https://user-images.githubusercontent.com/12729184/116210595-9784b100-a775-11eb-936f-8e7a8b435961.png" alt="image" /></p>
<p>V0.18.0'dan itibaren Enum Description desteği</p>
<pre><code class="language-csharp">public class Dto
{
    public string Name { get; set; }
    public I49RYZUserType UserType { get; set; }
}

public enum Type
{
    [Description(&quot;Genel Kullanıcı&quot;)]
    V1,
    [Description(&quot;Genel Yönetici&quot;)]
    V2,
    [Description(&quot;Süper Yönetici&quot;)]
    V3
}
</code></pre>
<pre><code>
![image](https://user-images.githubusercontent.com/12729184/133116630-27cc7161-099a-48b8-9784-cd1e443af3d1.png)

1.30.0 sürümünden itibaren excel Description'dan Enum'a destek eklendi, teşekkürler @KaneLeung

#### 2. CSV'den XLSX'e veya XLSX'ten CSV'ye Dönüştürme

```csharp
MiniExcel.ConvertXlsxToCsv(xlsxPath, csvPath);
MiniExcel.ConvertXlsxToCsv(xlsxStream, csvStream);
MiniExcel.ConvertCsvToXlsx(csvPath, xlsxPath);
MiniExcel.ConvertCsvToXlsx(csvStream, xlsxStream);
</code></pre>
<pre><code class="language-csharp">using (var excelStream = new FileStream(path: filePath, FileMode.Open, FileAccess.Read))
using (var csvStream = new MemoryStream())
{
   MiniExcel.ConvertXlsxToCsv(excelStream, csvStream);
}
</code></pre>
<h4>3. Özel CultureInfo</h4>
<p>1.22.0 sürümünden itibaren aşağıdaki gibi özel CultureInfo kullanabilirsiniz, sistem varsayılanı <code>CultureInfo.InvariantCulture</code>'dır.</p>
<pre><code class="language-csharp">var config = new CsvConfiguration()
{
    Culture = new CultureInfo(&quot;fr-FR&quot;),
};
MiniExcel.SaveAs(path, value, configuration: config);

// veya
MiniExcel.Query(path, configuration: config);
</code></pre>
<h4>4. Özel Buffer Boyutu</h4>
<pre><code class="language-csharp">    public abstract class Configuration : IConfiguration
    {
        public int BufferSize { get; set; } = 1024 * 512;
    }
</code></pre>
<h4>5. FastMode</h4>
<p>Sistem belleği kontrol etmez, fakat daha hızlı kayıt hızı elde edebilirsiniz.</p>
<pre><code class="language-csharp">var config = new OpenXmlConfiguration() { FastMode = true };
MiniExcel.SaveAs(path, reader,configuration:config);
</code></pre>
<h4>6. Toplu Resim Ekleme (MiniExcel.AddPicture)</h4>
<pre><code class="language-csharp">var images = new[]
{
    new MiniExcelPicture
    {
        ImageBytes = File.ReadAllBytes(PathHelper.GetFile(&quot;images/github_logo.png&quot;)),
        SheetName = null, // varsayılan null ilk sayfa
        CellAddress = &quot;C3&quot;, // zorunlu
    },
    new MiniExcelPicture
    {
        ImageBytes = File.ReadAllBytes(PathHelper.GetFile(&quot;images/google_logo.png&quot;)),
        PictureType = &quot;image/png&quot;, // varsayılan PictureType = image/png
        SheetName = &quot;Demo&quot;,
        CellAddress = &quot;C9&quot;, // zorunlu
        WidthPx = 100,
        HeightPx = 100,
    },
};
MiniExcel.AddPicture(path, images);
</code></pre>
<p><img src="https://github.com/user-attachments/assets/19c4d241-9753-4ede-96c8-f810c1a22247" alt="Image" /></p>
<h4>7. Sayfa Boyutlarını Al</h4>
<pre><code class="language-csharp">var dim = MiniExcel.GetSheetDimensions(path);
</code></pre>
<h3>Örnekler:</h3>
<h4>1. SQLite &amp; Dapper <code>Büyük Boyutlu Dosya</code> SQL Ekleme OOM'dan Kaçınma</h4>
<p>not: Lütfen Query'den sonra ToList/ToArray metodlarını çağırmayın, tüm veriyi belleğe yükler</p>
<pre><code class="language-csharp">using (var connection = new SQLiteConnection(connectionString))
{
    connection.Open();
    using (var transaction = connection.BeginTransaction())
    using (var stream = File.OpenRead(path))
    {
       var rows = stream.Query();
       foreach (var row in rows)
             connection.Execute(&quot;insert into T (A,B) values (@A,@B)&quot;, new { row.A, row.B }, transaction: transaction);
       transaction.Commit();
    }
}
</code></pre>
<p>performans:
<img src="https://user-images.githubusercontent.com/12729184/111072579-2dda7b80-8516-11eb-9843-c01a1edc88ec.png" alt="image" /></p>
<h4>2. ASP.NET Core 3.1 veya MVC 5 Excel Xlsx API İndir/Yükle Demo <a href="tests/MiniExcel.Tests.AspNetCore">Deneyin</a></h4>
<pre><code class="language-csharp">public class ApiController : Controller
{
    public IActionResult Index()
    {
        return new ContentResult
        {
            ContentType = &quot;text/html&quot;,
            StatusCode = (int)HttpStatusCode.OK,
            Content = @&quot;&lt;html&gt;&lt;body&gt;
&lt;a href='api/DownloadExcel'&gt;DownloadExcel&lt;/a&gt;&lt;br&gt;
&lt;a href='api/DownloadExcelFromTemplatePath'&gt;DownloadExcelFromTemplatePath&lt;/a&gt;&lt;br&gt;
&lt;a href='api/DownloadExcelFromTemplateBytes'&gt;DownloadExcelFromTemplateBytes&lt;/a&gt;&lt;br&gt;
&lt;p&gt;Excel Yükle&lt;/p&gt;
&lt;form method='post' enctype='multipart/form-data' action='/api/uploadexcel'&gt;
    &lt;input type='file' name='excel'&gt; &lt;br&gt;
    &lt;input type='submit' &gt;
&lt;/form&gt;
&lt;/body&gt;&lt;/html&gt;&quot;
        };
    }

    public IActionResult DownloadExcel()
    {
        var values = new[] {
            new { Column1 = &quot;MiniExcel&quot;, Column2 = 1 },
            new { Column1 = &quot;Github&quot;, Column2 = 2}
        };
        var memoryStream = new MemoryStream();
        memoryStream.SaveAs(values);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)
        {
            FileDownloadName = &quot;demo.xlsx&quot;
        };
    }

    public IActionResult DownloadExcelFromTemplatePath()
    {
        string templatePath = &quot;TestTemplateComplex.xlsx&quot;;

        Dictionary&lt;string, object&gt; value = new Dictionary&lt;string, object&gt;()
        {
            [&quot;title&quot;] = &quot;FooCompany&quot;,
            [&quot;managers&quot;] = new[] {
                new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
                new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
            },
            [&quot;employees&quot;] = new[] {
                new {name=&quot;Wade&quot;,department=&quot;HR&quot;},
                new {name=&quot;Felix&quot;,department=&quot;HR&quot;},
                new {name=&quot;Eric&quot;,department=&quot;IT&quot;},
                new {name=&quot;Keaton&quot;,department=&quot;IT&quot;}
            }
        };

        MemoryStream memoryStream = new MemoryStream();
        memoryStream.SaveAsByTemplate(templatePath, value);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)
        {
            FileDownloadName = &quot;demo.xlsx&quot;
        };
    }

    private static Dictionary&lt;string, Byte[]&gt; TemplateBytesCache = new Dictionary&lt;string, byte[]&gt;();

    static ApiController()
    {
        string templatePath = &quot;TestTemplateComplex.xlsx&quot;;
        byte[] bytes = System.IO.File.ReadAllBytes(templatePath);
        TemplateBytesCache.Add(templatePath, bytes);
    }

    public IActionResult DownloadExcelFromTemplateBytes()
    {
        byte[] bytes = TemplateBytesCache[&quot;TestTemplateComplex.xlsx&quot;];

        Dictionary&lt;string, object&gt; value = new Dictionary&lt;string, object&gt;()
        {
            [&quot;title&quot;] = &quot;FooCompany&quot;,
            [&quot;managers&quot;] = new[] {
                new {name=&quot;Jack&quot;,department=&quot;HR&quot;},
                new {name=&quot;Loan&quot;,department=&quot;IT&quot;}
</code></pre>
<pre><code class="language-csharp">            },
            [&quot;employees&quot;] = new[] {
                new {name=&quot;Wade&quot;,department=&quot;HR&quot;},
                new {name=&quot;Felix&quot;,department=&quot;HR&quot;},
                new {name=&quot;Eric&quot;,department=&quot;IT&quot;},
                new {name=&quot;Keaton&quot;,department=&quot;IT&quot;}
            }
        };

        MemoryStream memoryStream = new MemoryStream();
        memoryStream.SaveAsByTemplate(bytes, value);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)
        {
            FileDownloadName = &quot;demo.xlsx&quot;
        };
    }

    public IActionResult UploadExcel(IFormFile excel)
    {
        var stream = new MemoryStream();
        excel.CopyTo(stream);

        foreach (var item in stream.Query(true))
        {
            // kendi mantığınızı burada gerçekleştirin vb.
        }

        return Ok(&quot;Dosya başarıyla yüklendi&quot;);
    }
}
</code></pre>
<h4>3. Sayfalama Sorgusu</h4>
<pre><code class="language-csharp">void Main()
{
    var rows = MiniExcel.Query(path);

    Console.WriteLine(&quot;==== 1. Sayfa ====&quot;);
    Console.WriteLine(Page(rows,pageSize:3,page:1));
    Console.WriteLine(&quot;==== 50. Sayfa ====&quot;);
    Console.WriteLine(Page(rows,pageSize:3,page:50));
    Console.WriteLine(&quot;==== 5000. Sayfa ====&quot;);
    Console.WriteLine(Page(rows,pageSize:3,page:5000));
}

public static IEnumerable&lt;T&gt; Page&lt;T&gt;(IEnumerable&lt;T&gt; en, int pageSize, int page)
{
    return en.Skip(page * pageSize).Take(pageSize);
}
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/114679083-6ef4c400-9d3e-11eb-9f78-a86daa45fe46.gif" alt="20210419" /></p>
<h4>4. WebForm ile hafızadan Excel dışa aktarma</h4>
<pre><code class="language-csharp">var fileName = &quot;Demo.xlsx&quot;;
var sheetName = &quot;Sheet1&quot;;
HttpResponse response = HttpContext.Current.Response;
response.Clear();
response.ContentType = &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;;
response.AddHeader(&quot;Content-Disposition&quot;, $&quot;attachment;filename=\&quot;{fileName}\&quot;&quot;);
var values = new[] {
    new { Column1 = &quot;MiniExcel&quot;, Column2 = 1 },
    new { Column1 = &quot;Github&quot;, Column2 = 2}
};
var memoryStream = new MemoryStream();
memoryStream.SaveAs(values, sheetName: sheetName);
memoryStream.Seek(0, SeekOrigin.Begin);
memoryStream.CopyTo(Response.OutputStream);
response.End();
</code></pre>
<h4>5. Dinamik i18n çoklu dil ve rol yetki yönetimi</h4>
<p>Örnekteki gibi, i18n ve izin yönetimini işlemek için bir metot oluşturun ve dinamik ve düşük bellekli işleme etkisini elde etmek için <code>yield return</code> ile <code>IEnumerable&lt;Dictionary&lt;string, object&gt;&gt;</code> döndürün.</p>
<pre><code class="language-csharp">void Main()
{
    var value = new Order[] {
        new Order(){OrderNo = &quot;SO01&quot;,CustomerID=&quot;C001&quot;,ProductID=&quot;P001&quot;,Qty=100,Amt=500},
        new Order(){OrderNo = &quot;SO02&quot;,CustomerID=&quot;C002&quot;,ProductID=&quot;P002&quot;,Qty=300,Amt=400},
    };

    Console.WriteLine(&quot;en-Us ve Satış rolü&quot;);
    {
        var path = Path.GetTempPath() + Guid.NewGuid() + &quot;.xlsx&quot;;
        var lang = &quot;en-US&quot;;
        var role = &quot;Sales&quot;;
        MiniExcel.SaveAs(path, GetOrders(lang, role, value));
        MiniExcel.Query(path, true).Dump();
    }

    Console.WriteLine(&quot;zh-CN ve PMC rolü&quot;);
    {
        var path = Path.GetTempPath() + Guid.NewGuid() + &quot;.xlsx&quot;;
        var lang = &quot;zh-CN&quot;;
        var role = &quot;PMC&quot;;
        MiniExcel.SaveAs(path, GetOrders(lang, role, value));
        MiniExcel.Query(path, true).Dump();
    }
}

private IEnumerable&lt;Dictionary&lt;string, object&gt;&gt; GetOrders(string lang, string role, Order[] orders)
{
    foreach (var order in orders)
    {
        var newOrder = new Dictionary&lt;string, object&gt;();

        if (lang == &quot;zh-CN&quot;)
        {
            newOrder.Add(&quot;客户编号&quot;, order.CustomerID);
            newOrder.Add(&quot;订单编号&quot;, order.OrderNo);
            newOrder.Add(&quot;产品编号&quot;, order.ProductID);
            newOrder.Add(&quot;数量&quot;, order.Qty);
            if (role == &quot;Sales&quot;)
                newOrder.Add(&quot;价格&quot;, order.Amt);
            yield return newOrder;
        }
        else if (lang == &quot;en-US&quot;)
        {
            newOrder.Add(&quot;Customer ID&quot;, order.CustomerID);
            newOrder.Add(&quot;Order No&quot;, order.OrderNo);
            newOrder.Add(&quot;Product ID&quot;, order.ProductID);
            newOrder.Add(&quot;Quantity&quot;, order.Qty);
            if (role == &quot;Sales&quot;)
                newOrder.Add(&quot;Amount&quot;, order.Amt);
            yield return newOrder;
        }
        else
        {
            throw new InvalidDataException($&quot;lang {lang} yanlış&quot;);
        }
    }
}

public class Order
{
    public string OrderNo { get; set; }
    public string CustomerID { get; set; }
    public decimal Qty { get; set; }
    public string ProductID { get; set; }
    public decimal Amt { get; set; }
}
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/118939964-d24bc480-b982-11eb-88dd-f06655f6121a.png" alt="image" /></p>
<h3>SSS</h3>
<h4>S: Excel başlık adı, sınıf özelliği adı ile eşleşmiyorsa nasıl eşleştirme yapılır?</h4>
<p>C: Lütfen ExcelColumnName özniteliğini kullanın.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/116020475-eac50980-a678-11eb-8804-129e87200e5e.png" alt="image" /></p>
<h4>S: Çoklu sayfa (multi-sheet) sorgulama veya dışa aktarma nasıl yapılır?</h4>
<p>C: <code>GetSheetNames</code> yöntemi ile ve Query metodunun sheetName parametresi ile yapılabilir.</p>
<pre><code class="language-csharp">var sheets = MiniExcel.GetSheetNames(path);
foreach (var sheet in sheets)
{
    Console.WriteLine($&quot;sheet name : {sheet} &quot;);
    var rows = MiniExcel.Query(path,useHeaderRow:true,sheetName:sheet);
    Console.WriteLine(rows);
}
</code></pre>
<p><img src="https://user-images.githubusercontent.com/12729184/116199841-2a1f5300-a76a-11eb-90a3-6710561cf6db.png" alt="image" /></p>
<h4>S: Sayfa görünürlüğü hakkında nasıl sorgulama veya dışa aktarma yapılır?</h4>
<p>C: <code>GetSheetInformations</code> yöntemi ile yapılır.</p>
<pre><code class="language-csharp">var sheets = MiniExcel.GetSheetInformations(path);
foreach (var sheetInfo in sheets)
{
    Console.WriteLine($&quot;sheet index : {sheetInfo.Index} &quot;); // sonraki sayfanın index'i - 0'dan başlar
    Console.WriteLine($&quot;sheet name : {sheetInfo.Name} &quot;);   // sayfa adı
    Console.WriteLine($&quot;sheet state : {sheetInfo.State} &quot;); // sayfa görünürlük durumu - visible / hidden
}
</code></pre>
<h4>S. Count kullanmak tüm veriyi belleğe yükler mi?</h4>
<p>Hayır, görseldeki testte 1 milyon satır*10 sütun veri var, maksimum bellek kullanımı &lt;60MB ve 13.65 saniye sürüyor.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/117118518-70586000-adc3-11eb-9ce3-2ba76cf8b5e5.png" alt="image" /></p>
<h4>S. Query tamsayı indekslerini nasıl kullanır?</h4>
<p>Query'nin varsayılan indeksi string Anahtar: A,B,C... şeklindedir. Sayısal indeks kullanmak istiyorsanız, dönüştürmek için aşağıdaki metodu oluşturun.</p>
<pre><code class="language-csharp">void Main()
{
    var path = @&quot;D:\git\MiniExcel\samples\xlsx\TestTypeMapping.xlsx&quot;;
    var rows = MiniExcel.Query(path,true);
    foreach (var r in ConvertToIntIndexRows(rows))
    {
        Console.Write($&quot;column 0 : {r[0]} ,column 1 : {r[1]}&quot;);
        Console.WriteLine();
    }
}

private IEnumerable&lt;Dictionary&lt;int, object&gt;&gt; ConvertToIntIndexRows(IEnumerable&lt;object&gt; rows)
{
    ICollection&lt;string&gt; keys = null;
    var isFirst = true;
    foreach (IDictionary&lt;string,object&gt; r in rows)
    {
        if(isFirst)
        {
            keys = r.Keys;
            isFirst = false;
        }

        var dic = new Dictionary&lt;int, object&gt;();
        var index = 0;
        foreach (var key in keys)
            dic[index++] = r[key];
        yield return dic;
    }
}
</code></pre>
<h4>S. Excel dışa aktarılırken değer boşsa başlıksız boş excel oluşuyor</h4>
<p>MiniExcel, API işlemlerini basitleştirmek için JSON.NET'e benzer bir mantıkla tipini dinamik olarak veriden alır; veri olmadan tip bilinemez. Anlamak için <a href="https://github.com/mini-software/MiniExcel/issues/133">issue #133</a>'e göz atabilirsiniz.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/122639771-546c0c00-d12e-11eb-800c-498db27889ca.png" alt="image" /></p>
<blockquote>
<p>Strong type &amp; DataTable başlık oluşturur, fakat Dictionary yine de boş Excel üretir.</p>
</blockquote>
<h4>S. Boş satırda foreach nasıl durdurulur?</h4>
<p>MiniExcel, foreach iteratorünü durdurmak için <code>LINQ TakeWhile</code> ile birlikte kullanılabilir.</p>
<p><img src="https://user-images.githubusercontent.com/12729184/130209137-162621c2-f337-4479-9996-beeac65bc4d4.png" alt="Image" /></p>
<h4>S. Boş satırlar nasıl kaldırılır?</h4>
<p><img src="https://user-images.githubusercontent.com/12729184/137873865-7107d8f5-eb59-42db-903a-44e80589f1b2.png" alt="image" /></p>
<p>IEnumerable :</p>
<pre><code class="language-csharp">public static IEnumerable&lt;dynamic&gt; QueryWithoutEmptyRow(Stream stream, bool useHeaderRow, string sheetName, ExcelType excelType, string startCell, IConfiguration configuration)
{
    var rows = stream.Query(useHeaderRow,sheetName,excelType,startCell,configuration);
    foreach (IDictionary&lt;string,object&gt; row in rows)
    {
        if(row.Keys.Any(key=&gt;row[key]!=null))
            yield return row;
    }
}
</code></pre>
<p>DataTable :</p>
<pre><code class="language-csharp">public static DataTable QueryAsDataTableWithoutEmptyRow(Stream stream, bool useHeaderRow, string sheetName, ExcelType excelType, string startCell, IConfiguration configuration)
{
    if (sheetName == null &amp;&amp; excelType != ExcelType.CSV) /*Issue #279*/
        sheetName = stream.GetSheetNames().First();

    var dt = new DataTable(sheetName);
    var first = true;
    var rows = stream.Query(useHeaderRow,sheetName,excelType,startCell,configuration);
    foreach (IDictionary&lt;string, object&gt; row in rows)
    {
        if (first)
        {

            foreach (var key in row.Keys)
            {
                var column = new DataColumn(key, typeof(object)) { Caption = key };
                dt.Columns.Add(column);
            }

            dt.BeginLoadData();
            first = false;
        }

        var newRow = dt.NewRow();
        var isNull=true;
        foreach (var key in row.Keys)
        {
            var _v = row[key];
            if(_v!=null)
                isNull = false;
            newRow[key] = _v;
        }

        if(!isNull)
            dt.Rows.Add(newRow);
    }

    dt.EndLoadData();
    return dt;
}
</code></pre>
<h4>S. SaveAs(path,value) ile mevcut dosyanın üzerine yazıp &quot;...xlsx already exists&quot; hatası almamak için</h4>
<p>Dosya oluşturma mantığını özelleştirmek için Stream sınıfını kullanabilirsiniz, örneğin:</p>
<pre><code class="language-C#">    using (var stream = File.Create(&quot;Demo.xlsx&quot;))
        MiniExcel.SaveAs(stream,value);
</code></pre>
<p>veya, V1.25.0'dan itibaren, SaveAs fonksiyonunda overwriteFile parametresiyle mevcut dosyanın üzerine yazma desteği eklendi</p>
<pre><code class="language-csharp">    MiniExcel.SaveAs(path, value, overwriteFile: true);
</code></pre>
<h3>Sınırlamalar ve dikkat edilmesi gerekenler</h3>
<ul>
<li>Şu anda xls ve şifreli dosyalar desteklenmiyor</li>
<li>xlsm sadece Query'yi destekler</li>
</ul>
<h3>Referanslar</h3>
<p><a href="https://github.com/ExcelDataReader/ExcelDataReader">ExcelDataReader</a>  / <a href="https://github.com/ClosedXML/ClosedXML">ClosedXML</a> / <a href="https://github.com/DapperLib/Dapper">Dapper</a> / <a href="https://github.com/andersnm/ExcelNumberFormat">ExcelNumberFormat</a></p>
<h3>Teşekkürler</h3>
<h4><a href="https://www.jetbrains.com/">Jetbrains</a></h4>
<p><img src="https://user-images.githubusercontent.com/12729184/123997015-8456c180-da02-11eb-829a-aec476fe8e94.png" alt="jetbrains-variant-2" /></p>
<p>Bu projeye ücretsiz All product IDE sağladığınız için teşekkürler (<a href="https://user-images.githubusercontent.com/12729184/123988233-6ab17c00-d9fa-11eb-8739-2a08c6a4a263.png">Lisans</a>)</p>
<h3>Katkı paylaşımı bağışı</h3>
<p>Bağlantı https://github.com/orgs/mini-software/discussions/754</p>
<h3>Katkıda Bulunanlar</h3>
<p><img src="https://contrib.rocks/image?repo=mini-software/MiniExcel" alt="" /></p>
<hr />
<p>Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx">Open Ai Tx</a> | Last indexed: 2025-06-08</p>
<hr />

        </div>
    </div>
    <footer class="footer">
        Powered by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank">Open AI Tx</a>
    </footer>
    <!-- Default Statcounter code for openaitx
https://openaitx.github.io/ -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>
    <!-- End of Statcounter Code -->
</body>
</html>